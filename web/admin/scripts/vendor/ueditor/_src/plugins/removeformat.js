UE.plugins.removeformat=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),e.commands.removeformat={execCommand:function(e,t,o,a,r){function m(e){if(3==e.nodeType||"span"!=e.tagName.toLowerCase())return 0;if(browser.ie){var t=e.attributes;if(t.length){for(var o=0,a=t.length;a>o;o++)if(t[o].specified)return 0;return 1}}return!e.attributes.length}function i(e){var t=e.createBookmark();if(e.collapsed&&e.enlarge(!0),!r){var a=domUtils.findParentByTagName(e.startContainer,"a",!0);a&&e.setStartBefore(a),a=domUtils.findParentByTagName(e.endContainer,"a",!0),a&&e.setEndAfter(a)}for(n=e.createBookmark(),c=n.start;(s=c.parentNode)&&!domUtils.isBlockElm(s);)domUtils.breakParent(c,s),domUtils.clearEmptySibling(c);if(n.end){for(c=n.end;(s=c.parentNode)&&!domUtils.isBlockElm(s);)domUtils.breakParent(c,s),domUtils.clearEmptySibling(c);for(var i,g=domUtils.getNextDomNode(n.start,!1,p);g&&g!=n.end;)i=domUtils.getNextDomNode(g,!0,p),dtd.$empty[g.tagName.toLowerCase()]||domUtils.isBookmarkNode(g)||(d.test(g.tagName)?o?(domUtils.removeStyle(g,o),m(g)&&"text-decoration"!=o&&domUtils.remove(g,!0)):domUtils.remove(g,!0):dtd.$tableContent[g.tagName]||dtd.$list[g.tagName]||(domUtils.removeAttributes(g,l),m(g)&&domUtils.remove(g,!0))),g=i}var f=n.start.parentNode;!domUtils.isBlockElm(f)||dtd.$tableContent[f.tagName]||dtd.$list[f.tagName]||domUtils.removeAttributes(f,l),f=n.end.parentNode,n.end&&domUtils.isBlockElm(f)&&!dtd.$tableContent[f.tagName]&&!dtd.$list[f.tagName]&&domUtils.removeAttributes(f,l),e.moveToBookmark(n).moveToBookmark(t);for(var v,c=e.startContainer,N=e.collapsed;1==c.nodeType&&domUtils.isEmptyNode(c)&&dtd.$removeEmpty[c.tagName];)v=c.parentNode,e.setStartBefore(c),e.startContainer===e.endContainer&&e.endOffset--,domUtils.remove(c),c=v;if(!N)for(c=e.endContainer;1==c.nodeType&&domUtils.isEmptyNode(c)&&dtd.$removeEmpty[c.tagName];)v=c.parentNode,e.setEndBefore(c),domUtils.remove(c),c=v}var n,s,d=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),l=o?[]:(a||this.options.removeFormatAttributes).split(","),g=new dom.Range(this.document),p=function(e){return 1==e.nodeType};g=this.selection.getRange(),i(g),g.select()}}};
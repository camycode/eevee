module("ui.toolbar"),test("toolbar显示",function(){var e=new baidu.editor.ui.Editor,t=["link","unlink","|"];baidu.editor.ui.link=function(e){return function(t,i){var o=new baidu.editor.ui.Button({className:"edui-for-"+e,title:i||t.options.labelMap||t.getLang("labelMap")||"",onclick:function(){t.execCommand(e)},showText:!1,editor:t});return t.addListener("selectionchange",function(i,d,n){var a=t.queryCommandState(e);-1==a?(o.setDisabled(!0),o.setChecked(!1)):n||(o.setDisabled(!1),o.setChecked(a))}),o}}("link"),baidu.editor.ui.unlink=function(e){return function(t,i){var o=new baidu.editor.ui.Button({className:"edui-for-"+e,title:i||t.options.labelMap||t.getLang("labelMap")||"",onclick:function(){t.execCommand(e)},showText:!1,editor:t});return t.addListener("selectionchange",function(i,d,n){var a=t.queryCommandState(e);-1==a?(o.setDisabled(!0),o.setChecked(!1)):n||(o.setDisabled(!1),o.setChecked(a))}),o}}("unlink");for(var i=new baidu.editor.ui.Toolbar({theme:e.options.theme}),o=0;o<t.length;o++){var d=t[o].toLowerCase(),n=null;"string"==typeof d?("|"==d&&(d="Separator"),baidu.editor.ui[d]&&(n=new baidu.editor.ui[d](e))):n=d,n&&i.add(n)}var a=" edui-"+e.options.theme;i.render(te.dom[0]),i.postRender();var l=document.getElementById("editor").firstChild;equal(l.className,"edui-toolbar  "+a,"检查toolbar的显示"),equal(l.childNodes.length,t.length,"检查toolbar的显示");for(var u=0;u<t.length;u++)"|"==t[u]?equal(l.childNodes[u].className,"edui-box edui-separator "+a,"检查toolbar的显示"):equal(l.childNodes[u].className,"edui-box edui-button edui-for-"+t[u]+a,"检查toolbar的显示");var r=l.childNodes[0].firstChild;equal(r.className,"edui-"+e.options.theme,"mouseover效果"),ua.browser.ie?ua.mouseenter(r):ua.mouseover(r),setTimeout(function(){r=document.getElementById("editor").firstChild.childNodes[0].firstChild,equal(r.className,"edui-"+e.options.theme+" edui-state-hover","mouseover效果"),ua.browser.ie?ua.mouseleave(r):ua.mouseout(r),setTimeout(function(){r=document.getElementById("editor").firstChild.childNodes[0].firstChild,equal(r.className,"edui-"+e.options.theme,"mouseout效果"),i.dispose(),equal(document.getElementById("editor").childNodes.length,0,"成功销毁"),start()},400)},300),stop()}),test("toolbar点击",function(){var e=["link","unlink"];baidu.editor.ui.link=function(e){return function(t,i){var o=new baidu.editor.ui.Button({className:"edui-for-"+e,title:i||t.options.labelMap||t.getLang("labelMap")||"",onclick:function(){t.execCommand(e,{href:"http://www.google.com/"})},showText:!1,editor:t});return t.addListener("selectionchange",function(i,d,n){var a=t.queryCommandState(e);-1==a?(o.setDisabled(!0),o.setChecked(!1)):n||(o.setDisabled(!1),o.setChecked(a))}),o}}("link"),baidu.editor.ui.unlink=function(e){return function(t,i){var o=new baidu.editor.ui.Button({className:"edui-for-"+e,title:i||t.options.labelMap||t.getLang("labelMap")||"",onclick:function(){t.execCommand(e)},showText:!1,editor:t});return t.addListener("selectionchange",function(i,d,n){var a=t.queryCommandState(e);-1==a?(o.setDisabled(!0),o.setChecked(!1)):n||(o.setDisabled(!1),o.setChecked(a))}),o}}("unlink");for(var t=new baidu.editor.ui.Editor,i=new baidu.editor.ui.Toolbar({theme:t.options.theme}),o=0;o<e.length;o++){var d=e[o].toLowerCase(),n=null;"string"==typeof d?("|"==d&&(d="Separator"),baidu.editor.ui[d]&&(n=new baidu.editor.ui[d](t))):n=d,n&&i.add(n)}i.render(te.dom[0]),i.postRender();var a=document.getElementById("editor").firstChild,l=a.childNodes[0].firstChild.firstChild.firstChild,u=document.createElement("div");u.innerHTML="<p>hello</p>",document.body.appendChild(u),t.selection=new dom.Selection(document);var r=new baidu.editor.dom.Range(document);t.body=document.getElementById("editor").nextSibling,r.selectNode(document.body.lastChild).select(),t.document=t.body,ua.click(l),setTimeout(function(){equal(document.body.lastChild.firstChild.firstChild.attributes.href.nodeValue,"http://www.google.com/","点击link按钮后，生成连接"),equal(document.body.lastChild.firstChild.firstChild.innerHTML,"hello","点击link按钮后，生成连接"),i.dispose(),u.parentNode.removeChild(u),start()},300),stop()});
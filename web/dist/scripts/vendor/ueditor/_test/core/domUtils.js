module("core.domUtils"),test("isBoundaryNode--node是firstChild",function(){if(ua.browser.ie)var e=te.dom[2];else var e=te.dom[1].contentWindow.document.firstChild.lastChild.appendChild(document.createElement("div"));e.innerHTML="<span>sss</span>aaa<p>ppp</p>";var t=e.firstChild.nextSibling;equal(domUtils.isBoundaryNode(t,"firstChild"),0),equal(domUtils.isBoundaryNode(t,"lastChild"),0),t=e.firstChild.firstChild,ua.browser.ie?equal(domUtils.isBoundaryNode(t,"firstChild"),0):equal(domUtils.isBoundaryNode(t,"firstChild"),1),equal(domUtils.isBoundaryNode(t,"lastChild"),0),t=e.firstChild.nextSibling.nextSibling,equal(domUtils.isBoundaryNode(t,"firstChild"),0),equal(domUtils.isBoundaryNode(t,"lastChild"),1)}),test("getPosition--A和B是同一个节点",function(){var e=te.dom[2];e.innerHTML="<span>span</span><img  /><b>bbb</b>xxx";var t=e.firstChild.firstChild,i=te.obj[3];equal(i.getPosition(t,t),0,"identical node")}),test("getPosition--A和B是兄弟节点",function(){var e=te.dom[2];e.innerHTML="<span>span</span><img  /><b>bbb</b>xxx";var t=e.firstChild.firstChild,i=e.lastChild,n=te.obj[3];equal(n.getPosition(t,i),n.POSITION_PRECEDING,"preceding node"),equal(n.getPosition(i,t),n.POSITION_FOLLOWING,"following node")}),test("getPosition--A是B的祖先",function(){var e=te.dom[2];e.innerHTML="<span>span</span><img  /><b>bbb</b>xxx";var t=e.firstChild.firstChild,i=te.obj[3];equal(i.getPosition(e,t),i.POSITION_CONTAINS+i.POSITION_PRECEDING,"preceding node"),equal(i.getPosition(t,e),i.POSITION_IS_CONTAINED+i.POSITION_FOLLOWING,"following node")}),test("getPosition--A和B在不同dom树上",function(){stop(),expect(1);var e=te.dom[2];e.innerHTML="<span>span</span><img  /><b>bbb</b>xxx";var t=te.dom[1];setTimeout(function(){var i=t.contentWindow.document||t.contentDocument,n=i.createElement("div");i.body.appendChild(n);var d=te.obj[3];equal(1&d.getPosition(e,n),1,"A和B不在同一个dom树上"),start()},50)}),test("getNodeIndex",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span></span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=e.firstChild.nextSibling.nextSibling;equal(t.getNodeIndex(i),2,"check commnet index");var n=document.getElementById("table").firstChild.firstChild.firstChild;equal(t.getNodeIndex(n),0,"check textNode index"),equal(t.getNodeIndex(e.firstChild),0,"check strong label index"),equal(t.getNodeIndex(document.getElementById("p")),5,"check p label index")}),test("findParent--body",function(){var e=te.obj[3];equal(e.findParent(document.body),null,"find parent for body")}),test("findParent--tester为空",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span id="span">span</span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=document.getElementById("span").firstChild;same(e.findParent(i),i.parentNode,"find parent")}),test("findParent--tester不为空",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span id="span">span</span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=document.getElementById("span").firstChild,n=e.findParent(i,function(e){return"test"==e.id?!0:!1});same(n,t,"find parent")}),test("findParentByTagName--body",function(){var e=te.obj[3];te.dom[2];same(e.findParentByTagName(document.body,"body"),null,"parent is self")}),test("findParentByTagName--tagName为字符串",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span id="span">span</span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=document.getElementById("p").firstChild;same(e.findParentByTagName(i,"div"),t,"tagName为字符串"),same(e.findParentByTagName(i,"em"),null,"tagName为字符串返回null")}),test("findParentByTagName--tagName为字符串数组",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span id="span">span</span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=document.getElementById("p").firstChild,n=["em","p","div"];same(e.findParentByTagName(i,n),document.getElementById("p"),"tagName为字符串数组，找出第一个符合条件的父节点")}),test("findParentByTagName--文本节点",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span id="span">span</span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=document.getElementById("span").firstChild,n=["em","p","div"];same(e.findParentByTagName(i,n),t,"文本节点")}),test("findParents",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<strong>ddddd</strong><!----><!--hhhhh--><span id="span">span</span><b>xxxxx</b><p id="p"><br /><img /><table id="table"><tr><td>dddd</td></tr></table></p>';var i=document.getElementById("span").firstChild,n=e.findParents(i,!0);equal(n.length,4,"check parent count"),same(n[0],document.body,"first  parent is body"),same(n[1],t,"second parent is div"),same(n[2],i.parentNode,"third parent is span"),same(n[3],i,"last parent is self"),n=e.findParents(i,!1,null,!0),equal(n.length,3,"check parent count"),same(n[0],i.parentNode,"first parent is span"),same(n[1],t,"second parent is div"),same(n[2],document.body,"last parent is body")}),test("findParents--tester",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<div><p id="p"><br /><img id="img" /><table id="table"><tr><td>dddd</td></tr></table></p></div>';var i=document.getElementById("img"),n=e.findParents(i,!1,function(e){return"div"==e.tagName.toLowerCase()||"body"==e.tagName.toLowerCase()?!1:!0});equal(n.length,1,"check parent count"),same(n[0],t.firstChild.firstChild,"first  parent is p")}),test("insertAfter",function(){var e=te.obj[3],t=te.dom[2],i=document.createTextNode("text");e.insertAfter(t,i),te.dom.push(i),equal(i,t.nextSibling,"insertAfter")}),test("remove--not keep children",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML="<p>xxx<span><em>xxxx</em>xxxx</span></p><div>xxxx</div>";var i=t.firstChild.firstChild,n=t.firstChild,d=e.remove(i);equal(ua.getChildHTML(t),"<p><span><em>xxxx</em>xxxx</span></p><div>xxxx</div>"),same(i,d,"check removed textNode"),d=e.remove(n),equal(ua.getChildHTML(t),"<div>xxxx</div>"),same(d,n,"check removed p")}),test("remove-- keep children",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<p id="p">xxx<span><em>xxxx</em>xxxx</span><img /></p><div>xxxx</div>';var i=t.firstChild.firstChild,n=t.firstChild,d=e.remove(i,!0);equal(ua.getChildHTML(t),'<p id="p"><span><em>xxxx</em>xxxx</span><img></p><div>xxxx</div>'),same(i,d,"check removed textNode"),d=e.remove(n,!0),equal(ua.getChildHTML(t),"<span><em>xxxx</em>xxxx</span><img><div>xxxx</div>"),same(d.id,n.id,"check removed p")}),test("getNextDomNode--没有filter",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<p id="p">p_text<span><em>xxxx</em>xxxx</span><img /></p><div>xxxx</div>';var i=t.firstChild;same(e.getNextDomNode(i),t.lastChild,"后兄弟节点"),equal(e.getNextDomNode(i,!0).data,"p_text","text node")}),test("getNextDomNode--有filter",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<div id="p"><span><em>xxxx</em>xxxx</span><p>xx</p><img /></div><div>xxxx</div>',document.body.insertBefore(document.createElement("span"),t);var i=t.firstChild.firstChild,n=function(e){return"block"==$(e).css("display")?!1:!0};same(e.getNextDomNode(i,!1,n),t.firstChild.lastChild,"找到第一个不为block元素的兄弟节点"),te.obj.push(t.previousSibling)}),test("getNextDomNode-没有兄弟或孩子",function(){var e=te.obj[3],t=te.dom[2];t.innerHTML='<p id="p">p_text<span><em>xxxx</em>xxxx</span><img /></p><div>xxxx</div>';t.firstChild;same(e.getNextDomNode(t.lastChild),t.nextSibling,"后面木有兄弟")}),test("isBookmarkNode",function(){var e=te.obj[3],t=te.dom[2],i=te.obj[2];t.innerHTML="<span><em>xxxx</em>xxxx</span><img><div>xxxx</div>",i.setStart(t,0).setEnd(t,1),i.createBookmark(),ok(e.isBookmarkNode(t.firstChild),"is BookmarkNode"),ok(!e.isBookmarkNode(t.firstChild.nextSibling),"not BookmarkNode")}),test("getWindow",function(){var e=te.dom[2],t=te.obj[3],i=t.getWindow(e);ok(i===self.window,"check window")}),test("getWindow--iframe",function(){var e=te.dom[1],t=te.obj[3];expect(1);var i=e.contentWindow.document||e.contentDocument;stop(),setTimeout(function(){var n=i.createElement("div");i.body.appendChild(n);var d=t.getWindow(n);ok(e.contentWindow===d,"same window"),start()})}),test("getCommonAncestor--body",function(){var e=te.dom[2],t=te.obj[3];equal(t.getCommonAncestor(e,document.body).tagName.toLocaleLowerCase(),"body","第二个参数是body"),equal(t.getCommonAncestor(document.body,e).tagName.toLocaleLowerCase(),"body","第一个参数是body")}),test("getCommonAncestor--自己",function(){var e=te.dom[2],t=te.obj[3];same(t.getCommonAncestor(e,e),e,"自己和自己的公共祖先")}),test("getCommonAncestor--兄弟节点",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<span>xxxx</span><p><table><tr><td id="td">dddd</td></tr></table></p>';var i=e.firstChild.firstChild,n=document.getElementById("td");same(t.getCommonAncestor(i,n),e,"兄弟节点")}),test("getCommonAncestor--不在一个dom树",function(){stop(),expect(1);var e=te.dom[2],t=te.dom[1];setTimeout(function(){var i=te.obj[3],n=t.contentWindow.document||t.contentDocument,d=n.createElement("div");n.body.appendChild(d),same(i.getCommonAncestor(d,e),null,"不在一个dom树"),start()},50)}),test("isWhitespace",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="aaa\ufeff​		\n\r",ok(!t.isWhitespace(e.firstChild),"not whiteSpace"),e.innerHTML=baidu.editor.browser.ie&&"6"==baidu.editor.browser.version?"\ufeff":"​		\n\r",ok(t.isWhitespace(e.firstChild),"is whiteSpace")}),test("isEmptyInlineElement",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<span><b><i><b>\n\r</b>xxxx</i></b><i></i></span>";var i=e.firstChild.firstChild;ok(!t.isEmptyInlineElement(i),"not empty inline"),ok(t.isEmptyInlineElement(i.firstChild.firstChild),"is emtpy inline element")}),test("isEmptyInlineElement-nodeType!=1",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<span><b>\n\r\ufeff​</b>xxxx<i></i></span>",ok(!t.isEmptyInlineElement(e.firstChild.firstChild.firstChild),"textNode not inline element")}),test("isEmptyInlineElement-block element",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<span><b><i><b>\n\r</b>xxxx</i></b><i></i></span>",ok(!t.isEmptyInlineElement(e),"not inline element")}),test("clearEmptySibling",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<p>xxx<span><u><i><b></b></i></u>xxxxx</span><img /></p><table><tr><td><i></i></td></tr></table>";var i=e.firstChild.firstChild;t.clearEmptySibling(i),equal(ua.getChildHTML(e),"<p>xxx<span><u><i><b></b></i></u>xxxxx</span><img></p><table><tbody><tr><td><i></i></td></tr></tbody></table>","没有空sibling");var n=i.nextSibling;t.clearEmptySibling(n),equal(ua.getChildHTML(e),"<p>xxx<span><u><i><b></b></i></u>xxxxx</span><img></p><table><tbody><tr><td><i></i></td></tr></tbody></table>"),t.clearEmptySibling(n.lastChild),equal(ua.getChildHTML(e),"<p>xxx<span>xxxxx</span><img></p><table><tbody><tr><td><i></i></td></tr></tbody></table>","左边有空sibling"),e.innerHTML="<p><i></i>\n<b>	<i><u>\n	\r</u></i></b>xxxx<b></b></p>",t.clearEmptySibling(e.firstChild.lastChild.previousSibling),equal(e.innerHTML.toLocaleLowerCase(),"<p>xxxx</p>","左右边有空sibling"),e.innerHTML='<span><b></b><i>		</i><div id="div"></div><var></var></span>';var d=document.getElementById("div");t.clearEmptySibling(d),equal(ua.getChildHTML(e),'<span><div id="div"></div></span>',"连续空inline sibling"),e.innerHTML="<div><p></p>xxxx<b></b></div>",t.clearEmptySibling(e.firstChild.firstChild.nextSibling),equal(ua.getChildHTML(e),"<div><p></p>xxxx</div>","左右边有空块元素")}),test("clearEmptySibling--bookmark",function(){var e=te.dom[2],t=te.obj[3],i=te.obj[2];e.innerHTML="<span><a>link</a></span>";var n=e.firstChild.firstChild,d=n.firstChild;i.selectNode(d),i.createBookmark(),t.clearEmptySibling(d),ok(/_baidu_bookmark_end/.test(d.nextSibling.id),"右边的bookmark sibling没有删掉"),ok(/_baidu_bookmark_start/.test(d.previousSibling.id),"左边的bookmark sibling没有删掉")}),test("clearEmptySibling--ignoreNext/ignorePrevious",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<p><i></i>\n<b>	<i><u>\n	\r</u></i></b>xxxx<b></b></p>",t.clearEmptySibling(e.firstChild.lastChild.previousSibling,!0),equal(e.innerHTML.toLocaleLowerCase(),"<p>xxxx<b></b></p>","ignore next"),e.innerHTML="<p><i></i>\n<b>	<i><u>\n	\r</u></i></b>xxxx<b></b></p>",t.clearEmptySibling(e.firstChild.lastChild.previousSibling,!1,!0),equal(ua.getChildHTML(e),"<p><i></i><b><i><u></u></i></b>xxxx</p>","ignore next"),e.innerHTML="<p><i></i>\n<b>	<i><u>\n	\r</u></i></b>xxxx<b></b></p>",t.clearEmptySibling(e.firstChild.lastChild.previousSibling,!0,!0),equal(ua.getChildHTML(e),"<p><i></i><b><i><u></u></i></b>xxxx<b></b></p>","ignore next&&previous")}),test("split--offset正常",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<span>span</span> >";var i=e.firstChild;t.split(i.firstChild,2),equal(i.childNodes.length,2,"check child count"),equal(i.childNodes[0].data,"sp","check firstChild"),equal(i.childNodes[1].data,"an","check secondChild")}),test("split--offset=0",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<span>span</span> >";var i=e.firstChild;t.split(i.firstChild,0),equal(i.childNodes.length,2,"check child count"),equal(i.childNodes[0].data,"","check firstChild"),equal(i.childNodes[1].data,"span","check secondChild")}),test("split--offset=data.length",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML="<span>span</span> >";var i=e.firstChild;t.split(i.firstChild,4),equal(i.childNodes.length,2,"check child count"),equal(i.childNodes[0].data,"span","check firstChild"),equal(i.childNodes[1].data,"","check secondChild")}),test("on--跨iframe加载",function(){expect(1);var e=te.obj[3],t={onafterstart:function(t){e.on(t,"load",function(){ok(!0,"on load of iframe success")})},ontest:function(){this.finish()}};ua.frameExt(t)}),test("on- 给不同的dom元素绑定相同的事件",function(){var e=te.obj[3];expect(2);var t=document.body.appendChild(document.createElement("div"));t.id="test2",te.dom.push(t);var i=function(e){ok(!0,e.type+" event triggered")};e.on(te.dom[2],"mouseover",i),e.on(te.dom[1],"mouseover",i),ua.mouseover(te.dom[2]),ua.mouseover(te.dom[1])}),test("on-多事件的字符串参数",function(){var e=te.obj[3];expect(2);var t=document.body.appendChild(document.createElement("div"));t.id="test2",te.dom.push(t);var i=function(e){ok(!0,e.type+" event triggered")};e.on(te.dom[2],"mouseover mousedown",i),ua.mouseover(te.dom[2]),ua.mousedown(te.dom[2])}),test("un- 给不同的dom元素绑定相同的事件,解除一个，另一个仍然有效",function(){var e=te.obj[3];expect(1);var t=document.body.appendChild(document.createElement("div"));t.id="test2",te.dom.push(t);var i=function(e){ok(!0,e.type+" event triggered")};e.on(te.dom[2],"mouseover",i),e.on(te.dom[1],"mouseover",i),e.un(te.dom[2],"mouseover",i),ua.mouseover(te.dom[2]),ua.mouseover(te.dom[1])}),test("un-多事件的字符串参数",function(){var e=te.obj[3];expect(0);var t=document.body.appendChild(document.createElement("div"));t.id="test2",te.dom.push(t);var i=function(e){ok(!1,e.type+" 没有注销")};e.on(te.dom[2],"mouseover mousedown",i),e.un(te.dom[2],"mouseover mousedown",i),ua.mouseover(te.dom[2]),ua.mousedown(te.dom[2]),stop(),setTimeout(function(){start()},2e3)}),test("on",function(){var e=te.obj[3];expect(2),e.on(te.dom[2],["mouseover","keypress"],function(e){ok(!0,e.type+" event triggered")}),ua.mouseover(te.dom[2]),ua.keypress(te.dom[2])}),test("test case sensitive",function(){var e=te.dom[2],t=te.obj[3];return ua.browser.ie?void ok(!0,"IE下不支持诸如DOMNodeInserted等mutation事件"):(expect(2),t.on(e,"DOMNodeInserted",function(){ok(!0,"用DOMNodeInserted测试大小写敏感事件的on绑定"),t.un(e,"DOMNodeInserted")}),e.appendChild(document.createElement("div")),void e.appendChild(document.createElement("div")))}),test("un--取消注册unload事件",function(){expect(1);var e=te.obj[3],t=te.dom[2],i=function(){ok(!0,"check unload")};e.on(t,"click",i),ua.click(t),e.un(t,"click",i),ua.click(t)}),test("un--同一个回调注册多个事件，后面事件会将第一个事件dhandler覆盖掉",function(){expect(1);var e=te.obj[3],t=te.dom[2],i=function(){ok(!0,"应当只会执行一次")};e.on(t,"click",i),e.on(t,"dbclick",i),ua.click(t),e.un(t,"click",i),ua.click(t)}),test("un--同一个回调同一个事件注册2次",function(){expect(1);var e=te.obj[3],t=te.dom[2],i=function(){ok(!0,"check unload")};e.on(t,"click",i),e.on(t,"click",i),ua.click(t),e.un(t,"click",i),ua.click(t)}),test("un--同一个事件取消注册三次",function(){expect(1);var e=te.obj[3],t=te.dom[2],i=function(){ok(!0,"check unload")};e.on(t,"click",i),ua.click(t),e.un(t,"click",i),e.un(t,"click",i),e.un(t,"click",i),ua.click(t)}),test("window resize",function(){expect(1);var e=te.obj[3];ua.frameExt({onafterstart:function(e){$(e).css("width",200)},ontest:function(t,i){var n=this,d=function(){ok(!0)};e.on(t,"resize",d),$(i).css("width",220),setTimeout(function(){e.un(t,"resize",d),$(i).css("width",240),setTimeout(n.finish,100)},500)}})}),test("isSameElement--compare with self",function(){var e=te.dom[2],t=te.obj[3];$(e).attr("name","div_name").attr("class","div_class").css("background-color","red").css("border","1px").css("font-size","12px").css("height","12px").css("width","20px"),ok(t.isSameElement(e,e),"compare with self")}),test("isSameElement--tagName不一样",function(){var e=te.dom[2],t=te.obj[3];e.appendChild(document.createElement("span")),$(e).attr("name","div_name").attr("class","div_class").css("background-color","red").css("border","1px").css("font-size","12px").css("height","12px").css("width","20px"),ok(!t.isSameElement(e,e.firstChild),"different tagName")}),test("isSameElement--img的src和宽高比较",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<span src="http://img.baidu.com/hi/jx2/j_0001.gif" width="50" height="51"></span>';var i=document.createElement("span");i.setAttribute("src","http://img.baidu.com/hi/jx2/j_0001.gif"),i.setAttribute("height","51"),i.setAttribute("width","50"),e.appendChild(i),ok(t.isSameElement(e.firstChild,e.lastChild),"手动创建的img的src和宽高比较")}),test("isSameElement--两种元素的样式通过不同方式设置",function(){var e=te.dom[2],t=te.obj[3];$(e).attr("name","div_name").attr("class","div_class").css("background-color","red").css("border","1px").css("font-size","12px").css("height","12px").css("width","20px");var i=document.createElement("div");document.body.appendChild(i),te.dom.push(i),i.innerHTML='<div id="test" class="div_class" name="div_name" style="border:1px;font-size:12px;background-color:red;width:20px;height:12px;"></div>',ok(t.isSameElement(i.firstChild,e),"is sameElement"),ok(t.isSameElement(e,i.firstChild),"is sameElement")}),test("isSameElement--A比B多一个属性",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<span class="div_class" id="span_id1" name="span_name1"></span>';var i=document.createElement("div");document.body.appendChild(i),te.dom.push(i),i.innerHTML='<span class="div_class" id="span_id1"></span>',ok(!t.isSameElement(i.firstChild,e),"A and B is not sameElement"),ok(!t.isSameElement(e,i.firstChild),"B and A is not sameElement")}),test("isSameElement--img的属性比较",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<img  style="width: 200px;height: 200px" src="http://ueditor.baidu.com/img/logo.png">hello';var i=document.createElement("div"),n='<img  src="http://ueditor.baidu.com/img/logo.png" style="width: 200px;height: 200px" >';i.innerHTML=n,ok(t.isSameElement(e.firstChild,i.firstChild),"属性一致")}),test("isSameElement--A比B多一个style属性",function(){var e=te.dom[2],t=te.obj[3];$(e).attr("name","div_name").attr("class","div_class").css("background-color","red").css("border","1px").css("font-size","12px").css("height","12px").css("width","20px");var i=document.createElement("div");document.body.appendChild(i),te.dom.push(i),i.innerHTML='<div id="test" class="div_class" name="div_name" style="border:1px;font-size:12px;background-color:rgb(255,0,0);width:20px;height:12px;left:12px"></div>',ok(!t.isSameElement(i.firstChild,e),"A and B is not sameElement"),ok(!t.isSameElement(e,i.firstChild),"B and A is not sameElement")}),test("isSameStyle",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<span style="font-size:12px; background-color:rgb(255,0,0);"></span><span name="span" style="font-size:12px;background-color:rgb(255,0,0) "></span>',ok(t.isSameStyle(e.firstChild,e.lastChild),"have same style")}),test("isSameStyle--float",function(){var e=te.dom[2],t=te.obj[3];e.innerHTML='<span style=" float:left;font-size:12px; "></span><span name="span" style="font-size:12px;float:left"></span>',ok(t.isSameStyle(e.firstChild,e.lastChild),"have same style"),e.firstChild.style.cssText="float:left;font-size:12px;background-color:red",ok(!t.isSameStyle(e.firstChild,e.lastChild),"have differtnt style")}),test("isBlockElm",function(){for(var e=te.dom[2],t=te.obj[3],i=["address","blockquote","center","dir","div","dl","fieldset","form","h1","h2","h3","h4","h5","h6","hr","menu","ol","p","pre","table","ul"],n=i.length;n;){var d=document.createElement(i[n-1]);e.appendChild(d),ok(t.isBlockElm(d),d.tagName+" is block elm"),n--}for(i=["a","abbr","acronym","b","bdo","big","br","cite","code","dfn","em","font","i","img","input","kbd","label","q","s","samp","select","small","span","strike","strong","sub","sp","textarea","tt","u","noscript"],n=i.length;n;){var d=document.createElement(i[n-1]);e.appendChild(d),ok(!t.isBlockElm(d),d.tagName+" is not block elm"),n--}}),test("isbody",function(){var e=te.obj[3];ok(e.isBody(document.body),"is body")}),test("breakParent--一级祖先",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<p><span>xxxx</span><u><i>uitext</i></u><br /></p><div>xxxx</div>";var i=e.firstChild.lastChild,n=t.breakParent(i,e.firstChild);equal(ua.getChildHTML(e),"<p><span>xxxx</span><u><i>uitext</i></u></p><br><p></p><div>xxxx</div>"),equal(n.tagName.toLowerCase(),"br","check return value")}),test("breakParent--二级祖先",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<p><span>xxxx</span><u><i>uitext</i></u><br /></p><div>xxxx</div>",t.breakParent(e.firstChild.firstChild.firstChild,e.firstChild),equal(ua.getChildHTML(e),"<p><span></span></p>xxxx<p><span></span><u><i>uitext</i></u><br></p><div>xxxx</div>")}),test("isEmptyInlineElement",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<p><u><em></em></u><span>xxxx</span><u><i>uitext</i></u><br /></p><div>xxxx</div><div></div>";var i=e.firstChild;ok(!t.isEmptyInlineElement(i),"is not empty"),ok(t.isEmptyInlineElement(i.firstChild),"u is empty"),ok(t.isEmptyInlineElement(i.firstChild.firstChild),"em is empty"),ok(!t.isEmptyInlineElement(i.lastChild),"empty div is not inline")}),test("trimWhiteTextNode",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="\n	    <p><u><em></em></u><span>xxxx</span><u><i>uitext</i></u><br /></p><div>xxxx</div>    ",t.trimWhiteTextNode(e),equal(ua.getChildHTML(e),"<p><u><em></em></u><span>xxxx</span><u><i>uitext</i></u><br></p><div>xxxx</div>","trim white textnode")}),test("mergeChild--span",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils,i=document.createElement("div");i.id="test",e.innerHTML='<span style="background-color:blue;"><span style="font-size:12px;color:red">span_1<span style="font-size:12px">span_2</span></span></span>',t.mergeChild(e.firstChild.firstChild),i.innerHTML='<span style="background-color:blue;"><span style="font-size:12px;color:red">span_1</span></span>',i.firstChild.firstChild.appendChild(document.createTextNode("span_2")),ok(ua.haveSameAllChildAttribs(e,i),"span套span则合并"),e.innerHTML='<p><span style="font-size:12px;color:red">span_1<span style="font-size:12px">span_2</span></span></p>',t.mergeChild(e.firstChild.firstChild),i.innerHTML='<p><span style="font-size:12px;color:red">span_1</span></p>',i.firstChild.firstChild.appendChild(document.createTextNode("dpan_2")),ok(ua.haveSameAllChildAttribs(e,i),"父节点style比子节点多"),e.innerHTML='<p><span style="font-size:12px">span_1<span style="font-size:12px;color:red">span_2</span></span></p>';var n=e.firstChild.firstChild;t.mergeChild(n);var i=document.createElement("div");i.id="test",i.innerHTML='<p><span style="font-size:12px">span_1<span style="font-size:12px;color:red">span_2</span></span></p>',ok(ua.haveSameAllChildAttribs(e,i),"子节点style比父节点多"),e.innerHTML='<p><span style="font-size:12px;color:red;left:10px">span_1<span style="font-size:12px">span_2</span><span style="top:10px">span_3</span><span style="color:red;left:10px;right:10px">span_4</span></span><span style="font-size:12px"></span></p>',t.mergeChild(e.firstChild.firstChild),i.innerHTML='<p><span style="font-size:12px;color:red;left:10px">span_2<span style="font-size:12px;color:red;left:10px;top:10px">span_3</span><span style="font-size:12px;color:red;left:10px;right:10px">span_4</span></span><span style="font-size:12px"></span></p>';var d=i.firstChild.firstChild;d.insertBefore(document.createTextNode("span_1"),d.firstChild),ok(ua.haveSameAllChildAttribs(e,i),"多个子节点和兄弟节点，有的子节点style比父节点多，有的少，有的不同")}),test("mergeChild--非span",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<b style="color:red;font-size:12px">b1<b style="font-size:12px;">b2</b></b>';var i=document.createElement("div");i.id="test",i.innerHTML='<b style="color:red;font-size:12px">b1<b style="font-size:12px;">b2</b></b>',t.mergeChild(e.firstChild),ok(ua.haveSameAllChildAttribs(e,i),"父节点和子节点属性不同，则不操作"),e.innerHTML='<b style="color:red;font-size:12px">b1<b style="font-size:12px;color:red;">b2</b></b>';var i=document.createElement("div");i.id="test",i.innerHTML='<b style="color:red;font-size:12px">b1</b>',t.mergeChild(e.firstChild),i.firstChild.appendChild(document.createTextNode("b2")),ok(ua.haveSameAllChildAttribs(e,i),"父节点和子节点属性相同，则删子节点")}),test("mergeChild--span--attrs",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils,i=document.createElement("div");i.id="test",e.innerHTML='<span style="background-color:blue;"><span style="font-size:12px;color:red">span_1<span style="font-size:12px">span_2</span></span></span>';var n='<span style="font-size: 12px; color: red; background-color: blue;">span_1<span style="font-size: 12px; color: red; background-color: red;">span_2</span></span>';t.mergeChild(e.firstChild,"span",{style:"background-color:red"}),ua.checkSameHtml(e.innerHTML,n,"mergeChild-给子节点中的span添加样式")}),test("getElementsByTagName",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<p><u><em></em></u><span>xxxx</span><u><i>uitext</i></u><br /></p><div>xxxx</div> <p>xxxx</p>";var i=t.getElementsByTagName(e,"p");equal(i.length,2,"check elem count"),equal(i[0].innerHTML.toLowerCase(),"<u><em></em></u><span>xxxx</span><u><i>uitext</i></u><br>","check first p"),equal(i[1].innerHTML,"xxxx","check second p")}),test("mergeToParent--一个span孩子",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<span style="color:red;font-size:12px;"><span style="left:10px;right:20px;"></span></span>',t.mergeToParent(e.firstChild.firstChild);var i=document.createElement("div");i.innerHTML="<span style=color:red;font-size:12px;left:10px;right:20px;></span>",ok(ua.haveSameAllChildAttribs(e,i),"mergeTo parent")}),test("mergeToParent--一个span孩子，孩子css样式与父节点相同",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<span style="color:red;font-size:12px;"><span style="font-size:12px;color:red;">xxxxx</span></span>',t.mergeToParent(e.firstChild.firstChild);var i=document.createElement("div");i.innerHTML='<span style="color:red;font-size:12px">xxxxx</span>',ok(ua.haveSameAllChildAttribs(e,i),"mergeTo parent，删除样式相同的子节点")}),test("mergeToParent--多个span孩子,祖先节点不可被合并",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<span style="color:red;font-size:12px;"><span style="left:10px;right:20px;"></span><span style="top:10px"></span></span>',t.mergeToParent(e.firstChild.firstChild);var i=document.createElement("div");i.innerHTML='<span style="color:red;font-size:12px;"><span style="left:10px;right:20px;color:red;font-size:12px;"></span><span style="top:10px"></span></span>',ok(ua.haveSameAllChildAttribs(e,i),"mergeTo parent--多个span孩子,")}),test("mergeToParent--其他inline节点",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<b>xxx<i>xxx<u>xxxx<em>xxx<i id="secondI"><b>xxxxxx</b></i></em></u></i></b>';var i=document.getElementById("secondI");t.mergeToParent(i.firstChild),ok(ua.getChildHTML(e),"<b>xxx<i>xxx<u>xxxx<em>xxx<i>xxxxxx</i></em></u></i></b>"),t.mergeToParent(i),ok(ua.getChildHTML(e),"<b>xxx<i>xxx<u>xxxx<em>xxxxxxxxx</em></u></i></b>")}),test("mergeSibling--左边没有兄弟",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<b>b1</b><b>b2</b><b id="b3">b3</b>',t.mergeSibling(e.firstChild),ok(ua.getChildHTML(e),'<b>b1b2</b><b id="b3">b3</b>')}),test("mergeSibling--右边没有兄弟",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<b>b1</b><b>b2</b><b>b3</b>",t.mergeSibling(e.lastChild),ok(ua.getChildHTML(e),'<b>b1b2</b><b id="b3">b3</b>')}),test("mergeSibling--兄弟节点没有孩子",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<b></b><b>b2</b><b id="b3">b3</b>',t.mergeSibling(e.firstChild.nextSibling),ok(ua.getChildHTML(e),'<b>b2</b><b id="b3">b3</b>')}),test("trace 3983 unselectable--检查赋值是否成功",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;if(e.innerHTML="<div><p>xxxx<span><b><i>xxx</i></b>xxxx</span></p>dddd<p><img /><a>aaaa</a></p></div>",t.unSelectable(e),UE.browser.gecko||UE.browser.webkit||UE.browser.ie&&UE.browser.version>8)equal(e.style.MozUserSelect||e.style.KhtmlUserSelect||e.style.MSUserSelect,"none","webkit or gecko unselectable");else{equal(e.unselectable,"on","检查unselectable属性");for(var i,n=0;i=e.all[n++];)equal(i.unselectable,"on","检查子节点unselectable属性")}}),test("unselectable--检查是否真的不能选中",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;if(e.innerHTML="<p>xxx</p>",!ua.browser.ie&&!ua.browser.opera){var i=te.obj[2];i.selectNode(e.firstChild).select(),equal(ua.getSelectedText(),"xxx","before unselectable"),t.unSelectable(e),i.selectNode(e.firstChild).select(),equal(ua.getSelectedText(),"","after unselectable")}}),test("removeAttributes--删除多个属性，包括style",function(){var e=te.dom[2];e.innerHTML='<div class="div_class" name="div_name" style="color:red;font-size:12px"></div>';var t=baidu.editor.dom.domUtils;t.removeAttributes(e.firstChild,["class","name","style"]),equal(ua.getChildHTML(e),"<div></div>")}),test("setAttributes--设置class,style",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<div></div>",t.setAttributes(e.firstChild,{"class":"div_class",id:"div_id",style:"color:red;font-size:12px;"});var i=document.createElement("div");i.id="test",i.innerHTML='<div class="div_class" id="div_id" style="color:red;font-size:12px"></div>',ok(ua.haveSameAllChildAttribs(e,i),"check attributes")}),test("setAttributes--设置innerHTML,value",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<div></div>",t.setAttributes(e.firstChild,{innerHTML:"setAttributes_test",id:"div_id",value:"abcd"});var i=document.createElement("div");i.id="test",i.innerHTML='<div id="div_id" >setAttributes_test</div>',i.firstChild.value="abcd",ok(ua.haveSameAllChildAttribs(e,i),"check attributes")}),test("getComputedStyle",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="div_class" name="div_name" style="color:red;font-size:12px"></div><span></span>',equal(t.getComputedStyle(e.firstChild,"font-size"),"12px"),equal(t.getComputedStyle(e.firstChild,"display"),"block"),equal(t.getComputedStyle(e.lastChild,"display"),"inline"),equal(t.getComputedStyle(e.firstChild,"width"),e.firstChild.offsetWidth+"px"),e.innerHTML='<div class="div_class" name="div_name" style="width:30px;"></div><span></span>',equal(t.getComputedStyle(e.firstChild,"width"),"30px")}),test("getComputedStyle--获取默认的背景色",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<div>hello</div>";var i=baidu.editor.browser.webkit?"":"transparent";equal(t.getComputedStyle(e,"background-color"),i,"默认背景色为透明色")}),test("getComputedStyle-border",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<table style="border: 5px solid red"></table>',equal(t.getComputedStyle(e.firstChild,"border-width"),"5px"),equal(t.getComputedStyle(e.lastChild,"border-style"),"solid"),
equal(t.getComputedStyle(e.lastChild,"border-color"),"red")}),test("getComputedStyle-在body上设置字体大小,检查h1字体大小",function(){var e=baidu.editor.dom.domUtils,t=new baidu.editor.Editor({autoFloatEnabled:!1}),i=document.body.appendChild(document.createElement("div"));t.render(i),stop(),t.ready(function(){var n=t.body,d=(new baidu.editor.dom.Range(t.document),n.appendChild(t.document.createElement("h1"))),s=ua.browser.ie&&ua.browser.ie<9?"33px":"32px";equal(e.getComputedStyle(d,"font-size"),s,"body的fontSize属性不应当覆盖p的fontSize属性"),te.dom.push(i),start()})}),test("removeClasses--多个class",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="div_class div_class2 div_class3" name="div_name" style="color:red;font-size:12px"></div>';var i=e.firstChild;t.removeClasses(i,["div_class2","div_class3","div_class"]),equal($.trim(i.className),"","check className"),equal($(i).attr("name"),"div_name","check name"),equal($(i).css("font-size"),"12px","check font-size"),equal($(i).css("font-size"),"12px","check font-size"),equal(i.style.color,"red","check red")}),test("removeClasses--class包含”-“",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="b-b b-b-a " name="div_name" style="color:red;font-size:12px"></div>';var i=e.firstChild;t.removeClasses(i,["b-b"]),equal($.trim(i.className),"b-b-a","check className"),equal($(i).attr("name"),"div_name","check name"),equal($(i).css("font-size"),"12px","check font-size"),equal(i.style.color,"red","check red"),e.innerHTML='<div class="b-b b-b-a " name="div_name" style="color:red;font-size:12px"></div>',t.removeClasses(e.firstChild," b-b-a  b-b"),equal(e.firstChild.className,"")}),test("removeStyle--style不为空",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div name="div_name" style="color:red;font-size:12px"></div>',t.removeStyle(e.firstChild,"font-size");var i=document.createElement("div");i.id="test",i.innerHTML='<div name="div_name" style="color:red; "></div>',ok(ua.haveSameAllChildAttribs(e,i),"check removed style")}),test("removeStyle--style不为空",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div name="div_name" style="border-left:1px solid #ccc"></div>',t.removeStyle(e.firstChild,"border-left");var i=document.createElement("div");i.id="test",i.innerHTML='<div name="div_name" ></div>',ok(ua.haveSameAllChildAttribs(e,i),"check removed style")}),test("removeStyle--style为空",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div name="div_name"></div>',t.removeStyle(e.firstChild,"color"),equal(ua.getChildHTML(e),'<div name="div_name"></div>'," style为空")}),test("hasClass",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="div_class div_class2 div_class3" name="div_name" style="color:red;font-size:12px"></div>';var i=e.firstChild;ok(t.hasClass(i,"div_class3"),"有这个class"),ok(!t.hasClass(i,"div"),"木有这个class"),e.firstChild.className="a b  c",ok(t.hasClass(e.firstChild,"b c a"))}),test("addClass",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div name="div_name" style="color:red;font-size:12px"></div>',t.addClass(e.firstChild,"div_class div_class2 div_class3"),equal(utils.trim(e.firstChild.className),e.firstChild.className,"判断是否有前后空格"),t.addClass(e.firstChild,"div_class4"),equal(e.firstChild.className,"div_class div_class2 div_class3 div_class4","增加class4"),t.addClass(e.firstChild,"div_class4"),equal(e.firstChild.className,"div_class div_class2 div_class3 div_class4","再增加class4")}),test("preventDefault",function(){expect(1);var e=te.dom[2],t=baidu.editor.dom.domUtils,i=document.createElement("img");i.src=upath+"test.jpg",i.style.height="2000px",e.appendChild(i),document.body.appendChild(e);var n=document.createElement("a");n.setAttribute("href","#"),n.innerHTML="ToTop",n.target="_self",document.body.appendChild(n),window.scrollTo(0,document.body.scrollHeight),n.onclick=function(e){t.preventDefault(e)},UserAction.click(n);var d=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;ok(0!=d,"preventDefault"),document.body.removeChild(n)}),test("getStyle--color is red",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="div_class div_class2 div_class3" name="div_name" style="top:13px;color:red;font-size:12px"></div>',equal(t.getStyle(e.firstChild,"color"),"red","check color"),equal(t.getStyle(e.firstChild,"font-size"),"12px","check font size"),equal(t.getStyle(e.firstChild,"top"),"13px","check top")}),test("getStyle--color is rgb",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="div_class div_class2 div_class3" name="div_name" style="top:13px;color:rgb(255,0,0);font-size:12px"></div>',equal(t.getStyle(e.firstChild,"color"),"#FF0000","check color"),equal(t.getStyle(e.firstChild,"font-size"),"12px","check font size"),equal(t.getStyle(e.firstChild,"top"),"13px","check top")}),test("getStyle--color is #ff0000",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div class="div_class div_class2 div_class3" name="div_name" style="top:13px;color:#ff0000;font-size:12px"></div>',equal(t.getStyle(e.firstChild,"color").toUpperCase(),"#FF0000","check color"),equal(t.getStyle(e.firstChild,"font-size"),"12px","check font size"),equal(t.getStyle(e.firstChild,"top"),"13px","check top")}),test("removeDirtyAttr",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML="<div><span>xxx</span><img /></div>xx",$(e).attr("_moz_dirty","xxxx");for(var i,n=0,d=e.getElementsByTagName("*");i=d[n++];)$(i).attr("_moz_dirty","xxx");t.removeDirtyAttr(e);for(var i,n=0,d=e.getElementsByTagName("*");i=d[n++];)equal($(i).attr("_moz_dirty"),void 0,"check  dirty attr ");equal($(e).attr("_moz_dirty"),void 0,"check  dirty attr")}),test("getChildCount",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div name="div_name" style="top:13px;color:#ff0000;font-size:12px"><p><span>xxx<b><u></u></b></span></p><span>xxxx</span>xxx<img/>xxx</div>';var i=e.firstChild;equal(t.getChildCount(e),1,"one childNode"),equal(t.getChildCount(i),5,"5 childs"),equal(t.getChildCount(i.firstChild.firstChild),2,"inline span"),equal(t.getChildCount(i.lastChild),0,"text node have no child"),equal(t.getChildCount(i.lastChild.previousSibling),0,"img have no child")}),test("setStyle",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div style="float: left"><p style="background: red"></p></div>',t.setStyle(e.firstChild,"float","right"),equal($(e.firstChild).css("float"),"right","浮动方式改为了right"),t.setStyle(e.firstChild.firstChild,"text-indent","10px"),equal($(e.firstChild.lastChild).css("text-indent"),"10px","设置了缩进样式")}),test("setStyles",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML='<div style="float: left"><p style="background: red"></p></div>',t.setStyles(e.firstChild,{"float":"right","text-align":"center"}),equal($(e.firstChild).css("float"),"right","浮动方式改为了right"),equal($(e.firstChild.lastChild).css("text-align"),"center","设置了对齐方式样式")}),test("isEmptyNode",function(){var e=te.dom[2],t=baidu.editor.dom.domUtils;e.innerHTML=" 		\n\r",ok(t.isEmptyNode(e)),e.innerHTML="<div><i></i><b>dasdf</b></div>",equal(!1,t.isEmptyNode(e))}),test("clearSelectedArr",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2],i=document.createElement("span");t.className="aaa",i.className="span",document.body.appendChild(t),document.body.appendChild(i);var n=[];n.push(t),n.push(i),e.clearSelectedArr(n),equal("",t.className),equal("",i.className)}),test("isBr",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];t.innerHTML="<br>",equal(!0,e.isBr(t.firstChild))}),test("isFillChar",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];e.fillNode(document,t),ua.browser.ie&&ok(e.isFillChar(t.lastChild));var i=document.createTextNode(e.fillChar+"sdfsdf");ok(e.isFillChar(i,!0)),ok(!e.isFillChar(i)),i=document.createTextNode(e.fillChar+e.fillChar),ok(e.isFillChar(i,!0)),ok(e.isFillChar(i))}),test("isStartInblock",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2],i=new baidu.editor.dom.Range(document);e.fillNode(document,t),i.setStart(t,0),ok(e.isStartInblock(i)),t.innerHTML="asdfasdf",i.setStart(t,2),equal(0,e.isStartInblock(i))}),test("isEmptyBlock",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];e.fillNode(document,t),ok(e.isEmptyBlock(t));var i=document.createElement("span");equal(1,e.isEmptyBlock(i)),i.innerHTML="asdf",equal(0,e.isEmptyBlock(i))}),test("fillNode",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];e.fillNode(document,t),ok(t.innerHTML.length>0)}),test("moveChild",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];t.innerHTML="div child";var i=document.createElement("p");e.moveChild(t,i),equal("div child",i.innerHTML),i.innerHTML="",t.innerHTML="<span>asdf</span>",e.moveChild(t,i),equal("<span>asdf</span>",i.innerHTML.toLowerCase())}),test("hasNoAttributes",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];t.innerHTML="<span>sdf</span>",ok(e.hasNoAttributes(t.firstChild)),t.firstChild.style.cssText="font-size:12px",ok(!e.hasNoAttributes(t.firstChild)),e.removeAttributes(t.firstChild,["style"]),ok(e.hasNoAttributes(t.firstChild)),t.innerHTML="<span custorm>sf</span>",ok(!e.hasNoAttributes(t.firstChild))}),test("isTagNode",function(){var e=baidu.editor.dom.domUtils,t=te.dom[2];t.innerHTML="<p><span>sdf</span></p>",ok(e.isTagNode(t.firstChild,"p")),ok(e.isTagNode(t.firstChild.firstChild,"span"))}),test("filterNodelist",function(){var e=te.dom[2];e.innerHTML="<span></span><span></span><i></i><i></i><i></i>";var t=domUtils.filterNodeList(e.getElementsByTagName("*"),"i span");equals(t.tagName,"SPAN"),t=domUtils.filterNodeList(e.getElementsByTagName("*"),"i"),equals(t.tagName,"I"),t=domUtils.filterNodeList(e.getElementsByTagName("*"),function(e){return"SPAN"==e.tagName}),equals(t.tagName,"SPAN"),t=domUtils.filterNodeList(e.getElementsByTagName("*"),function(e){return"SPAN"==e.tagName},!0),equals(t.length,2)}),test("inNodeEndBoundary",function(){var e=te.dom[2];e.innerHTML="<span><b>span</b><a>aa</a></span><b>sp</b>";var t=te.obj[2];t.setStart(e.firstChild.lastChild.firstChild,2).collapse(1).select(),t.createBookmark(),ok(domUtils.isInNodeEndBoundary(t,e.firstChild),"firstchild.lastchild边界"),t.setStart(e.firstChild.firstChild.firstChild,4).collapse(1).select(),t.createBookmark(),ok(!domUtils.isInNodeEndBoundary(t,e.firstChild),"firstchild.firstchild边界"),t.setStart(e.lastChild.firstChild,2).collapse(1).select(),t.createBookmark(),ok(domUtils.isInNodeEndBoundary(t,e),"lastchild边界")});
module("plugins.table"),test("向右合并--拆分成列",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("mergeright"),t.setStart(l[1],0).collapse(!0).select(),e.execCommand("mergeright"),l=e.body.getElementsByTagName("td"),equal(l.length,2,"2个单元格"),equal(l[0].getAttribute("colspan"),2,"第一行的单元格colspan为2"),equal(l[1].getAttribute("colspan"),2,"第二行的单元格colspan为2"),ua.manualDeleteFillData(e.body),setTimeout(function(){e.execCommand("source"),start()}),stop(),l=e.body.getElementsByTagName("td"),equal(l.length,2,"2个单元格"),equal(l[0].getAttribute("colspan"),2,"切换到源码后第一个的单元格colspan"),equal(l[1].getAttribute("colspan"),2,"切换到源码后第二行第一个的单元格colspan"),t.setStart(l[0],0).collapse(!0).select(),e.execCommand("splittocols"),equal(l[0].getAttribute("colspan"),1,"拆分--[0][0]单元格colspan"),equal(l[0].rowSpan,1,"拆分--[0][0]单元格rowspan")}),test("trace 3985  向右合并--拆分成列:th",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2});var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("inserttitle");var a=e.body.getElementsByTagName("th");t.setStart(a[0],0).collapse(!0).select(),e.execCommand("mergeright"),a=e.body.getElementsByTagName("th"),equal(a.length,1,"1个th"),t.setStart(a[0],0).collapse(!0).select(),e.execCommand("splittocols"),equal(e.body.getElementsByTagName("th").length,2,"拆分单元格th")}),test("trace 3985 向下合并-拆分成行",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("mergedown"),t.setStart(l[1],0).collapse(!0).select(),e.execCommand("mergedown"),l=e.body.getElementsByTagName("td"),equal(l.length,2,"2个单元格"),equal(l[0].getAttribute("rowspan"),2,"合并--[0][0]单元格rowspan"),equal(l[1].getAttribute("rowspan"),2,"合并--[0][1]单元格rowspan"),t.setStart(l[0],0).collapse(!0).select(),e.execCommand("splittorows"),t.setStart(l[1],0).collapse(!0).select(),e.execCommand("splittorows"),equal(l[0].colSpan,1,"拆分--[0][0]单元格colspan"),equal(l[0].getAttribute("rowspan"),1,"拆分--[0][0]单元格rowspan")}),test("完全拆分单元格",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),ua.manualDeleteFillData(e.body),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[1].cells[1]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),a.clearSelected();var o=e.body.getElementsByTagName("td");equal(o.length,6,"单元格数"),equal(o[0].getAttribute("colspan"),2,"合并--[0][0]单元格colspan"),equal(o[0].getAttribute("rowspan"),2,"合并--[0][0]单元格rowspan"),e.execCommand("splittoCells"),equal(o.length,9,"单元格数"),equal(o[0].getAttribute("colspan"),1,"拆分--[0][0]单元格colspan"),equal(o[0].getAttribute("rowspan"),1,"拆分--[0][0]单元格rowspan"),equal(o[1].colSpan,1,"拆分--[0][1]单元格colspan"),equal(o[1].getAttribute("rowspan"),1,"拆分--[0][1]单元格rowspan"),e.undoManger.undo(),equal(o[0].getAttribute("colspan"),2,"撤销--[0][0]单元格colspan"),equal(o[0].getAttribute("rowspan"),2,"撤销--[0][0]单元格rowspan"),start()},50),stop()}),test("删除table",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable"),ua.manualDeleteFillData(e.body),equal(e.queryCommandState("deletetable"),-1,"删除按钮灰色");var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("deletetable"),ua.manualDeleteFillData(e.body);var a=e.body.getElementsByTagName("table")[0];equal(a,void 0,"删除成功")}),test("平均分配行列",function(){var e=te.obj[0],t=te.obj[1],l='<table width="267" ><tbody><caption></caption><tr><th></th><th></th><th></th></tr><tr><td width="46" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="57" ><br/></td><td width="158" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="57" ><br/></td><td width="-1" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="57" ><br/></td></tr><tr><td width="46" valign="top" style="word-break: break-all;" height="134" ><br/></td><td width="158" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="134" ><br/></td><td width="-1" valign="top" style="word-break: break-all;" height="134" ><br/></td></tr><tr><td width="46" valign="top" style="word-break: break-all;" ><br/></td><td width="158" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" ><br/></td><td width="-1" valign="top" style="word-break: break-all;" ><br/></td></tr></tbody></table>';e.setContent(l);var a=e.body.firstChild.getElementsByTagName("tr"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[1].cells[0],a[1].cells[2]);s.setSelected(o),t.setStart(a[1].cells[0],0).collapse(!0).select(),e.execCommand("averagedistributecol"),s.clearSelected(),equal(e.body.firstChild.getElementsByTagName("td")[1].width,e.body.firstChild.getElementsByTagName("td")[2].width,"平均分配各列"),o=s.getCellsRange(a[1].cells[0],a[3].cells[0]),s.setSelected(o),t.setStart(a[1].cells[0],0).collapse(!0).select(),e.execCommand("averagedistributerow"),s.clearSelected(),a=e.body.firstChild.getElementsByTagName("tr"),equal(a[2].cells[0].height,a[3].cells[0].height,"平均分配各行")}),test("选部分行时，平均分布行/选部分列时，平均分布列",function(){var e=te.obj[0],t=te.obj[1],l='<table width="267" ><tbody><tr><td width="46" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="57" ><br/></td><td width="158" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="57" ><br/></td><td width="-1" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="57" ><br/></td></tr><tr><td width="46" valign="top" style="word-break: break-all;" height="134" ><br/></td><td width="158" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" height="134" ><br/></td><td width="-1" valign="top" style="word-break: break-all;" height="134" ><br/></td></tr><tr><td width="46" valign="top" style="word-break: break-all;" ><br/></td><td width="158" valign="top" colspan="1" rowspan="1" style="word-break: break-all;" ><br/></td><td width="-1" valign="top" style="word-break: break-all;" ><br/></td></tr></tbody></table>';e.setContent(l);var a=e.body.firstChild.getElementsByTagName("tr"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[0].cells[0],a[1].cells[2]);s.setSelected(o),t.setStart(a[0].cells[0],0).collapse(!0).select(),e.execCommand("averagedistributerow"),s.clearSelected(),a=e.body.firstChild.getElementsByTagName("tr"),equal(a[1].cells[0].height,a[0].cells[0].height,"平均分配各行"),o=s.getCellsRange(a[0].cells[0],a[2].cells[1]),s.setSelected(o),t.setStart(a[0].cells[0],0).collapse(!0).select(),e.execCommand("averagedistributecol"),s.clearSelected(),equal(e.body.firstChild.getElementsByTagName("td")[0].width,e.body.firstChild.getElementsByTagName("td")[1].width,"平均分配各列")}),test("表格中设置对齐方式",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<table><caption></caption><tbody><tr><td></td><td><p>hello</p></td></tr></tbody></table>"),stop(),setTimeout(function(){var l=e.body.getElementsByTagName("caption");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("cellalignment",{align:"right",vAlign:"top"}),equal(l[0].style.textAlign,"right","caption对齐方式为右上对齐"),equal(l[0].style.verticalAlign,"top","caption对齐方式为右上对齐");var a=e.body.getElementsByTagName("td");t.setStart(a[0],0).collapse(!0).select(),e.execCommand("cellalignment",{align:"right",vAlign:"top"}),equal(a[0].align,"right","td对齐方式为右上对齐"),equal(a[0].vAlign,"top","td对齐方式为右上对齐"),t.selectNode(a[1].firstChild,0).select(),e.execCommand("cellalignment",{align:"center",vAlign:"middle"}),equal(a[1].align,"center","p对齐方式为居中对齐"),start()},50)}),test("修改table屬性",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:3}),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),e.execCommand("tablealignment","center");var l=e.body.getElementsByTagName("table")[0];equal(l.align,"center","对齐方式居中"),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),e.execCommand("edittable","#ff0000"),ua.manualDeleteFillData(e.body);var a=e.body.getElementsByTagName("td");ua.browser.ie&&ua.browser.ie<9?equal(a[0].style.borderColor,"#ff0000","边框颜色：红色"):equal(a[0].style.borderColor,"rgb(255, 0, 0)","边框颜色：红色"),equal(e.queryCommandState("edittable"),0,"state")}),test("修改单元格",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable");var l=e.body.getElementsByTagName("td");t.setStart(l[2],0).collapse(!0).select(),e.execCommand("edittd","#9bbb59"),ua.browser.ie&&ua.browser.ie<9?equal(l[2].style.backgroundColor,"#9bbb59","背景颜色"):equal(l[2].style.backgroundColor,"rgb(155, 187, 89)","背景颜色");var a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0],l[6]);a.setSelected(s),t.setStart(l[0],0).collapse(!0).select(),e.execCommand("edittd","#9bbb59"),e.execCommand("cellalignment",{align:"center",vAlign:"bottom"}),a.clearSelected(),l=e.body.firstChild.getElementsByTagName("td"),ua.browser.ie&&ua.browser.ie<9?equal(l[5].style.backgroundColor,"#9bbb59","背景颜色"):equal(l[5].style.backgroundColor,"rgb(155, 187, 89)","背景颜色"),equal(l[5].align,"center","水平居中"),equal(l[5].vAlign,"bottom","下方"),equal(e.queryCommandState("edittd"),0,"state"),equal(e.queryCommandState("cellalignment"),0,"state")}),test("表格前插行",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable");var l=e.body.firstChild.getElementsByTagName("td");t.setStart(l[1],0).collapse(!0).select(),e.execCommand("insertparagraphbeforetable"),ua.manualDeleteFillData(e.body);var a=ua.browser.ie?"&nbsp;":"<br>";equal(e.body.firstChild.innerHTML,a,"表格前插行")}),test("插入行",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("mergedown"),t.setStart(l[4],0).collapse(!0).select(),e.execCommand("insertrow"),l=e.body.getElementsByTagName("td"),equal(l[0].getAttribute("rowspan"),3,"[0][0]单元格rowspan"),e.undoManger.undo(),equal(l[0].getAttribute("rowspan"),2,"[0][0]单元格rowspan")}),test("选中两行，插入行",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<table width="984"><tbody><tr><td width="307" valign="top">hello</td><td width="307" valign="top"></td><td width="307" valign="top"></td></tr><tr><td width="307" valign="top"></td><td width="307" valign="top"></td><td width="307" valign="top"></td></tr><tr><td width="307" valign="top"></td><td width="307" valign="top"></td><td width="307" valign="top"></td></tr></tbody></table>');var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[1].cells[0]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("insertrow"),a.clearSelected(),equal(e.body.getElementsByTagName("tr").length,5,"选中两行，前插行，3行变5行"),l=e.body.firstChild.getElementsByTagName("tr"),ua.manualDeleteFillData(l[2]),equal(l[2].cells[0].innerHTML,"hello","原来的第1行变成第3行"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[2].cells[0],l[3].cells[0]),a.setSelected(s),t.setStart(l[2].cells[0],0).collapse(!0).select(),e.execCommand("insertrownext"),a.clearSelected(),equal(e.body.getElementsByTagName("tr").length,7,"选中两行，前插行，5行变7行"),l=e.body.firstChild.getElementsByTagName("tr"),ua.manualDeleteFillData(l[2]),equal(l[2].cells[0].innerHTML,"hello","")}),test("选中两列，插入列",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<table width="984"><tbody><tr><td width="307" valign="top">hello</td><td width="307" valign="top"></td><td width="307" valign="top"></td></tr><tr><td width="307" valign="top"></td><td width="307" valign="top"></td><td width="307" valign="top"></td></tr><tr><td width="307" valign="top"></td><td width="307" valign="top"></td><td width="307" valign="top"></td></tr></tbody></table>');var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[0].cells[1]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("insertcol"),a.clearSelected(),equal(e.body.getElementsByTagName("tr")[0].childNodes.length,5,"选中两列，前插列，3行变5列"),l=e.body.firstChild.getElementsByTagName("tr"),ua.manualDeleteFillData(l[0]),equal(l[0].cells[2].innerHTML,"hello","原来的第1列变成第3列"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[2],l[0].cells[3]),a.setSelected(s),t.setStart(l[0].cells[2],0).collapse(!0).select(),e.execCommand("insertcolnext"),a.clearSelected(),equal(e.body.getElementsByTagName("tr")[0].childNodes.length,7,"选中两列，前插列，5列变7列"),l=e.body.firstChild.getElementsByTagName("tr"),ua.manualDeleteFillData(l[0]),equal(l[0].cells[2].innerHTML,"hello","")}),test("trace 3986 插入列",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("mergeright"),t.setStart(l[3],0).collapse(!0).select(),e.execCommand("insertcol"),l=e.body.getElementsByTagName("td"),equal(l[0].getAttribute("colspan"),3,"[0][0]单元格colspan"),e.undoManger.undo(),equal(l[0].getAttribute("colspan"),2,"[0][0]单元格colspan"),t.setStart(l[1],0).setCursor(),e.execCommand("insertcol"),equal(l[0].parentNode.cells.length,3,"插入了一列")}),test("带th的表格，插入列",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:3});var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("inserttitle"),stop(),setTimeout(function(){var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("insertcol");var a=e.body.getElementsByTagName("tr")[0].childNodes;equal(a.length,3,"第一行有3个单元");for(var s=0;s<a.length;s++)equal(a[s].tagName.toLowerCase(),"th","第"+s+"个单元tagName是th");start()},20)}),test("原表格非第一行带th，插入列",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<table width="984"><tbody><tr><td width="471" valign="top"></td><td width="471" valign="top"></td></tr><tr><th width="471" valign="top"></th><td width="471" valign="top"></td></tr></tbody></table>'),stop(),setTimeout(function(){var l=e.body.getElementsByTagName("tr");t.setStart(l[1].cells[0],0).collapse(!0).select(),e.execCommand("insertcolnext"),l=e.body.getElementsByTagName("tr"),equal(l[1].childNodes.length,3,"插入一列"),equal(l[1].cells[1].tagName.toLowerCase(),"td","除第一行以外，插入的不能是th"),start()},20)}),test("删除行",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<table><tbody><tr><td width="483" valign="top">1</td><td width="483" valign="top">2</td></tr><tr><td width="483" valign="top">3</td><td width="483" valign="top">4</td></tr><tr><td width="483" valign="top">5</td><td width="483" valign="top">6</td></tr></tbody></table>'),stop(),setTimeout(function(){var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(1).select(),e.execCommand("deleterow"),equal(e.body.getElementsByTagName("tr").length,2,"删除行"),e.undoManger.undo(),setTimeout(function(){equal(e.body.getElementsByTagName("tr").length,3,"撤销后的行数"),l=e.body.getElementsByTagName("td"),t.setStart(l[5],0).collapse(1).select(),e.execCommand("deleterow"),setTimeout(function(){equal(e.body.getElementsByTagName("tr").length,2,"删除行");var l=e.document.getElementsByTagName("table")[0],a=l.rows[0].cells[0];setTimeout(function(){t.setStart(a,0).setCursor(),e.execCommand("mergeDown"),equal(a.rowSpan,2,"合并了一行"),e.execCommand("deleterow"),equal(l.rows.length,1,"在合并的单元格中删除行后，表格变成了一行"),start()},50)},50)},50)},50)}),test("选中部分单元格，删除行列",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[0].cells[1]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("deleterow"),a.clearSelected(),equal(e.body.getElementsByTagName("tr").length,2,"选中部分单元格，删除行"),l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[0].cells[1]),a.setSelected(s),t.setStart(l[0].cells[0],0).setEnd(l[0].cells[1],1).select(),e.execCommand("deletecol"),a.clearSelected(),equal(l[0].childNodes.length,1,"选中部分单元格，删除列"),l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[1].cells[0]),a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),a.clearSelected(),e.execCommand("deletecol"),equal(e.body.getElementsByTagName("table").length,0,"删除列至表格删空"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[2].cells[0]),a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("deleterow"),a.clearSelected(),equal(e.body.getElementsByTagName("table").length,0,"删除列至表格删空"),start()},50),stop()}),test("settablebackground",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2});var l=e.body.firstChild.getElementsByTagName("td"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0],l[2]);a.setSelected(s),t.setStart(l[0],0).collapse(!0).select(),e.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]}),setTimeout(function(){var l=(ua.browser.ie?"":"<br>",e.body.firstChild.getElementsByTagName("td"));ua.browser.ie&&ua.browser.ie<9?(ok("#bbb"===l[0].style.backgroundColor,"选区隔行变色， 第一列第一行颜色匹配"),ok("#ccc"===l[2].style.backgroundColor,"选区隔行变色， 第一列第二行颜色匹配")):(ok("rgb(187, 187, 187)"===l[0].style.backgroundColor,"选区隔行变色， 第一列第一行颜色匹配"),ok("rgb(204, 204, 204)"===l[2].style.backgroundColor,"选区隔行变色， 第一列第二行颜色匹配")),t.setStart(l[0],0).collapse(!0).select(),e.execCommand("cleartablebackground"),setTimeout(function(){ok(""===l[0].style.backgroundColor,"取消选区隔行变色， 第一列第一行颜色匹配"),ok(""===l[2].style.backgroundColor,"取消选区隔行变色， 第一列第二行颜色匹配"),start()},20)},20),stop()}),test("interlacetable",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2});var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(1).select(),e.execCommand("interlacetable"),stop(),setTimeout(function(){equal(e.body.firstChild.attributes.interlaced.nodeValue,"enabled",""),equal(e.body.getElementsByTagName("tr")[0].className,"ue-table-interlace-color-single firstRow",""),equal(e.body.getElementsByTagName("tr")[1].className,"ue-table-interlace-color-double",""),l=e.body.getElementsByTagName("td"),t.setStart(l[0],0).collapse(1).select(),e.execCommand("uninterlacetable"),setTimeout(function(){equal(e.body.firstChild.attributes.interlaced.nodeValue,"disabled",""),equal(e.body.getElementsByTagName("tr")[0].className,"firstRow",""),start()},20)},20)}),test("trace 749：拆分为列后2列都有文本",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");l[1].innerHTML="hello",t.setStart(l[0],0).collapse(!0).select(),e.execCommand("mergeright");var a=e.body.getElementsByTagName("tr")[0];equal($(a.firstChild).attr("colspan"),"2","跨度2列"),e.execCommand("splittocols"),ua.manualDeleteFillData(e.body),l=e.body.getElementsByTagName("td"),ok(l[0].innerHTML,"第一个单元格中有内容"),ok(""==l[1].innerHTML||"<br>"==l[1].innerHTML,"第二个单元格中有内容")}),test("trace 743：合并单元格后删除列再撤销",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:4,numRows:4}),ua.manualDeleteFillData(e.body),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[0].cells[3]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("deleterow"),l=e.body.getElementsByTagName("tr"),equal(l.length,3,"删除后只剩3个tr"),e.undoManger.undo(),l=e.body.getElementsByTagName("tr"),equal(l.length,4,"撤销后有4个tr"),equal($(l[0].cells[0]).attr("colspan"),4,"第一行的第一个单元格colspan为4"),start()},50),stop()}),test("trace 726：选中合并过的单元格和普通单元格，查看完全拆分单元格菜单是否高亮",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:4,numRows:4}),ua.manualDeleteFillData(e.body),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[1].cells[1]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),equal(e.queryCommandState("splittocells"),0,"应当可以拆分单元格"),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[3].cells[3]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.queryCommandState("splittocells"),equal(e.queryCommandState("splittocells"),-1,"应当不可以拆分单元格"),start()},50)},50),stop()}),test("trace 718：2次撤销删除列",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:4,numRows:4}),ua.manualDeleteFillData(e.body),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[1].cells[1],l[2].cells[2]);a.setSelected(s),t.setStart(l[1].cells[1],0).collapse(!0).select(),e.execCommand("mergecells"),equal(l[1].cells[1].rowSpan,2,"rowspan 为2"),equal(l[1].cells[1].colSpan,2,"colspan 为2"),e.execCommand("deletecol"),equal(l[1].cells.length,3,"3个td"),e.undoManger.undo(),l=e.body.firstChild.getElementsByTagName("tr"),equal(l[1].cells.length,3,"3个td"),equal(l[1].cells[1].rowSpan,2,"rowspan 为2"),equal(l[1].cells[1].colSpan,2,"colspan 为2"),t.setStart(l[1].cells[1],0).collapse(1).select(),e.execCommand("deletecol"),equal(l[1].cells.length,3,"3个td"),equal(l[1].cells[1].rowSpan,2,"rowspan 为2"),ok(void 0==l[1].cells[1].colSpan||1==l[1].cells[1].colSpan,"colspan为1或者undefined"),start()},50),stop()}),test("trace 1098:多次合并单元格偶切换到源码再切回来",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[2].cells[0]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),setTimeout(function(){l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[1],l[2].cells[0]),a.setSelected(s),t.setStart(l[0].cells[1],0).collapse(!0).select(),e.execCommand("mergecells"),setTimeout(function(){l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[2],l[1].cells[0]),a.setSelected(s),t.setStart(l[0].cells[2],0).collapse(!0).select(),e.execCommand("mergecells"),e.execCommand("source"),setTimeout(function(){e.execCommand("source"),setTimeout(function(){l=e.body.firstChild.getElementsByTagName("tr"),equal(l.length,3,"3个tr"),equal(l[0].cells[0].rowSpan,3,"第一个单元格rowspan 3"),equal(l[0].cells[1].rowSpan,3,"第二个单元格rowspan 3"),equal(l[0].cells.length,3,"3个td"),equal(l[1].cells.length,0,"0个td"),equal(l[2].cells.length,1,"1个td"),start()},50)},50)},50)},50)},50),stop()}),test("trace 1307:adjustTable--多次合并单元格切换到源码再切回来--选中单元格浏览器会假死",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:4,numRows:4}),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[1].cells[0],l[3].cells[1]);a.setSelected(s),t.setStart(l[1].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[2],l[2].cells[0]);a.setSelected(s),t.setStart(l[0].cells[2],0).collapse(!0).select(),e.execCommand("mergecells"),e.execCommand("source"),setTimeout(function(){e.execCommand("source"),setTimeout(function(){l=e.body.getElementsByTagName("tr"),equal(l[1].rowIndex,1,"（1,1）行索引"),equal(l[1].cells[0].cellIndex,0,"（1,0）列索引"),equal(l[1].cells[1].cellIndex,1,"（1,1）列索引"),equal(l[2].rowIndex,2,"（2,2）行索引"),equal(l[2].cells[0].cellIndex,0,"（2,0）列索引"),equal(l[1].cells[0].rowSpan,3,"第二行第一个单元格rowspan 3"),equal(l[1].cells[0].colSpan,2,"第二行第一个单元格colspan 2"),equal(l[0].cells[2].rowSpan,3,"第一行第三个单元格rowspan 3"),equal(l.length,4,"4个tr"),equal(l[0].cells.length,4,"4个td"),equal(l[1].cells.length,2,"2个td"),equal(l[2].cells.length,1,"1个td"),equal(l[3].cells.length,2,"2个td"),start()},50)},50)},50)},50),stop()}),test("单元格对齐方式-align",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),ua.manualDeleteFillData(e.body);var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[0].cells[2]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),a.clearSelected(),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),e.execCommand("cellalign","center"),ua.manualDeleteFillData(e.body);var o=e.body.getElementsByTagName("td");equal(o[0].align,"center","第一个单元格居中对齐"),t.setStart(o[0],0).collapse(!0).select(),e.execCommand("splittocols"),o=e.body.getElementsByTagName("td"),equal(o[0].align,"center","第一个单元格居中对齐"),equal(o[1].align,"center","第二个单元格居中对齐"),equal(o[2].align,"center","第二个单元格居中对齐")}),test("单元格对齐方式-vAlign",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),ua.manualDeleteFillData(e.body),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),e.execCommand("mergedown"),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),e.execCommand("cellvalign","middle"),ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");equal(l[0].vAlign,"middle","第一个单元格居中对齐"),t.setStart(l[0],0).collapse(!0).select(),e.execCommand("splittorows"),l=e.body.getElementsByTagName("td"),equal(l[0].vAlign,"middle","第一个单元格居中对齐"),equal(l[2].vAlign,"middle","第二个单元格居中对齐")}),test("adaptbytext，adaptbywindow",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),8!=ua.browser.ie&&ok(e.body.offsetWidth===e.body.getElementsByTagName("table")[0].offsetWidth,"默认按窗口计算宽度"),e.execCommand("adaptbytext"),stop(),setTimeout(function(){equal(e.body.firstChild.width,"","按内容自适应"),e.execCommand("adaptbywindow"),setTimeout(function(){ok(parseInt(e.body.firstChild.width)-e.body.offsetWidth/2>0,"默认按窗口计算宽度"),start()},20)},20)}),test("deletetitle",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2});var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("inserttitle"),stop(),setTimeout(function(){var a=e.body.firstChild.getElementsByTagName("tr");equal(a.length,3,"表格增加一行");for(var s=0;s<a[0].childNodes.length;s++)equal(a[0].childNodes[s].tagName.toLowerCase(),"th","增加的th");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("deletetitle"),setTimeout(function(){equal(e.body.firstChild.getElementsByTagName("tr").length,2,"表格减少一行"),equal(e.body.firstChild.getElementsByTagName("tr")[0].firstChild.tagName.toLowerCase(),"td","第一行不是标题"),start()},20)},20)}),test("trace 3222：在合并后的单元格中按tab键",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable"),ua.manualDeleteFillData(e.body),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[1].cells[1],l[2].cells[1]);a.setSelected(s),t.setStart(l[1].cells[1],0).collapse(!0).select(),e.execCommand("mergecells"),l[1].cells[2].innerHTML="asd",t.setStart(l[1].cells[1],0).collapse(!0).select(),ua.keydown(e.body,{keyCode:9}),ua.browser.gecko||ua.browser.webkit?equal(e.selection.getRange().startContainer.innerHTML,"asd","第一次tab键"):equal(e.selection.getRange().startContainer.data,"asd","第一次tab键"),t.setStart(l[1].cells[1],0).collapse(!0).select(),ua.keydown(e.body,{keyCode:9}),ua.browser.gecko||ua.browser.webkit?equal(e.selection.getRange().startContainer.innerHTML,"asd","第二次tab键"):equal(e.selection.getRange().startContainer.data,"asd","第二次tab键"),start()},50),stop()}),test("trace 3191：删除表格名称",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable"),setTimeout(function(){var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("insertcaption"),t.setStart(e.body.getElementsByTagName("caption")[0],0).collapse(!0).select(),e.execCommand("deletecaption"),equal(e.body.getElementsByTagName("caption").length,"0","表格名称被删除"),t.setStart(e.body.firstChild,0).collapse(!0).select(),ua.keydown(e.body,{keyCode:90,ctrlKey:!0}),equal(e.body.getElementsByTagName("caption").length,"1","表格名称被还原"),start()},50),stop()}),test("trace 3195：合并单元格后删除列再撤销",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:4,numRows:4}),ua.manualDeleteFillData(e.body),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild);l[0].cells[1].innerHTML="asd";var s=a.getCellsRange(l[0].cells[0],l[2].cells[2]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("mergecells"),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("splittocols"),l=e.body.getElementsByTagName("tr"),equal(l.length,4,"4个tr"),equal(l[0].cells.length,4,"4个td"),equal(l[1].cells.length,1,"1个td"),equal(l[2].cells.length,1,"1个td"),equal(l[3].cells.length,4,"4个td"),equal(l[0].cells[0].vAlign,"top","单元格[0][0]的vAlign"),equal(l[0].cells[0].align,"","单元格[0][0]的align"),equal(l[0].cells[1].vAlign,"top","单元格[0][1]的vAlign"),equal(l[0].cells[2].vAlign,"top","单元格[0][2]的vAlign"),ua.browser.ie?(equal(l[0].cells[1].align,"","单元格[0][1]的align"),
equal(l[0].cells[2].align,"","单元格[0][2]的align")):(equal(l[0].cells[1].align,"null","单元格[0][1]的align"),equal(l[0].cells[2].align,"null","单元格[0][2]的align")),start()},50),stop()}),test(" trace 3779 trace 3231：向右合并--拆分成列",function(){if(!(ua.browser.ie&&ua.browser.ie>8)){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),setTimeout(function(){ua.manualDeleteFillData(e.body);var l=e.body.getElementsByTagName("td");l[1].innerHTML="asd",t.setStart(l[1],0).collapse(!0).select(),e.execCommand("insertcolnext"),ua.manualDeleteFillData(e.body),equal(e.body.getElementsByTagName("tr")[0].cells.length,"3","3列"),equal(e.body.getElementsByTagName("td")[1].innerHTML,"asd","后插入行");var a=ua.browser.ie?"":"<br>";equal(e.body.getElementsByTagName("td")[2].innerHTML,a,"后插入行"),t.setStart(e.body.getElementsByTagName("td")[2],0).collapse(!0).select(),e.execCommand("insertrownext"),equal(e.body.getElementsByTagName("tr").length,3,"3行"),e.execCommand("deletecol"),equal(e.body.getElementsByTagName("td")[1].innerHTML,"asd",""),equal(e.body.getElementsByTagName("td").length,"6",""),start()},50),stop()}}),test("trace 713：合并最后一列单元格后再前插入列",function(){if(!ua.browser.ie){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3}),setTimeout(function(){var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[2],l[2].cells[2]);a.setSelected(s),t.setStart(l[0].cells[2],0).collapse(!0).select(),e.execCommand("mergecells"),setTimeout(function(){equal($(l[0].cells[2]).attr("rowspan"),3,"跨3行"),e.execCommand("insertcol"),setTimeout(function(){l=e.body.getElementsByTagName("tr"),equal(l[0].cells.length,4,"4列"),equal($(l[0].cells[3]).attr("rowspan"),3,"跨3行"),start()},50)},50)},50),stop()}}),test("inserttitlecol, deletetitlecol",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2});var l=e.body.getElementsByTagName("td");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("inserttitlecol"),stop(),setTimeout(function(){var a=e.body.firstChild.getElementsByTagName("tr");equal(a[0].children.length,3,"表格增加一列");for(var s=0;s<a.length;s++)equal(a[s].childNodes[0].tagName.toLowerCase(),"th","增加的th");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("deletetitlecol"),setTimeout(function(){equal(a[0].children.length,2,"表格减少一列"),equal(e.body.firstChild.getElementsByTagName("tr")[0].firstChild.tagName.toLowerCase(),"td","第一列不是标题"),start()},20)},20)}),test("contextMenu trace 3216：前插入行",function(){var e=te.obj[0],t=te.obj[1];stop();var l=e.getLang("contextMenu");e.execCommand("cleardoc"),e.execCommand("inserttable");var a=e.body.getElementsByTagName("td");a[0].innerHTML="asd",t.setStart(a[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var s=document.getElementsByClassName("edui-menu-body")[1],o=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(o[o.length-1]):ua.mouseover(o[o.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),ua.click(s.childNodes[6]),equal(e.body.getElementsByTagName("tr").length,6,"前插入行后有6行"),equal(ua.getChildHTML(e.body.getElementsByTagName("td")[5]),"asd","原单元格中文本未改变"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},200)},200)}),test("contextMenu 选区背景隔行",function(){var e=te.obj[0],t=te.obj[1];stop();var l=e.getLang("contextMenu");e.execCommand("cleardoc"),e.execCommand("inserttable");var a=e.body.firstChild.getElementsByTagName("tr"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[0].cells[0],a[1].cells[1]);s.setSelected(o),t.setStart(a[0].cells[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var n=document.getElementsByClassName("edui-menu-body")[3],d=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(d[d.length-1]):ua.mouseover(d[d.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),equal(n.childNodes.length,4,"4个子项目"),browser.gecko?equal(n.textContent,"表格隔行变色选区背景隔行红蓝相间三色渐变","检查menu显示的字符"):equal(n.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),"表格隔行变色选区背景隔行红蓝相间三色渐变","检查menu显示的字符"),ua.click(n.childNodes[1]),s.clearSelected(),a=e.body.getElementsByTagName("tr"),8==ua.browser.ie?(equal(a[0].cells[0].style.backgroundColor,"#bbb","第一行"),equal(a[1].cells[1].style.backgroundColor,"#ccc","第二行")):(equal(a[0].cells[0].style.backgroundColor,"rgb(187, 187, 187)","第一行"),equal(a[1].cells[1].style.backgroundColor,"rgb(204, 204, 204)","第二行")),o=s.getCellsRange(a[0].cells[2],a[1].cells[3]),s.setSelected(o),t.setStart(a[0].cells[2],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild),n=document.getElementsByClassName("edui-menu-body")[3],d=document.getElementsByClassName("edui-for-table"),ua.browser.ie?ua.mouseenter(d[d.length-1]):ua.mouseover(d[d.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),equal(n.childNodes.length,4,"4个子项目"),ua.click(n.childNodes[2]),s.clearSelected(),a=e.body.getElementsByTagName("tr"),equal(a[0].cells[2].style.backgroundColor,"red","第一行"),equal(a[1].cells[3].style.backgroundColor,"blue","第二行"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[0].cells[0],a[1].cells[3]),s.setSelected(o),t.setStart(a[0].cells[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild),n=document.getElementsByClassName("edui-menu-body")[3],d=document.getElementsByClassName("edui-for-table"),ua.browser.ie?ua.mouseenter(d[d.length-1]):ua.mouseover(d[d.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),ua.click(n.childNodes[2]),a=e.body.getElementsByTagName("tr"),equal(a[1].cells[2].style.backgroundColor,"","取消背景隔行"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},200)},200)},200)},200)}),test("contextMenu 三色渐变",function(){var e=te.obj[0],t=te.obj[1];stop(),e.execCommand("cleardoc"),e.execCommand("inserttable");var l=e.body.getElementsByTagName("td"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0],l[16]);a.setSelected(s),t.setStart(l[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var o=document.getElementsByClassName("edui-menu-body")[3],n=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(n[n.length-1]):ua.mouseover(n[n.length-1]),ua.click(o.childNodes[3]),a.clearSelected(),l=e.body.getElementsByTagName("td"),8==ua.browser.ie?(equal(l[0].style.backgroundColor,"#aaa","第一行"),equal(l[6].style.backgroundColor,"#bbb","第二行"),equal(l[11].style.backgroundColor,"#ccc","第二行")):(equal(l[0].style.backgroundColor,"rgb(170, 170, 170)","第一行"),equal(l[6].style.backgroundColor,"rgb(187, 187, 187)","第二行"),equal(l[11].style.backgroundColor,"rgb(204, 204, 204)","第二行")),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},20)}),test("contextMenu trace 3210：添加单元格背景色",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3});var l=e.body.firstChild.getElementsByTagName("tr"),a=e.getUETable(e.body.firstChild),s=a.getCellsRange(l[0].cells[0],l[1].cells[1]);a.setSelected(s),t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("edittd","#ff0000"),stop(),setTimeout(function(){var t=e.body.firstChild.getElementsByTagName("td");equal(t[2].style.backgroundColor,"","背景色不变"),equal(ua.formatColor(t[0].style.backgroundColor),"#ff0000","添加单元格背景色"),equal(ua.formatColor(t[4].style.backgroundColor),"#ff0000","添加单元格背景色"),start()},50)}),test("contextMenu trace 3099: 清除边框颜色",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3});var l=e.body.firstChild.getElementsByTagName("tr");t.setStart(l[0].cells[0],0).collapse(!0).select(),e.execCommand("edittable","#ff0000"),stop(),setTimeout(function(){var t=e.body.firstChild.getElementsByTagName("td");equal(ua.formatColor(t[0].style.borderColor),"#ff0000","添加边框颜色"),equal(ua.formatColor(t[2].style.borderColor),"#ff0000","添加边框颜色"),e.execCommand("edittable",""),setTimeout(function(){equal(t[0].style.borderColor,"","边框颜色被清除"),start()},50)},50)}),test("trace 3986 contextMenu 标题行中右插入列",function(){var e=te.obj[0],t=te.obj[1];stop();var l=e.getLang("contextMenu");e.execCommand("cleardoc"),e.execCommand("inserttable"),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),e.execCommand("inserttitle"),t.setStart(e.body.getElementsByTagName("th")[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var a=document.getElementsByClassName("edui-menu-body")[1],s=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(s[s.length-1]):ua.mouseover(s[s.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),equal(a.childNodes.length,15,"15个子项目");var t=l.deletetable+l.deleterow+l.deletecol+l.insertcolnext+l.insertcaption+l.deletetitle+l.inserttitlecol+l.mergeright+l.edittd+l.edittable+l.setbordervisible;browser.gecko?equal(a.textContent,t,"检查menu显示的字符"):equal(a.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),t,"检查menu显示的字符"),ua.click(a.childNodes[4]),equal(e.body.getElementsByTagName("tr")[0].cells.length,6,"左插入列后有6列"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},200)})}),test("contextMenu trace 3060：单元格对齐方式",function(){var e=te.obj[0],t=te.obj[1];stop();var l=e.getLang("contextMenu");e.execCommand("cleardoc"),e.execCommand("inserttable"),e.body.getElementsByTagName("td")[0].innerHTML="asd",t.setStart(e.body.firstChild.firstChild.firstChild.firstChild,0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var a=document.getElementsByClassName("edui-for-aligntd")[0];setTimeout(function(){l=e.getLang("contextMenu"),ua.click(a.childNodes[0]);var t=document.getElementsByClassName("edui-cellalignpicker-body")[0];equal(t.childNodes[0].getElementsByTagName("td").length,9,"9种单元格对齐方式"),ua.click(t.childNodes[0].childNodes[0].childNodes[1].childNodes[2].firstChild),setTimeout(function(){var t=e.body.getElementsByTagName("td");equal(t[0].align,"right","水平居右"),equal(t[0].vAlign,"middle","垂直居中"),ua.browser.ie>8?equal(e.selection.getRange().startContainer.tagName.toLowerCase(),"td","光标位于单元格中"):equal(e.selection.getRange().startContainer.parentNode.tagName.toLowerCase(),"td","光标位于单元格中"),setTimeout(function(){start()},20)},200)},200)}),test("contextMenu trace 3315：表格隔行变色",function(){var e=te.obj[0],t=te.obj[1],l=e.getLang("contextMenu");e.execCommand("cleardoc"),e.execCommand("inserttable"),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var a=document.getElementsByClassName("edui-menu-body")[8],s=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(s[s.length-1]):ua.mouseover(s[s.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),equal(a.childNodes.length,1,"1个子项目"),browser.gecko?equal(a.textContent,"表格隔行变色","检查menu显示的字符"):equal(a.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),"表格隔行变色","检查menu显示的字符"),ua.click(a.childNodes[0]);for(var o=e.body.getElementsByTagName("tr"),n=0;n<o.length;n++)n%2==0?ok(o[n].className.indexOf("ue-table-interlace-color-single")>-1,"第"+n+"行：浅色行"):ok(o[n].className.indexOf("ue-table-interlace-color-double")>-1,"第"+n+"行：深色行");t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild),a=document.getElementsByClassName("edui-menu-body")[8],s=document.getElementsByClassName("edui-for-table"),ua.browser.ie?ua.mouseenter(s[s.length-1]):ua.mouseover(s[s.length-1]),setTimeout(function(){l=e.getLang("contextMenu"),equal(a.childNodes.length,1,"2个子项目"),browser.gecko?equal(a.textContent,"取消表格隔行变色","检查menu显示的字符"):equal(a.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),"取消表格隔行变色","检查menu显示的字符"),ua.click(a.childNodes[0]),ok(e.body.getElementsByTagName("tr")[0].className.indexOf("ue-table-interlace-color")<0,"取消表格隔行变色"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},200)},200)},200),stop()});
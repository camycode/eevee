module("plugins.rowspacing"),test("设置段前距查看状态反射",function(){var t=te.obj[0],e=te.obj[1];t.setContent("<p>hello1</p><p>hello2</p>"),stop(),setTimeout(function(){e.setStart(t.body.firstChild,0).setEnd(t.body.lastChild,1).select(),t.execCommand("rowspacing",15,"top"),equal(t.queryCommandValue("rowspacing","top"),15,"查看段前距"),e.setStart(t.body.firstChild.firstChild,1).collapse(!0).select(),equal(t.queryCommandValue("rowspacing","top"),15,"查看段前距"),start()},50)}),test("非闭合清除段前距等样式，查看状态反射",function(){var t=te.obj[0],e=te.obj[1];t.setContent("<p>hello1</p><p>hello2</p>"),e.setStart(t.body.firstChild,0).setEnd(t.body.lastChild,1).select(),t.execCommand("rowspacing",20,"top"),equal(t.queryCommandValue("rowspacing","top"),20,"段前距为2.0")}),test("闭合清除段前距等样式，查看状态反射",function(){var t=te.obj[0],e=te.obj[1];t.setContent("<p>hello1</p><p>hello2</p>"),e.setStart(t.body.firstChild,0).collapse(!0).select(),t.execCommand("rowspacing",20,"top"),equal(t.queryCommandValue("rowspacing","top"),20,"段前距为2.0"),e.setStart(t.body.firstChild,0).collapse(!0).select(),t.execCommand("removeformat"),equal(t.queryCommandValue("rowspacing","top"),5,"闭合清除格式后，段前距为5")}),test("设置段后距后设置字体颜色",function(){var t=te.obj[0],e=te.obj[1];stop(),t.setContent('<p>hello1<a href="">hello</a></p><p>hello2</p>'),e.setStart(t.body.firstChild,0).setEnd(t.body.lastChild,1).select(),t.execCommand("rowspacing",15,"bottom"),setTimeout(function(){t.execCommand("forecolor","rgb(255,0,0)"),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),e.setStart(t.body.firstChild.firstChild,1).collapse(!0).select(),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),start()},50)}),test("设置段后距后设置加粗等多种样式",function(){var t=te.obj[0],e=te.obj[1];stop(),setTimeout(function(){t.setContent("<p>hello1</p><p>hello2</p>"),setTimeout(function(){e.setStart(t.body.firstChild,0).setEnd(t.body.lastChild,1).select(),t.execCommand("rowspacing",15,"bottom"),setTimeout(function(){t.execCommand("bold"),t.execCommand("underline"),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),start()},50)},50)},100)}),test("非闭合去除加粗等样式",function(){var t=te.obj[0],e=te.obj[1];stop(),t.setContent("<p>hello1</p><p>hello2</p>"),setTimeout(function(){e.setStart(t.body.firstChild,0).setEnd(t.body.lastChild,1).select(),t.execCommand("rowspacing",15,"bottom"),setTimeout(function(){t.execCommand("bold"),t.execCommand("underline"),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),t.execCommand("removeformat"),equal(t.queryCommandValue("rowspacing","bottom"),5,"去除样式后查看段后距"),start()},50)},50)}),test("闭合去除样式",function(){var t=te.obj[0],e=te.obj[1];stop(),t.setContent("<p>hello1</p><p>hello2</p>"),setTimeout(function(){e.setStart(t.body.firstChild,0).setEnd(t.body.lastChild,1).select(),t.execCommand("rowspacing",15,"bottom"),setTimeout(function(){t.execCommand("bold"),t.execCommand("underline"),e.setStart(t.body.firstChild,0).collapse(!0).select(),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),e.setStart(t.body.lastChild,0).collapse(!0).select(),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),t.execCommand("removeformat"),equal(t.queryCommandValue("rowspacing","bottom"),5,"去除样式后查看段后距"),e.setStart(t.body.firstChild,0).collapse(!0).select(),equal(t.queryCommandValue("rowspacing","bottom"),15,"查看段后距"),start()},50)},50)}),test("表格中设置段距",function(){var t=te.obj[0],e=te.obj[1];t.setContent("<table><tbody><tr><td>hello1</td><td>hello2</td></tr><tr><td></td><td></td></tr></tbody></table>"),stop(),setTimeout(function(){var o=t.body.firstChild.getElementsByTagName("td");e.selectNode(o[0].firstChild).select(),t.execCommand("rowspacing",20,"top"),equal(t.queryCommandValue("rowspacing","top"),20,"设置表格中文本段前距为2"),setTimeout(function(){e.setStart(o[0].firstChild.firstChild,1).collapse(!0).select(),equal(t.queryCommandValue("rowspacing","top"),20,"设置表格中文本段前距为2"),e.setStart(o[1].firstChild,1).collapse(!0).select(),t.execCommand("rowspacing",15,"bottom"),e.selectNode(o[1]).select(),equal(t.queryCommandValue("rowspacing","bottom"),15,"设置表格中文本段后距为1.5"),e.setStart(o[2],0).collapse(!0).select(),t.execCommand("rowspacing",25,"bottom"),equal(t.queryCommandValue("rowspacing","bottom"),25,"设置表格中文本段后距为2.5"),start()},50)},50)}),test("跨多个单元格设置段前距",function(){var t=te.obj[0],e=te.obj[1];t.setContent("<table><tbody><tr><td>hello1</td><td>hello2<img /></td></tr><tr><td><div>hello3</div></td><td><p>hello4</p></td></tr></tbody></table>"),stop(),setTimeout(function(){var o=t.body.firstChild.getElementsByTagName("td"),a=t.body.getElementsByTagName("p");e.selectNode(t.body.firstChild).select(),t.execCommand("rowspacing",15,"top");for(var l=0;l<o.length;l++)e.selectNode(o[l]).select(),equal(t.queryCommandValue("rowspacing","top"),15,"设置表格中文本段前距为1.5"),equal(a[l].style.marginTop,"15px","段前距属性都是加在第一个孩子节点上");start()},50)}),test("对插入的代码设置多倍段前距",function(){var t=te.obj[0],e=te.obj[1];t.setContent("<p></p>"),stop(),setTimeout(function(){e.setStart(t.body.firstChild,0).collapse(!0).select();var o="var tds = editor.body.firstChild.getElementsByTagName( 'td' );\n range.selectNode( editor.body.firstChild ).select();";t.execCommand("inserthtml","<pre style='background-color: #F8F8F8;border: 1px solid #CCCCCC;padding:10px 10px'>"+o+"</pre>"),equal(t.body.firstChild.tagName.toLowerCase(),"pre","第一个孩子节点为pre"),e.selectNode(t.body.firstChild).select(),t.execCommand("rowspacing",20,"top");var a=t.body.firstChild;equal(a.tagName.toLowerCase(),"pre","不允许将p换成pre"),equal(a.style.borderWidth,"1px","宽度"),ok("#CCCCCC"==a.style.borderColor.toUpperCase()||"rgb(204, 204, 204)"==a.style.borderColor,"颜色"),start()},50)}),test("在合并单元格中设置多倍段前距",function(){var t=new baidu.editor.Editor({autoFloatEnabled:!1});stop(),setTimeout(function(){var e=document.body.appendChild(document.createElement("div"));te.dom.push(e),t.render(e),setTimeout(function(){t.setContent("<p></p>");var e=new baidu.editor.dom.Range(t.document);e.setStart(t.body.firstChild,0).collapse(!0).select(),t.execCommand("inserttable",{numCols:3,numRows:3}),stop(),setTimeout(function(){ua.manualDeleteFillData(t.body);var o=t.body.getElementsByTagName("tr");e.setStart(o[0].firstChild,0).setEnd(o[1].firstChild,0).select(),t.currentSelectedArr=[o[0].firstChild,o[1].firstChild],t.execCommand("mergecells"),ua.manualDeleteFillData(t.body),e.setStart(o[0].firstChild,0).collapse(!0).select(),t.execCommand("rowspacing",20,"top"),ua.manualDeleteFillData(t.body),equal(o[0].firstChild.firstChild.tagName.toLowerCase(),"p","td下面创建了一个p"),equal(o[0].firstChild.firstChild.style.marginTop,"20px","p设置了2倍行距"),o=t.body.firstChild.getElementsByTagName("tr"),equal(o.length,3,"3行");for(var a=t.body.getElementsByTagName("tbody")[0].childNodes,l=0;l<a.length;l++)equal(a[l].tagName.toLowerCase(),"tr","tbody下面都是tr");start()},30)},300)},50)}),test("合并单元格后设置多个单元格多倍段前距",function(){var t=new baidu.editor.Editor({plugins:["table"],autoFloatEnabled:!1});stop(),setTimeout(function(){var e=document.body.appendChild(document.createElement("div"));te.dom.push(e),t.render(e),setTimeout(function(){t.setContent("<p></p>");var e=new baidu.editor.dom.Range(t.document);e.setStart(t.body.firstChild,0).collapse(!0).select(),t.execCommand("inserttable",{numCols:3,numRows:3}),setTimeout(function(){ua.manualDeleteFillData(t.body);var o=t.body.firstChild.getElementsByTagName("tr");e.setStart(o[0].firstChild,0).setEnd(o[1].firstChild,0).select(),t.currentSelectedArr=[o[0].firstChild,o[1].firstChild],t.execCommand("mergecells"),e.setStart(o[0].firstChild,0).setEnd(o[2].firstChild,0).select(),t.currentSelectedArr=[o[0].firstChild,o[1].firstChild,o[2].firstChild],t.execCommand("rowspacing",20,"top"),o=t.body.firstChild.getElementsByTagName("tr"),equal(o.length,3,"3行");for(var a=t.body.getElementsByTagName("tbody")[0].childNodes,l=0;l<a.length;l++)equal(a[l].tagName.toLowerCase(),"tr","tbody下面都是tr");start()},50)},300)},50)});
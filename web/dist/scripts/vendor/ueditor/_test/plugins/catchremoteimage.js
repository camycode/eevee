module("plugins.catchremoteimage"),test("成功远程图片抓取",function(){UEDITOR_CONFIG.UEDITOR_HOME_URL="../../../";for(var t in window.UEDITOR_CONFIG)"string"==typeof window.UEDITOR_CONFIG[t]&&(window.UEDITOR_CONFIG[t]=window.UEDITOR_CONFIG[t].replace("_test/tools/br/",""));var e=new UE.Editor({autoFloatEnabled:!1});stop(),setTimeout(function(){var t=document.body.appendChild(document.createElement("div"));e.render(t),e.ready(function(){var o=e.body;e.setContent('<p><img src="http://img0.bdstatic.com/static/common/widget/search_box_search/logo/logo_3b6de4c.png"><img src="http://news.baidu.com/resource/img/logo_news_137_46.png"></p>'),e.fireEvent("catchRemoteImage");var n=0,a=setInterval(function(){n++;var t=o.getElementsByTagName("img"),e=t[1].getAttribute("src");/upload/.test(e)?(clearInterval(a),ok(/upload/.test(t[0].getAttribute("src")),"图片已经被转存到本地"),equal(t.length,2,"2个图片"),start()):n>100&&(clearInterval(a),ok(!1,"超时，文件获取失败"),start())},100);te.dom.push(t)},50)},100)});
module("plugins.section"),test("getsections命令",function(){var e=te.obj[0],n="<h1>一级标题1</h1><p>段落a</p><h2>二级标题2</h2><p>段落</p><h2>二级标题3</h2><p>段落</p><h3>三级标题4</h3><p>段落</p><h1>一级标题5</h1><p>段落</p>";e.setContent(n);var t=e.execCommand("getsections");equal(t.children.length,2,"内容里有两个一级标题"),equal(t.children[1].title,"一级标题5","验证章节内容"),same(t.children[1].startAddress,[8],"验证章节开始位置"),same(t.children[1].endAddress,[9],"验证章节结束位置")}),test("deletesection命令",function(){var e=te.obj[0],n="<h1>一级标题1</h1><p>段落a</p><h2>二级标题2</h2><p>段落</p><h2>二级标题3</h2><p>段落</p><h3>三级标题4</h3><p>段落</p><h1>一级标题5</h1><p>段落b</p>";e.setContent(n);var t=e.execCommand("getsections");e.execCommand("deleteSection",t.children[1]),equal(t.children[1].parentNode,null,"验证章节标题是否已删除"),notEqual(e.body.children[0].innerHTML,"段落a","不传入keepChild参数时,验证章节内容是否已删除"),e.setContent(n),t=e.execCommand("getsections"),e.execCommand("deleteSection",t.children[0],!0),equal(e.body.children[0].innerHTML,"段落a","传入keepChild参数为true时,验证章节内容是否已保留")}),test("movesection命令",function(){var e=te.obj[0],n="<h1>一级标题1</h1><p>段落a</p><h2>二级标题2</h2><p>段落</p><h2>二级标题3</h2><p>段落</p><h3>三级标题4</h3><p>段落</p><h1>一级标题5</h1><p>段落b</p>";e.setContent(n);var t=e.execCommand("getsections");e.execCommand("movesection",t.children[1],t.children[0]),equal(e.body.children[0].innerHTML,"一级标题5"," 移动章节移动到目标章节之前,验证章节是否移动正确"),equal(e.body.children[1].innerHTML,"段落b"," 验证移动章节移动到目标章节之前,验证章节内容是否移动正确"),e.setContent(n),t=e.execCommand("getsections"),e.execCommand("movesection",t.children[0],t.children[1],!0);var h=e.body.children.length;equal(e.body.children[h-2].innerHTML,"一级标题1"," 移动章节移动到目标章节之前,验证章节是否移动正确"),equal(e.body.children[h-1].innerHTML,"段落a"," 验证移动章节移动到目标章节之前,验证章节内容是否移动正确")}),test("selectsection命令",function(){var e=te.obj[0],n="<h1>一级标题1</h1><p>段落a</p><h2>二级标题2</h2><p>段落</p><h2>二级标题3</h2><p>段落</p><h3>三级标题4</h3><p>段落</p><h1>一级标题5</h1><p>段落b</p>";e.setContent(n);var t=e.execCommand("getsections");e.execCommand("selectsection",t.children[1]);var h=e.selection.getRange();ua.checkSameHtml($("<div>").append(h.cloneContents()).html(),"<h1>一级标题5</h1><p>段落b</p>","判断选区内容是否正确")});
module("plugins.inserthtml"),test("向span里面插入p",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<address><span style="color:#ff0000">hello1</span></address>'),t.setStart(e.body.firstChild.firstChild,0).collapse(!0).select(),e.execCommand("inserthtml","<p >hello3</p>"),stop(),setTimeout(function(){ua.checkSameHtml(e.body.getElementsByTagName("address")[0].innerHTML.toLowerCase(),'<p >hello3</p><span style="color:#ff0000">hello1</span>',"向span里面插入p"),start()},50)}),test("trace 3301：闭合方式插入文本",function(){var e=te.obj[0],t=te.obj[1],l=e.body;e.setContent("<p><br></p>"),t.setStart(l.firstChild,0).collapse(1).select(),e.execCommand("inserthtml","hello2"),equal(ua.getChildHTML(l),"<p>hello2</p>","插入文本节点")}),test("选中多个单元格插入列表",function(){var e=te.obj[0],t=te.obj[1],l=e.body;e.setContent("<table><tbody><tr><td></td><td></td></tr></tbody></table>"),setTimeout(function(){var a=e.body.firstChild.getElementsByTagName("tr"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[0].cells[0],a[0].cells[1]);s.setSelected(o),ua.browser.ie&&t.setStart(a[0].cells[0],0).collapse(!0).select();var i=l.firstChild.getElementsByTagName("td");e.execCommand("inserthtml","<ol><li>hello</li></ol>"),equal(i[0].firstChild.tagName.toLowerCase(),"ol","插入列表"),equal(ua.getChildHTML(i[0].firstChild),"<li><p>hello</p></li>","查询列表内容");var r=ua.browser.ie?"":"<br>";ua.manualDeleteFillData(i[1]),equal(i[1].innerHTML,r,"第二个单元格没有插入任何东西"),start()},50),stop()}),test("表格中插入图片",function(){var e=te.obj[0],t=te.obj[1],l=e.body;e.setContent("<table><tbody><tr><td></td><td></td></tr></tbody></table>"),setTimeout(function(){var a=e.body.firstChild.getElementsByTagName("tr"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[0].cells[0],a[0].cells[1]);s.setSelected(o),ua.browser.ie&&t.setStart(a[0].cells[0],0).collapse(!0).select();var i=l.firstChild.getElementsByTagName("td");e.execCommand("inserthtml",'<img style="float:left"/>'),equal(i[0].firstChild.tagName.toLowerCase(),"img","插入图片"),equal(i[0].firstChild.style.styleFloat||i[0].firstChild.style.cssFloat,"left","查询图片浮动方式");var r=ua.browser.ie?"":"<br>";ua.manualDeleteFillData(i[1]),equal(i[1].innerHTML,r,"第二个单元格没有插入任何东西"),start()},50),stop()}),test("选中多个单元格插入超链接",function(){if(!(ua.browser.ie>8)){var e=te.obj[0],t=te.obj[1],l=e.body;e.setContent("<table><tbody><tr><td></td><td></td></tr></tbody></table>"),setTimeout(function(){var a=e.body.firstChild.getElementsByTagName("tr"),s=e.getUETable(e.body.firstChild),o=s.getCellsRange(a[0].cells[0],a[0].cells[1]);s.setSelected(o),ua.browser.ie&&ua.browser.ie<9&&t.setStart(a[0].cells[0],0).collapse(!0).select(),e.execCommand("link",{href:"http://www.baidu.com/"});var i=l.firstChild.getElementsByTagName("td");equal(i[0].firstChild.tagName.toLowerCase(),"a","插入超链接");var r=ua.browser.ie?"":"<br>";equal(ua.getChildHTML(i[0]),'<a href="http://www.baidu.com/">http://www.baidu.com/</a>'+(ua.browser.ie>8?" ":r),"查询第一个表格插入的超链接"),equal(ua.getChildHTML(i[1]),r,"第二个单元格也插入超链接"),start()},50),stop()}}),test("trace 3297：notSerialize",function(){var e=te.obj[0],t=te.obj[1],l=e.body;e.setContent("<p><br></p>"),setTimeout(function(){t.setStart(l.firstChild,0).collapse(1).select(),e.execCommand("inserthtml","<p>b</p>_ueditor_page_break_tag_",!1),equal(e.body.childNodes.length,3,"notSerialize=false 插入分页符"),equal(e.body.childNodes[1].tagName.toLowerCase(),"hr",'插入分页符 hr class="pagebreak"  '),equal(e.body.childNodes[1].className.toLowerCase(),"pagebreak",'插入分页符 hr class="pagebreak"  '),e.setContent("<p><br></p>"),setTimeout(function(){t.setStart(l.firstChild,0).collapse(1).select(),e.execCommand("inserthtml","<p>b</p>_ueditor_page_break_tag_",!0),equal(e.body.childNodes.length,3,"notSerialize=true 插入分页符"),equal(e.body.childNodes[1].innerHTML,"_ueditor_page_break_tag_","插入分页符"),start()},50)},50),stop()}),test("列表中插入表格",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<ol><li><p></p></li></ol>");var l=e.body.getElementsByTagName("li");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("inserttable",{numCols:2,numRows:2}),stop(),setTimeout(function(){equal(l.length,1,"列表长度没有变化"),equal(l[0].firstChild.tagName.toLowerCase(),"table","列表中插入表格"),start()},50)}),test("列表中插入img",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<ol><li><p></p></li></ol>");var l=e.body.getElementsByTagName("li");t.setStart(l[0],0).collapse(!0).select(),e.execCommand("insertimage",{src:"http://img.baidu.com/hi/jx2/j_0001.gif",width:50,height:51}),stop(),setTimeout(function(){equal(l.length,1,"列表长度没有变化"),ua.manualDeleteFillData(l[0]),ua.browser.ie?(equal(l[0].firstChild.firstChild.tagName.toLowerCase(),"img","列表中插入img"),equal(l[0].firstChild.firstChild.attributes.src.nodeValue,"http://img.baidu.com/hi/jx2/j_0001.gif","列表中插入img")):(equal(l[0].firstChild.tagName.toLowerCase(),"img","列表中插入img"),equal(l[0].firstChild.attributes.src.nodeValue,"http://img.baidu.com/hi/jx2/j_0001.gif","列表中插入img")),start()},50)});
module("plugins.contextmenu"),test("基本右键菜单",function(){var e=te.obj[0];stop(),ua.contextmenu(e.body);var t=e.getLang("contextMenu");equal(document.getElementsByClassName("edui-menu-body").length,3,"默认3个menu,一个主的，一个段落格式，一个表格");var n=document.getElementsByClassName("edui-menu-body")[0];equal(n.parentNode.parentNode.parentNode.style.display,"","第一个menu显示"),equal(n.childNodes.length,11,"第一个menu8个items3个分隔线");var a=t.selectall+t.cleardoc+t.paragraph+t.table+t.insertparagraphbefore+t.insertparagraphafter+t.copy+t.paste;browser.gecko?equal(n.textContent,a,"检查menu显示的字符"):equal(n.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),a,"检查menu显示的字符"),ok(n.childNodes[0].className.indexOf("edui-for-selectall")>-1,"检查menu样式");var o=document.getElementsByClassName("edui-menu-body")[1];equal(o.parentNode.parentNode.parentNode.style.display,"none","第二个menu隐藏");var d=document.getElementsByClassName("edui-menu-body")[2];ua.browser.ie?ua.mouseenter(n.childNodes[3]):ua.mouseover(n.childNodes[3]),setTimeout(function(){t=e.getLang("contextMenu"),equal(o.parentNode.parentNode.parentNode.style.display,"none",'显示submenu,检查submenu的display值:""'),equal(o.childNodes.length,4,"检查submenu的menuitems数量"),equal(d.parentNode.parentNode.parentNode.style.display,"none",'显示table submenu,检查submenu的display值:""'),ua.browser.ie&&ua.browser.ie<9?equal(d.childNodes.length,2,"ie有一条分隔线"):equal(d.childNodes.length,1,"只有插入表格选项"),a=t.justifyleft+t.justifyright+t.justifycenter+t.justifyjustify,browser.gecko?(equal(o.textContent,a,"检查menu显示的字符"),equal(d.textContent,t.inserttable,"检查table menu显示的字符")):(equal(o.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),a,"检查menu显示的字符"),equal(d.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),t.inserttable,"检查table menu显示的字符")),ua.click(o.childNodes[1]),setTimeout(function(){equal(e.body.firstChild.style.textAlign,"right","文本右对齐"),document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},500)},200)}),test("表格右键菜单",function(){var e=te.obj[0],t=te.obj[1];stop();var n=e.getLang("contextMenu");e.setContent('<table width="100%" border="1" bordercolor="#000000"><tbody><tr><td style="width:50%;"><br /></td><td style="width:50%;"><br /></td></tr><tr><td style="width:50%;"></td><td style="width:50%;"><br /></td></tr></tbody></table>'),setTimeout(function(){t.setStart(e.body.firstChild.firstChild.firstChild.firstChild.firstChild,0).collapse(!0).select(),ua.contextmenu(e.body.firstChild.firstChild.firstChild),equal(document.getElementsByClassName("edui-menu-body").length,5,"获得edui-menu-body名称的class个数5");var a=document.getElementsByClassName("edui-menu-body")[0];equal(a.childNodes.length,13,"第一个menu11个items2个分隔线");var o=n.selectall+n.cleardoc+n.table+n.tablesort+n.borderbk+n.aligntd+n.aligntable+n.insertparagraphbefore+n.insertparagraphafter+n.copy+n.paste;browser.gecko?equal(a.textContent,o,"检查menu显示的字符"):equal(a.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),o,"检查menu显示的字符");var d=document.getElementsByClassName("edui-menu-body")[1],l=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(l[l.length-1]):ua.mouseover(l[l.length-1]),setTimeout(function(){n=e.getLang("contextMenu"),equal(d.parentNode.parentNode.parentNode.style.display,"none",'显示submenu,检查submenu的display值:""'),equal(d.childNodes.length,19,"14个items5个分隔线");var t=n.deletetable+n.deleterow+n.deletecol+n.insertcol+n.insertcolnext+n.insertrow+n.insertrownext+n.insertcaption+n.inserttitle+n.inserttitlecol+n.mergeright+n.mergedown+n.edittd+n.edittable+n.setbordervisible;browser.gecko?equal(d.textContent,t,"检查menu显示的字符"):equal(d.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),t,"检查menu显示的字符"),ua.click(d.childNodes[0]),equal(e.body.getElementsByTagName("table").length,0,"删除表格"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},200)},200)},100)}),test("trace 3044：表格名称中右键",function(){var e=te.obj[0],t=te.obj[1];stop();var n=e.getLang("contextMenu");e.execCommand("cleardoc"),e.execCommand("inserttable"),t.setStart(e.body.getElementsByTagName("td")[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild);var a=document.getElementsByClassName("edui-menu-body")[1],o=document.getElementsByClassName("edui-for-table");ua.browser.ie?ua.mouseenter(o[o.length-1]):ua.mouseover(o[o.length-1]),setTimeout(function(){n=e.getLang("contextMenu"),ua.click(a.childNodes[9]);var d=e.body.getElementsByTagName("caption");equal(d.length,1,"插入表格名称"),t.setStart(d[0],0).collapse(!0).select(),ua.contextmenu(e.body.firstChild.firstChild),o=document.getElementsByClassName("edui-for-table"),ua.browser.ie?ua.mouseenter(o[o.length-1]):ua.mouseover(o[o.length-1]),setTimeout(function(){n=e.getLang("contextMenu"),a=document.getElementsByClassName("edui-menu-body")[1],8==ua.browser.ie?equal(a.childNodes.length,9,"9个子项目,其中有2条分隔线"):equal(a.childNodes.length,7,"7个子项目");var t=n.deletetable+n.deletecaption+n.inserttitle+n.inserttitlecol+n.edittd+n.edittable+n.setbordervisible;browser.gecko?equal(a.textContent,t,"检查menu显示的字符"):equal(a.innerText.replace(/[\r\n\t\u200b\ufeff]/g,""),t,"检查menu显示的字符"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),te.dom.push(e.container),start()},200)},200)},200)}),test("trace 3088：检查表格属性",function(){var e=document.body.appendChild(document.createElement("div"));e.id="ue";var t=UE.getEditor("ue");stop(),t.ready(function(){var e=new baidu.editor.dom.Range(t.document),n=t.getLang("contextMenu");t.execCommand("cleardoc"),t.execCommand("inserttable"),e.setStart(t.body.getElementsByTagName("td")[0],0).collapse(!0).select(),t.execCommand("inserttitle"),e.setStart(t.body.getElementsByTagName("td")[0],0).collapse(!0).select(),t.execCommand("insertcaption"),e.setStart(t.body.getElementsByTagName("caption")[0],0).collapse(!0).select(),t.execCommand("deletetitle"),setTimeout(function(){e.setStart(t.body.getElementsByTagName("caption")[0],0).collapse(!0).select(),ua.contextmenu(t.body.firstChild.firstChild),setTimeout(function(){var a=document.getElementsByClassName("edui-menu-body")[1],o=document.getElementsByClassName("edui-for-table");ua.browser.ie&&ua.browser.ie<9?(ua.mouseenter(o[o.length-1]),ua.click(a.childNodes[a.childNodes.length-2])):(ua.mouseover(o[o.length-1]),ua.click(a.childNodes[a.childNodes.length-2])),n=t.getLang("contextMenu"),setTimeout(function(){for(var d,l=document.getElementsByTagName("iframe"),u=0;u<l.length;u++)if(l[u].id&&-1!=l[u].id.indexOf("edui")){d=l[u];break}equal(d.contentDocument.getElementById("J_title").checked,!1,"无标题行"),equal(d.contentDocument.getElementById("J_caption").checked,!0,"有名称"),e.setStart(t.body.getElementsByTagName("td")[0],0).collapse(!0).select(),ua.contextmenu(t.body.firstChild),a=document.getElementsByClassName("edui-menu-body")[1],o=document.getElementsByClassName("edui-for-table"),ua.browser.ie&&ua.browser.ie<9?ua.mouseenter(o[o.length-1]):ua.mouseover(o[o.length-1]),n=t.getLang("contextMenu"),ua.click(a.childNodes[14]),setTimeout(function(){l=document.getElementsByTagName("iframe"),d=null;for(var e=0;e<l.length;e++)if(l[e].id&&-1!=l[e].id.indexOf("edui")){d=l[e];break}equal(d.contentDocument.getElementById("J_title").checked,!1,"无标题行"),equal(d.contentDocument.getElementById("J_caption").checked,!0,"有名称"),setTimeout(function(){var e=document.getElementById("edui447_body");ua.click(e),document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),UE.delEditor("ue"),te.dom.push(document.getElementById("ue")),start()},500)},500)},600)},800)},800)})}),test("检查表格属性",function(){if(!(ua.browser.ie&&ua.browser.ie<9)){var e=document.body.appendChild(document.createElement("div"));e.id="ue";var t=UE.getEditor("ue");stop(),t.ready(function(){var e=new baidu.editor.dom.Range(t.document),n=t.getLang("contextMenu");t.execCommand("cleardoc"),t.execCommand("inserttable"),e.setStart(t.body.getElementsByTagName("td")[0],0).collapse(!0).select(),t.execCommand("insertcaption"),setTimeout(function(){e.setStart(t.body.getElementsByTagName("caption")[0],0).collapse(!0).select(),ua.contextmenu(t.body.firstChild.firstChild);var a=document.getElementsByClassName("edui-menu-body")[1],o=document.getElementsByClassName("edui-for-table");ua.browser.ie&&ua.browser.ie<9?(ua.mouseenter(o[o.length-1]),ua.click(a.childNodes[6])):(ua.mouseover(o[o.length-1]),ua.click(a.childNodes[5])),n=t.getLang("contextMenu");var d=document.getElementsByTagName("iframe");setTimeout(function(){for(var e,t=0;t<d.length;t++)if(-1!=d[t].id.indexOf("edui")){e=d[t];break}equal(e.contentDocument.getElementById("J_tone").value.toLowerCase(),"#dddddd","默认边框颜色"),equal(e.contentDocument.getElementById("J_title").checked,!1,"无标题行"),equal(e.contentDocument.getElementById("J_caption").checked,!0,"有名称"),equal(e.contentDocument.getElementById("J_autoSizePage").checked,!0,"页面自适应"),setTimeout(function(){document.getElementById("edui_fixedlayer").parentNode.removeChild(document.getElementById("edui_fixedlayer")),UE.delEditor("ue"),te.dom.push(document.getElementById("ue")),start()},200)},300)},500)})}});
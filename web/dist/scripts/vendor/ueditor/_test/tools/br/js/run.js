function run(e,s){window.document.title=e;var t=window.brtest=window.brtest||{};t.timeout=t.timeout||1e5,t.breakOnError=/breakonerror=true/gi.test(location.search)||$("input#id_control_breakonerror").attr("checked"),t.runnext=/batchrun=true/gi.test(location.search)||s||$("input#id_control_runnext").attr("checked"),t.kiss=e;var i="id_case_"+e.split(".").join("_");if(/showsrconly=true/gi.test(location.search)){var r=document.getElementById("id_showSrcOnly");r.style.display="block"}t.kissnode=$(document.getElementById(i)),t.kisses=t.kisses||{},t.kisslost||($("div#id_showSrcOnly a").each(function(){t.kisses[this.title]="0;0;_;0;0"}),t.kisslost=!0),t.kisscov=t.kisscov||{};var n=(t.kisses[t.kiss]=t.kisses[t.kiss]||"",setTimeout(function(){window.brtest.breakOnError||$(t).trigger("done",[(new Date).getTime(),{failed:1,passed:1},frames[0].$_jscoverage,"timeout"])},t.timeout));$(t).one("done",function(s,t,i,r){clearTimeout(n);var a=window.brtest,o=i.failed,l=i.failed+i.passed;a.kissend=(new Date).getTime(),null!==r&&(a.kisscov[a.kiss]=r),a.kissnode.removeClass("running_case"),a.kisses[a.kiss]=o+";"+l+";_;"+a.kissstart+";"+a.kissend;var c=e+": 失败/所有:"+o+"/"+l+",耗时:"+(a.kissend-a.kissstart),d=upath+"../br/log.php?loginfo="+c;if(d+="&detail="+i.detail,o>0&&(d+="&fail=true"),o>0?a.kissnode.addClass("fail_case"):a.kissnode.addClass("pass_case"),a.runnext&&(!a.breakOnError||0==parseInt(a.kisses[a.kiss].split(",")[0]))){var u=a.kissnode.next()[0];if("A"==u.tagName)void 0===a.kisses[u.title]&&run(u.title,a.runnext),d+="&next="+u.title;else{d+="&next=@_@end",a.kisses.config=location.search.substring(1);var k="report.php";covcalc(),$.ajax({url:k,type:"post",data:a.kisses,success:function(e){$("#id_reportarea").show().html(e)},error:function(e,s){alert("fail"+s)}})}}te.log(d)});var a="run.php?case="+e+"&time="+(new Date).getTime()+"&"+location.search.substring(1),o=("id_div_frame_"+e.split(".").join("_"),"id_frame_"+e.split(".").join("_"));t.kissnode.addClass("running_case"),$("input#id_control_hidelist").attr("checked")&&$("div#id_testlist").css("display","none"),$("div#id_reportarea").empty().hide();var l=document.createElement("iframe");l.src=a,l.id=o,l.className="runningframe",$("div#id_runningarea").empty().css("display","block").append(l),t.kissstart=(new Date).getTime()}function match(e,s){if("*"==s)return!0;var t=s.length,i=s.split(",");if(i.length>1){for(var r in i)if(!match(e,i[r]))return!1;return!0}if("!"==s.substr(0,1)){var n=s.substr(1);return e.substr(0,n.length)==n?!1:!0}return t>e.length?!1:e.substr(0,t)==s}function covcalc(){function e(e,s){for(var t in s)for(var i in s[t])"source"!=i&&(e[t]=e[t]||[],e[t][i]=(e[t][i]||0)+s[t][i]);return e}var s={},t=window.brtest.kisses;for(var i in window.brtest.kisscov)e(s,window.brtest.kisscov[i]);for(var r,n=[],a="",o=location.search.split("&"),l=0;l<o.length;l++)-1!=o[l].indexOf("filter")&&-1==o[l].indexOf("filterRun")&&(a=o[l].split("=")[1]);for(r in s)s.hasOwnProperty(r)&&match(r,a)&&n.push(r);n.sort();for(var c=0;c<n.length;c++){r=n[c];var d,u=0,k=0,f=[],v=s[r],h=v.length,p=0,_=null;v.conditionals&&(_=v.conditionals);var m=null;for(d=0;h>d;d++){var g=v[d];d===p?p=0:0===p&&_&&_[d]&&(p=_[d]),0===p&&void 0!==g&&null!==g?(0===g?(null==m?m="0":m+=",0",f.push(d)):(null==m?m="1":m+=",1",k++),u++):null==m?m="2":m+=",2"}var w=0===u?0:(100*k/u).toFixed(1),b=r.replace(".js","");void 0==t[b]&&(t[b]="0;0;_;0;0");var $=t[b].split(";_;");t[b]=$[0]+";"+w+";"+$[1]+";"+m}}$(document).ready(function(){(location.href.search("[?&,]batchrun=true")>0||$("input#id_control_runnext").attr("checked"))&&run($("div#id_testlist a").attr("title"),!0)});
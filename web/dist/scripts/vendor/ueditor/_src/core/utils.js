var utils=UE.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var r=0,o=e.length;o>r;r++)if(t.call(n,e[r],r,e)===!1)return!1}else for(var i in e)if(e.hasOwnProperty(i)&&t.call(n,e[i],i,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var r in t)n&&e.hasOwnProperty(r)||(e[r]=t[r]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var r=t[n];for(var o in r)e.hasOwnProperty(o)||(e[o]=r[o])}return e},inherits:function(e,t){var n=e.prototype,r=utils.makeInstance(t.prototype);return utils.extend(r,n,!0),e.prototype=r,r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r),r=setTimeout(e,t)}},indexOf:function(e,t,n){var r=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,o){return o>=n&&e===t?(r=o,!1):void 0}),r},removeItem:function(e,t){for(var n=0,r=e.length;r>n;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t,n=0,r={};t=e[n++];)r[t.toUpperCase()]=r[t]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,n){try{for(var r,o=0;r=t[o++];)if(r.doc===e&&r.url==(n.src||n.href))return r}catch(i){return null}}var t=[];return function(n,r,o){var i=e(n,r);if(i)return void(i.ready?o&&o():i.funs.push(o));if(t.push({doc:n,url:r.src||r.href,funs:[o]}),!n.body){var a=[];for(var u in r)"tag"!=u&&a.push(u+'="'+r[u]+'"');return void n.write("<"+r.tag+" "+a.join(" ")+" ></"+r.tag+">")}if(!r.id||!n.getElementById(r.id)){var s=n.createElement(r.tag);delete r.tag;for(var u in r)s.setAttribute(u,r[u]);s.onload=s.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(i=e(n,r),i.funs.length>0){i.ready=1;for(var t;t=i.funs.pop();)t()}s.onload=s.onreadystatechange=null}},s.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(s)}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r,o=0;r=n[o++];)r=parseInt(r.replace(/[^\d]/gi,""),10).toString(16),t+=1==r.length?"0"+r:r;t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){if(!e)return"";var n=e.top,r=e.bottom,o=e.left,i=e.right,a="";if(n&&o&&r&&i)a+=";"+t+":"+(n==r&&r==o&&o==i?n:n==r&&o==i?n+" "+o:o==i?n+" "+o+" "+r:n+" "+i+" "+r+" "+o)+";";else for(var u in e)a+=";"+t+"-"+u+":"+e[u]+";";return a}var n,r;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,o,i){if(1==i.split(" ").length)switch(t){case"padding":return!n&&(n={}),n[o]=i,"";case"margin":return!r&&(r={}),r[o]=i,"";case"border":return"initial"==i?"":e}return e}),e+=t(n,"padding")+t(r,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var r in e)e.hasOwnProperty(r)&&(n=e[r],"object"==typeof n?(t[r]=utils.isArray(n)?[]:{},utils.clone(e[r],t[r])):t[r]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,r,o){e=r,t=o}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(){function e(e){e.isReady=!0;for(var n;n=t.pop();n());}var t=[];return function(n,r){r=r||window;var o=r.document;n&&t.push(n),"complete"===o.readyState?e(o):(o.isReady&&e(o),browser.ie&&11!=browser.version?(!function(){if(!o.isReady){try{o.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e(o)}}(),r.attachEvent("onload",function(){e(o)})):(o.addEventListener("DOMContentLoaded",function(){o.removeEventListener("DOMContentLoaded",arguments.callee,!1),e(o)},!1),r.addEventListener("load",function(){e(o)},!1)))}}(),cssRule:browser.ie&&11!=browser.version?function(e,t,n){var r,o;if(void 0===t||t&&t.nodeType&&9==t.nodeType){if(n=t&&t.nodeType&&9==t.nodeType?t:n||document,r=n.indexList||(n.indexList={}),o=r[e],void 0!==o)return n.styleSheets[o].cssText}else{if(n=n||document,r=n.indexList||(n.indexList={}),o=r[e],""===t)return void 0!==o?(n.styleSheets[o].cssText="",delete r[e],!0):!1;void 0!==o?sheetStyle=n.styleSheets[o]:(sheetStyle=n.createStyleSheet("",o=n.styleSheets.length),r[e]=o),sheetStyle.cssText=t}}:function(e,t,n){var r;return void 0===t||t&&t.nodeType&&9==t.nodeType?(n=t&&t.nodeType&&9==t.nodeType?t:n||document,r=n.getElementById(e),r?r.innerHTML:void 0):(n=n||document,r=n.getElementById(e),""===t?r?(r.parentNode.removeChild(r),!0):!1:void(r?r.innerHTML=t:(r=n.createElement("style"),r.id=e,r.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(r))))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n=0,r=e.length;r>n;n++)for(var o=n,i=e.length;i>o;o++)if(t(e[n],e[o])>0){var a=e[n];e[n]=e[o],e[o]=a}return e},serializeParam:function(e){var t=[];for(var n in e)if("method"!=n&&"timeout"!=n&&"async"!=n)if("function"!=(typeof e[n]).toLowerCase()&&"object"!=(typeof e[n]).toLowerCase())t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));else if(utils.isArray(e[n]))for(var r=0;r<e[n].length;r++)t.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e[n][r]));return t.join("&")},formatUrl:function(e){var t=e.replace(/&&/g,"&");return t=t.replace(/\?&/g,"?"),t=t.replace(/&$/g,""),t=t.replace(/&#/g,"#"),t=t.replace(/&+/g,"&")},isCrossDomainUrl:function(e){var t=document.createElement("a");return t.href=e,browser.ie&&(t.href=t.href),!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||"80"==t.port&&""==location.port||""==t.port&&"80"==location.port))},clearEmptyAttrs:function(e){for(var t in e)""===e[t]&&delete e[t];return e},str2json:function(e){return utils.isString(e)?window.JSON?JSON.parse(e):new Function("return "+utils.trim(e||""))():null},json2str:function(){function e(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/["\\\x00-\x1f]/g,function(e){var t=o[e];return t?t:(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+e+'"'}function t(e){var t,n,r,o=["["],i=e.length;for(n=0;i>n;n++)switch(r=e[n],typeof r){case"undefined":case"function":case"unknown":break;default:t&&o.push(","),o.push(utils.json2str(r)),t=1}return o.push("]"),o.join("")}function n(e){return 10>e?"0"+e:e}function r(e){return'"'+e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+'"'}if(window.JSON)return JSON.stringify;var o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(n){switch(typeof n){case"undefined":return"undefined";case"number":return isFinite(n)?String(n):"null";case"string":return e(n);case"boolean":return String(n);default:if(null===n)return"null";if(utils.isArray(n))return t(n);if(utils.isDate(n))return r(n);var o,i,a=["{"],u=utils.json2str;for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s))switch(i=n[s],typeof i){case"undefined":case"unknown":case"function":break;default:o&&a.push(","),o=1,a.push(u(s)+":"+u(i))}return a.push("}"),a.join("")}}}()};utils.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});
!function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function t(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function n(t,n,o,s){return 1==n.nodeType&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(o=domUtils.getNodeIndex(n)+(t?0:1),n=n.parentNode),t?(s.startContainer=n,s.startOffset=o,s.endContainer||s.collapse(!0)):(s.endContainer=n,s.endOffset=o,s.startContainer||s.collapse(!1)),e(s),s}function o(e,t){var n,o,s=e.startContainer,r=e.endContainer,i=e.startOffset,d=e.endOffset,a=e.document,l=a.createDocumentFragment();if(1==s.nodeType&&(s=s.childNodes[i]||(n=s.appendChild(a.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[d]||(o=r.appendChild(a.createTextNode("")))),s===r&&3==s.nodeType)return l.appendChild(a.createTextNode(s.substringData(i,d-i))),t&&(s.deleteData(i,d-i),e.collapse(!0)),l;for(var f,h,c=l,u=domUtils.findParents(s,!0),m=domUtils.findParents(r,!0),p=0;u[p]==m[p];)p++;for(var C,N=p;C=u[N];N++){for(f=C.nextSibling,C==s?n||(3==e.startContainer.nodeType?(c.appendChild(a.createTextNode(s.nodeValue.slice(i))),t&&s.deleteData(i,s.nodeValue.length-i)):c.appendChild(t?s:s.cloneNode(!0))):(h=C.cloneNode(!1),c.appendChild(h));f&&f!==r&&f!==m[N];)C=f.nextSibling,c.appendChild(t?f:f.cloneNode(!0)),f=C;c=h}c=l,u[p]||(c.appendChild(u[p-1].cloneNode(!1)),c=c.firstChild);for(var g,N=p;g=m[N];N++){if(f=g.previousSibling,g==r?o||3!=e.endContainer.nodeType||(c.appendChild(a.createTextNode(r.substringData(0,d))),t&&r.deleteData(0,d)):(h=g.cloneNode(!1),c.appendChild(h)),N!=p||!u[p])for(;f&&f!==s;)g=f.previousSibling,c.insertBefore(t?f:f.cloneNode(!0),c.firstChild),f=g;c=h}return t&&e.setStartBefore(m[p]?u[p]?m[p]:u[p-1]:m[p-1]).collapse(!0),n&&domUtils.remove(n),o&&domUtils.remove(o),l}function s(e,t){try{if(i&&domUtils.inDoc(i,e))if(i.nodeValue.replace(fillCharReg,"").length)i.nodeValue=i.nodeValue.replace(fillCharReg,"");else{var n=i.parentNode;for(domUtils.remove(i);n&&domUtils.isEmptyInlineElement(n)&&(browser.safari?!(domUtils.getPosition(n,t)&domUtils.POSITION_CONTAINS):!n.contains(t));)i=n.parentNode,domUtils.remove(n),n=i}}catch(o){}}function r(e,t){var n;for(e=e[t];e&&domUtils.isFillChar(e);)n=e[t],domUtils.remove(e),e=n}var i,d=0,a=domUtils.fillChar,l=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=e,t.collapsed=!0};l.prototype={cloneContents:function(){return this.collapsed?null:o(this,0)},deleteContents:function(){var e;return this.collapsed||o(this,1),browser.webkit&&(e=this.startContainer,3!=e.nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),domUtils.remove(e))),this},extractContents:function(){return this.collapsed?null:o(this,2)},setStart:function(e,t){return n(!0,e,t,this)},setEnd:function(e,t){return n(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new l(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}for(var n,o=this,s=o.collapsed;1==o.startContainer.nodeType&&(n=o.startContainer.childNodes[o.startOffset])&&t(n);)o.setStart(n,0);if(s)return o.collapse(!0);if(!e)for(;1==o.endContainer.nodeType&&o.endOffset>0&&(n=o.endContainer.childNodes[o.endOffset-1])&&t(n);)o.setEnd(n,n.childNodes.length);return o},getCommonAncestor:function(e,n){var o=this,s=o.startContainer,r=o.endContainer;return s===r?e&&t(this)&&(s=s.childNodes[o.startOffset],1==s.nodeType)?s:n&&3==s.nodeType?s.parentNode:s:domUtils.getCommonAncestor(s,r)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,o=this.collapsed,s=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var r=domUtils.split(t,n);t===s?this.setEnd(r,this.endOffset-n):t.parentNode===s&&(this.endOffset+=1),this.setStartBefore(r)}if(o)return this.collapse(!0)}return e||(n=this.endOffset,s=this.endContainer,3==s.nodeType&&(0==n?this.setEndBefore(s):(n<s.nodeValue.length&&domUtils.split(s,n),this.setEndAfter(s)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],o=e[t+"Offset"];3==n.nodeType&&(o?o>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return(e||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var o=this.startContainer,s=this.startOffset,r=o.childNodes[s];return r?o.insertBefore(e,r):o.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,o=this.document.createElement("span");return o.style.cssText="display:none;line-height:0px;",o.appendChild(this.document.createTextNode("‍")),o.id="_baidu_bookmark_start_"+(t?"":d++),this.collapsed||(n=o.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":d++)),this.insertNode(o),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(o),{start:e?o.id:o,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),domUtils.remove(t),n?(this.setEndBefore(n),domUtils.remove(n)):this.collapse(!0),this},enlarge:function(e,t){var n,o,s=domUtils.isBody,r=this.document.createTextNode("");if(e){for(o=this.startContainer,1==o.nodeType?o.childNodes[this.startOffset]?n=o=o.childNodes[this.startOffset]:(o.appendChild(r),n=o=r):n=o;;){if(domUtils.isBlockElm(o)){for(o=n;(n=o.previousSibling)&&!domUtils.isBlockElm(n);)o=n;this.setStartBefore(o);break}n=o,o=o.parentNode}for(o=this.endContainer,1==o.nodeType?((n=o.childNodes[this.endOffset])?o.insertBefore(r,n):o.appendChild(r),n=o=r):n=o;;){if(domUtils.isBlockElm(o)){for(o=n;(n=o.nextSibling)&&!domUtils.isBlockElm(n);)o=n;this.setEndAfter(o);break}n=o,o=o.parentNode}r.parentNode===this.endContainer&&this.endOffset--,domUtils.remove(r)}if(!this.collapsed){for(;!(0!=this.startOffset||t&&t(this.startContainer)||s(this.startContainer));)this.setStartBefore(this.startContainer);for(;!(this.endOffset!=(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)||t&&t(this.endContainer)||s(this.endContainer));)this.setEndAfter(this.endContainer)}return this},enlargeToBlockElm:function(e){for(;!domUtils.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;!domUtils.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&domUtils.isBlockElm(e)}).adjustmentBoundary();for(var o,s,r=this.createBookmark(),i=r.end,d=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!domUtils.isWhitespace(e)},a=domUtils.getNextDomNode(r.start,!1,d),l=this.cloneRange();a&&domUtils.getPosition(a,i)&domUtils.POSITION_PRECEDING;)if(3==a.nodeType||dtd[e][a.tagName]){for(l.setStartBefore(a),o=a;o&&(3==o.nodeType||dtd[e][o.tagName])&&o!==i;)s=o,o=domUtils.getNextDomNode(o,1==o.nodeType,null,function(t){return dtd[e][t.tagName]});var f,h=l.setEndAfter(s).extractContents();if(n&&n.length>0){var c,u;u=c=n[0].cloneNode(!1);for(var m,p=1;m=n[p++];)c.appendChild(m.cloneNode(!1)),c=c.firstChild;f=c}else f=l.document.createElement(e);t&&domUtils.setAttributes(f,t),f.appendChild(h),l.insertNode(n?u:f);var C;if("span"==e&&t.style&&/text\-decoration/.test(t.style)&&(C=domUtils.findParentByTagName(f,"a",!0))?(domUtils.setAttributes(C,t),domUtils.remove(f,!0),f=C):(domUtils.mergeSibling(f),domUtils.clearEmptySibling(f)),domUtils.mergeChild(f,t),a=domUtils.getNextDomNode(f,!1,d),domUtils.mergeToParent(f),o===i)break}else a=domUtils.getNextDomNode(a,!0,d);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=utils.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();for(var t=this.startContainer,n=this.endContainer;;){if(1==t.nodeType){if(utils.indexOf(e,t.tagName.toLowerCase())>-1)break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==n.nodeType){if(utils.indexOf(e,n.tagName.toLowerCase())>-1)break;if("body"==n.tagName.toLowerCase()){n=null;break}}n=n.parentNode}var o,s,r=this.createBookmark();t&&(s=this.cloneRange().setEndBefore(r.start).setStartBefore(t),o=s.extractContents(),s.insertNode(o),domUtils.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(s=this.cloneRange().setStartAfter(r.end).setEndAfter(n),o=s.extractContents(),s.insertNode(o),domUtils.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling));for(var i,d=domUtils.getNextDomNode(r.start,!1,function(e){return 1==e.nodeType});d&&d!==r.end;)i=domUtils.getNextDomNode(d,!0,function(e){return 1==e.nodeType}),utils.indexOf(e,d.tagName.toLowerCase())>-1&&domUtils.remove(d,!0),d=i;return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(t(n)){var o=n.startContainer.childNodes[n.startOffset];o&&1==o.nodeType&&(dtd.$empty[o.tagName]||dtd.$nonChild[o.tagName])&&(e=o)}}return e},select:browser.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var o=this.getClosedNode();if(o&&!t){try{n=this.document.body.createControlRange(),n.addElement(o),n.select()}catch(d){}return this}var l,f=this.createBookmark(),h=f.start;if(n=this.document.body.createTextRange(),n.moveToElementText(h),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var c=this.document.createTextNode(a),u=this.document.createElement("span");u.appendChild(this.document.createTextNode(a)),h.parentNode.insertBefore(u,h),h.parentNode.insertBefore(c,h),s(this.document,c),i=c,r(u,"previousSibling"),r(h,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else{var m=this.document.body.createTextRange();l=f.end,m.moveToElementText(l),n.setEndPoint("EndToEnd",m)}this.moveToBookmark(f),u&&domUtils.remove(u);try{n.select()}catch(d){}return this}:function(e){function t(e){function t(t,n,o){3==t.nodeType&&t.nodeValue.length<n&&(e[o+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var n,o=domUtils.getWindow(this.document),d=o.getSelection();if(browser.gecko?this.document.body.focus():o.focus(),d){if(d.removeAllRanges(),this.collapsed&&!e){var l=this.startContainer,f=l;1==l.nodeType&&(f=l.childNodes[this.startOffset]),3==l.nodeType&&this.startOffset||(f?f.previousSibling&&3==f.previousSibling.nodeType:l.lastChild&&3==l.lastChild.nodeType)||(n=this.document.createTextNode(a),this.insertNode(n),s(this.document,n),r(n,"previousSibling"),r(n,"nextSibling"),i=n,this.setStart(n,browser.webkit?1:0).collapse(!0))}var h=this.document.createRange();if(this.collapsed&&browser.opera&&1==this.startContainer.nodeType){var f=this.startContainer.childNodes[this.startOffset];if(f){for(;f&&domUtils.isBlockElm(f)&&1==f.nodeType&&f.childNodes[0];)f=f.childNodes[0];f&&this.setStartBefore(f).collapse(!0)}else f=this.startContainer.lastChild,f&&domUtils.isBr(f)&&this.setStartBefore(f).collapse(!0)}t(this),h.setStart(this.startContainer,this.startOffset),h.setEnd(this.endContainer,this.endOffset),d.addRange(h)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var n=this,o=n.document.createElement("span");return o.innerHTML="&nbsp;",n.cloneRange().insertNode(o),domUtils.scrollToView(o,e,t),domUtils.remove(o),n},inFillChar:function(){var e=this.startContainer;return this.collapsed&&3==e.nodeType&&e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==e.nodeValue.length?!0:!1},createAddress:function(e,t){function n(e){for(var n,o=e?s.startContainer:s.endContainer,r=domUtils.findParents(o,!0,function(e){return!domUtils.isBody(e)}),i=[],d=0;n=r[d++];)i.push(domUtils.getNodeIndex(n,t));var a=0;if(t)if(3==o.nodeType){for(var l=o.previousSibling;l&&3==l.nodeType;)a+=l.nodeValue.replace(fillCharReg,"").length,l=l.previousSibling;a+=e?s.startOffset:s.endOffset}else if(o=o.childNodes[e?s.startOffset:s.endOffset])a=domUtils.getNodeIndex(o,t);else{o=e?s.startContainer:s.endContainer;for(var f=o.firstChild;f;)if(domUtils.isFillChar(f))f=f.nextSibling;else if(a++,3==f.nodeType)for(;f&&3==f.nodeType;)f=f.nextSibling;else f=f.nextSibling}else a=e?domUtils.isFillChar(o)?0:s.startOffset:s.endOffset;return 0>a&&(a=0),i.push(a),i}var o={},s=this;return o.startAddress=n(!0),e||(o.endAddress=s.collapsed?[].concat(o.startAddress):n()),o},moveToAddress:function(e,t){function n(e,t){for(var n,s,r,i=o.document.body,d=0,a=e.length;a>d;d++)if(r=e[d],n=i,i=i.childNodes[r],!i){s=r;break}t?i?o.setStartBefore(i):o.setStart(n,s):i?o.setEndBefore(i):o.setEnd(n,s)}var o=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),o},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),o=n.end,s=domUtils.getNextDomNode(n.start,!1,t);s&&s!==o&&domUtils.getPosition(s,o)&domUtils.POSITION_PRECEDING;){var r=domUtils.getNextDomNode(s,!1,t);e(s),s=r}return this.moveToBookmark(n)}}}();
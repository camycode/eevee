!function(){var e=baidu.editor.utils,t=baidu.editor.ui,a=t.Dialog;t.buttons={},t.Dialog=function(e){var t=new a(e);return t.addListener("hide",function(){if(t.editor){var e=t.editor;try{if(browser.gecko){var a=e.window.scrollY,n=e.window.scrollX;e.body.focus(),e.window.scrollTo(n,a)}else e.focus()}catch(o){}}}),t};for(var n,o={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},i=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],l=0;n=i[l++];)n=n.toLowerCase(),t[n]=function(e){return function(a){var n=new t.Button({className:"edui-for-"+e,title:a.options.labelMap[e]||a.getLang("labelMap."+e)||"",onclick:function(){a.execCommand(e)},theme:a.options.theme,showText:!1});return t.buttons[e]=n,a.addListener("selectionchange",function(t,o,i){var l=a.queryCommandState(e);-1==l?(n.setDisabled(!0),n.setChecked(!1)):i||(n.setDisabled(!1),n.setChecked(l))}),n}}(n);t.cleardoc=function(e){var a=new t.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});return t.buttons.cleardoc=a,e.addListener("selectionchange",function(){a.setDisabled(-1==e.queryCommandState("cleardoc"))}),a};var s={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var r in s)!function(e,a){for(var n,o=0;n=a[o++];)!function(a){t[e.replace("float","")+a]=function(n){var o=new t.Button({className:"edui-for-"+e.replace("float","")+a,title:n.options.labelMap[e.replace("float","")+a]||n.getLang("labelMap."+e.replace("float","")+a)||"",theme:n.options.theme,onclick:function(){n.execCommand(e,a)}});return t.buttons[e]=o,n.addListener("selectionchange",function(t,i,l){o.setDisabled(-1==n.queryCommandState(e)),o.setChecked(n.queryCommandValue(e)==a&&!l)}),o}}(n)}(r,s[r]);for(var n,l=0;n=["backcolor","forecolor"][l++];)t[n]=function(e){return function(a){var n=new t.ColorButton({className:"edui-for-"+e,color:"default",title:a.options.labelMap[e]||a.getLang("labelMap."+e)||"",editor:a,onpickcolor:function(t,n){a.execCommand(e,n)},onpicknocolor:function(){a.execCommand(e,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){a.execCommand(e,this.color)}});return t.buttons[e]=n,a.addListener("selectionchange",function(){n.setDisabled(-1==a.queryCommandState(e))}),n}}(n);var c={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(var r in c)!function(a,n){for(var i,l=0;i=n[l++];)browser.opera&&"searchreplace"===i||!function(n){t[n]=function(i,l,s){l=l||(i.options.iframeUrlMap||{})[n]||o[n],s=i.options.labelMap[n]||i.getLang("labelMap."+n)||"";var r;l&&(r=new t.Dialog(e.extend({iframeUrl:i.ui.mapUrl(l),editor:i,className:"edui-for-"+n,title:s,holdScroll:"insertimage"===n,fullscreen:/charts|preview/.test(n),closeDialog:i.getLang("closeDialog")},"ok"==a?{buttons:[{className:"edui-okbutton",label:i.getLang("ok"),editor:i,onclick:function(){r.close(!0)}},{className:"edui-cancelbutton",label:i.getLang("cancel"),editor:i,onclick:function(){r.close(!1)}}]}:{})),i.ui._dialogs[n+"Dialog"]=r);var c=new t.Button({className:"edui-for-"+n,title:s,onclick:function(){if(r)switch(n){case"wordimage":var e=i.execCommand("wordimage");e&&e.length&&(r.render(),r.open());break;case"scrawl":-1!=i.queryCommandState("scrawl")&&(r.render(),r.open());break;default:r.render(),r.open()}},theme:i.options.theme,disabled:"scrawl"==n&&-1==i.queryCommandState("scrawl")||"charts"==n});return t.buttons[n]=c,i.addListener("selectionchange",function(){var e={edittable:1};if(!(n in e)){var t=i.queryCommandState(n);c.getDom()&&(c.setDisabled(-1==t),c.setChecked(t))}}),c}}(i.toLowerCase())}(r,c[r]);t.snapscreen=function(e,a,n){n=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var i=new t.Button({className:"edui-for-snapscreen",title:n,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});if(t.buttons.snapscreen=i,a=a||(e.options.iframeUrlMap||{}).snapscreen||o.snapscreen){var l=new t.Dialog({iframeUrl:e.ui.mapUrl(a),editor:e,className:"edui-for-snapscreen",title:n,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){l.close(!1)}}]});l.render(),e.ui._dialogs.snapscreenDialog=l}return e.addListener("selectionchange",function(){i.setDisabled(-1==e.queryCommandState("snapscreen"))}),i},t.insertcode=function(a,n,o){n=a.options.insertcode||[],o=a.options.labelMap.insertcode||a.getLang("labelMap.insertcode")||"";var i=[];e.each(n,function(e,t){i.push({label:e,value:t,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var l=new t.Combox({editor:a,items:i,onselect:function(e,t){a.execCommand("insertcode",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,a=0;t=this.items[a];a++)if(-1!=t.value.indexOf(e))return a;return-1}});return t.buttons.insertcode=l,a.addListener("selectionchange",function(e,t,n){if(!n){var i=a.queryCommandState("insertcode");if(-1==i)l.setDisabled(!0);else{l.setDisabled(!1);var s=a.queryCommandValue("insertcode");if(!s)return void l.setValue(o);s&&(s=s.replace(/['"]/g,"").split(",")[0]),l.setValue(s)}}}),l},t.fontfamily=function(a,n,o){if(n=a.options.fontfamily||[],o=a.options.labelMap.fontfamily||a.getLang("labelMap.fontfamily")||"",n.length){for(var i,l=0,s=[];i=n[l];l++){var r=a.getLang("fontfamily")[i.name]||"";!function(t,n){s.push({label:t,value:n,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+e.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}(i.label||r,i.val)}var c=new t.Combox({editor:a,items:s,onselect:function(e,t){a.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t,a=0;t=this.items[a];a++)if(-1!=t.value.indexOf(e))return a;return-1}});return t.buttons.fontfamily=c,a.addListener("selectionchange",function(e,t,n){if(!n){var o=a.queryCommandState("FontFamily");if(-1==o)c.setDisabled(!0);else{c.setDisabled(!1);var i=a.queryCommandValue("FontFamily");i&&(i=i.replace(/['"]/g,"").split(",")[0]),c.setValue(i)}}}),c}},t.fontsize=function(e,a,n){if(n=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"",a=a||e.options.fontsize||[],a.length){for(var o=[],i=0;i<a.length;i++){var l=a[i]+"px";o.push({label:l,value:l,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var s=new t.Combox({editor:e,items:o,title:n,initValue:n,onselect:function(t,a){e.execCommand("FontSize",this.items[a].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return t.buttons.fontsize=s,e.addListener("selectionchange",function(t,a,n){if(!n){var o=e.queryCommandState("FontSize");-1==o?s.setDisabled(!0):(s.setDisabled(!1),s.setValue(e.queryCommandValue("FontSize")))}}),s}},t.paragraph=function(a,n,o){if(o=a.options.labelMap.paragraph||a.getLang("labelMap.paragraph")||"",n=a.options.paragraph||[],!e.isEmptyObject(n)){var i=[];for(var l in n)i.push({value:l,label:n[l]||a.getLang("paragraph")[l],theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var s=new t.Combox({editor:a,items:i,title:o,initValue:o,className:"edui-for-paragraph",onselect:function(e,t){a.execCommand("Paragraph",this.items[t].value)},onbuttonclick:function(){this.showPopup()}});return t.buttons.paragraph=s,a.addListener("selectionchange",function(e,t,n){if(!n){var o=a.queryCommandState("Paragraph");if(-1==o)s.setDisabled(!0);else{s.setDisabled(!1);var i=a.queryCommandValue("Paragraph"),l=s.indexByValue(i);-1!=l?s.setValue(i):s.setValue(s.initValue)}}}),s}},t.customstyle=function(e){var a=e.options.customstyle||[],n=e.options.labelMap.customstyle||e.getLang("labelMap.customstyle")||"";if(a.length){for(var o,i=e.getLang("customstyle"),l=0,s=[];o=a[l++];)!function(t){var a={};a.label=t.label?t.label:i[t.name],a.style=t.style,a.className=t.className,a.tag=t.tag,s.push({label:a.label,value:a,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+a.tag+" "+(a.className?' class="'+a.className+'"':"")+(a.style?' style="'+a.style+'"':"")+">"+a.label+"</"+a.tag+"></div>"}})}(o);var r=new t.Combox({editor:e,items:s,title:n,initValue:n,className:"edui-for-customstyle",onselect:function(t,a){e.execCommand("customstyle",this.items[a].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t,a=0;t=this.items[a++];)if(t.label==e)return a-1;return-1}});return t.buttons.customstyle=r,e.addListener("selectionchange",function(t,a,n){if(!n){var o=e.queryCommandState("customstyle");if(-1==o)r.setDisabled(!0);else{r.setDisabled(!1);var i=e.queryCommandValue("customstyle"),l=r.indexByValue(i);-1!=l?r.setValue(i):r.setValue(r.initValue)}}}),r}},t.inserttable=function(e,a,n){n=e.options.labelMap.inserttable||e.getLang("labelMap.inserttable")||"";var o=new t.TableButton({editor:e,title:n,className:"edui-for-inserttable",onpicktable:function(t,a,n){e.execCommand("InsertTable",{numRows:n,numCols:a,border:1})},onbuttonclick:function(){this.showPopup()}});return t.buttons.inserttable=o,e.addListener("selectionchange",function(){o.setDisabled(-1==e.queryCommandState("inserttable"))}),o},t.lineheight=function(e){var a=e.options.lineheight||[];if(a.length){for(var n,o=0,i=[];n=a[o++];)i.push({label:n,value:n,theme:e.options.theme,onclick:function(){e.execCommand("lineheight",this.value)}});var l=new t.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap.lineheight||e.getLang("labelMap.lineheight")||"",items:i,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});return t.buttons.lineheight=l,e.addListener("selectionchange",function(){var t=e.queryCommandState("LineHeight");if(-1==t)l.setDisabled(!0);else{l.setDisabled(!1);var a=e.queryCommandValue("LineHeight");a&&l.setValue((a+"").replace(/cm/,"")),l.setChecked(t)}}),l}};for(var u,d=["top","bottom"],m=0;u=d[m++];)!function(e){t["rowspacing"+e]=function(a){var n=a.options["rowspacing"+e]||[];if(!n.length)return null;for(var o,i=0,l=[];o=n[i++];)l.push({label:o,value:o,theme:a.options.theme,onclick:function(){a.execCommand("rowspacing",this.value,e)}});var s=new t.MenuButton({editor:a,className:"edui-for-rowspacing"+e,title:a.options.labelMap["rowspacing"+e]||a.getLang("labelMap.rowspacing"+e)||"",items:l,onbuttonclick:function(){var t=a.queryCommandValue("rowspacing",e)||this.value;a.execCommand("rowspacing",t,e)}});return t.buttons[e]=s,a.addListener("selectionchange",function(){var t=a.queryCommandState("rowspacing",e);if(-1==t)s.setDisabled(!0);else{s.setDisabled(!1);var n=a.queryCommandValue("rowspacing",e);n&&s.setValue((n+"").replace(/%/,"")),s.setChecked(t)}}),s}}(u);for(var p,f=["insertorderedlist","insertunorderedlist"],h=0;p=f[h++];)!function(e){t[e]=function(a){var n=a.options[e],o=function(){a.execCommand(e,this.value)},i=[];for(var l in n)i.push({label:n[l]||a.getLang()[e][l]||"",value:l,theme:a.options.theme,onclick:o});var s=new t.MenuButton({editor:a,className:"edui-for-"+e,title:a.getLang("labelMap."+e)||"",items:i,onbuttonclick:function(){var t=a.queryCommandValue(e)||this.value;a.execCommand(e,t)}});return t.buttons[e]=s,a.addListener("selectionchange",function(){var t=a.queryCommandState(e);if(-1==t)s.setDisabled(!0);else{s.setDisabled(!1);var n=a.queryCommandValue(e);s.setValue(n),s.setChecked(t)}}),s}}(p);t.fullscreen=function(e,a){a=e.options.labelMap.fullscreen||e.getLang("labelMap.fullscreen")||"";var n=new t.Button({className:"edui-for-fullscreen",title:a,theme:e.options.theme,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen()),this.setChecked(e.ui.isFullScreen())}});return t.buttons.fullscreen=n,e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");n.setDisabled(-1==t),n.setChecked(e.ui.isFullScreen())}),n},t.emotion=function(e,a){var n="emotion",i=new t.MultiMenuPop({title:e.options.labelMap[n]||e.getLang("labelMap."+n)||"",editor:e,className:"edui-for-"+n,iframeUrl:e.ui.mapUrl(a||(e.options.iframeUrlMap||{})[n]||o[n])});return t.buttons[n]=i,e.addListener("selectionchange",function(){i.setDisabled(-1==e.queryCommandState(n))}),i},t.autotypeset=function(e){var a=new t.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});return t.buttons.autotypeset=a,e.addListener("selectionchange",function(){a.setDisabled(-1==e.queryCommandState("autotypeset"))}),a},t.simpleupload=function(e){var a="simpleupload",n=new t.Button({className:"edui-for-"+a,title:e.options.labelMap[a]||e.getLang("labelMap."+a)||"",onclick:function(){},theme:e.options.theme,showText:!1});return t.buttons[a]=n,e.addListener("ready",function(){var t=n.getDom("body"),a=t.children[0];e.fireEvent("simpleuploadbtnready",a)}),e.addListener("selectionchange",function(t,o,i){var l=e.queryCommandState(a);-1==l?(n.setDisabled(!0),n.setChecked(!1)):i||(n.setDisabled(!1),n.setChecked(l))}),n}}();
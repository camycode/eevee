!function(){var t,e,i,s=baidu.editor.utils,o=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,d=baidu.editor.ui.Mask,h=baidu.editor.ui.UIBase,l=baidu.editor.ui.Button,a=baidu.editor.ui.Dialog=function(t){if(t.name){var e=t.name,i=t.cssRules;t.className||(t.className="edui-for-"+e),i&&(t.cssRules=".edui-default .edui-for-"+e+" .edui-dialog-content  {"+i+"}")}this.initOptions(s.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(t,e){return e?this.onok():this.oncancel()},holdScroll:!1},t)),this.initDialog()};a.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var o=this,n=this.editor.options.theme;if(this.cssRules&&s.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=t||(t=new d({className:"edui-dialog-modalmask",theme:n,onclick:function(){i&&i.close(!1)}})),this.dragMask=e||(e=new d({className:"edui-dialog-dragmask",theme:n})),this.closeButton=new l({className:"edui-dialog-closebutton",title:o.closeDialog,theme:n,onclick:function(){o.close(!1)}}),this.fullscreen&&this.initResizeEvent(),this.buttons)for(var h=0;h<this.buttons.length;h++)this.buttons[h]instanceof l||(this.buttons[h]=new l(s.extend(this.buttons[h],{editor:this.editor},!0)))},initResizeEvent:function(){var t=this;o.on(window,"resize",function(){t._hidden||void 0===t._hidden||(t.__resizeTimer&&window.clearTimeout(t.__resizeTimer),t.__resizeTimer=window.setTimeout(function(){t.__resizeTimer=null;var e=t.getDom(),i=t.getDom("content"),s=UE.ui.uiUtils.getClientRect(e),o=UE.ui.uiUtils.getClientRect(i),d=n.getViewportRect();i.style.width=d.width-s.width+o.width+"px",i.style.height=d.height-s.height+o.height+"px",e.style.width=d.width+"px",e.style.height=d.height+"px",t.fireEvent("resize")},100))})},fitSize:function(){var t=this.getDom("body"),e=this.mesureSize();return t.style.width=e.width+"px",t.style.height=e.height+"px",e},safeSetOffset:function(t){var e=this,i=e.getDom(),s=n.getViewportRect(),o=n.getClientRect(i),d=t.left;d+o.width>s.right&&(d=s.right-o.width);var h=t.top;h+o.height>s.bottom&&(h=s.bottom-o.height),i.style.left=Math.max(d,0)+"px",i.style.top=Math.max(h,0)+"px"},showAtCenter:function(){var t=n.getViewportRect();if(this.fullscreen){var e=this.getDom(),i=this.getDom("content");e.style.display="block";var s=UE.ui.uiUtils.getClientRect(e),d=UE.ui.uiUtils.getClientRect(i);e.style.left="-100000px",i.style.width=t.width-s.width+d.width+"px",i.style.height=t.height-s.height+d.height+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden"}else{this.getDom().style.display="";var h=this.fitSize(),l=0|this.getDom("titlebar").offsetHeight,a=t.width/2-h.width/2,r=t.height/2-(h.height-l)/2-l,c=this.getDom();this.safeSetOffset({left:Math.max(0|a,0),top:Math.max(0|r,0)}),o.hasClass(c,"edui-state-centered")||(c.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var t="";return"string"==typeof this.content?t=this.content:this.iframeUrl&&(t='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),t},getHtmlTpl:function(){var t="";if(this.buttons){for(var e=[],i=0;i<this.buttons.length;i++)e[i]=this.buttons[i].renderHtml();t='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+e.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+t+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var t=this;if(this.addListener("show",function(){t.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){t.modalMask.hide()}),this.buttons)for(var e=0;e<this.buttons.length;e++)this.buttons[e].postRender();o.on(window,"resize",function(){setTimeout(function(){t.isHidden()||t.safeSetOffset(n.getClientRect(t.getDom()))})}),this._hide()},mesureSize:function(){var t=this.getDom("body"),e=n.getClientRect(this.getDom("content")).width,i=t.style;return i.width=e,n.getClientRect(t)},_onTitlebarMouseDown:function(t,e){if(this.draggable){var i,s=(n.getViewportRect(),this);n.startDrag(t,{ondragstart:function(){i=n.getClientRect(s.getDom()),s.getDom("contmask").style.visibility="visible",s.dragMask.show(s.getDom().style.zIndex-1)},ondragmove:function(t,e){var o=i.left+t,n=i.top+e;s.safeSetOffset({left:o,top:n})},ondragstop:function(){s.getDom("contmask").style.visibility="hidden",o.removeClasses(s.getDom(),["edui-state-centered"]),s.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var t=this.getDom();t.style.display="none",t.style.zIndex="",t.style.width="",t.style.height="",this._hidden=!0,this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(t){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(e){}i=this},_onCloseButtonClick:function(t,e){this.close(!1)},close:function(t){if(this.fireEvent("close",t)!==!1){this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide();var e=this.getDom("content"),i=this.getDom("iframe");if(e&&i){var s=i.contentDocument||i.contentWindow.document;s&&(s.body.innerHTML=""),o.remove(e)}}}},s.inherits(a,h)}();
!function(){function t(t){var e=t.target||t.srcElement,i=r.findParent(e,function(t){return r.hasClass(t,"edui-shortcutmenu")||r.hasClass(t,"edui-popup")},!0);if(!i)for(var s,n=0;s=a[n++];)s.hide()}var e,i=baidu.editor.ui,s=i.UIBase,n=i.uiUtils,o=baidu.editor.utils,r=baidu.editor.dom.domUtils,a=[],u=!1,d=i.ShortCutMenu=function(t){this.initOptions(t),this.initShortCutMenu()};d.postHide=t,d.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),a.push(this)},initEvent:function(){var t=this,i=t.editor.document;r.on(i,"mousemove",function(i){if(t.isHidden===!1){if(t.getSubMenuMark()||"contextmenu"==t.eventType)return;var s=!0,n=t.getDom(),o=n.offsetWidth,r=n.offsetHeight,a=o/2+t.SPACE,u=r/2,d=Math.abs(i.screenX-t.left),f=Math.abs(i.screenY-t.top);clearTimeout(e),e=setTimeout(function(){f>0&&u>f?t.setOpacity(n,"1"):f>u&&u+70>f?(t.setOpacity(n,"0.5"),s=!1):f>u+70&&u+140>f&&t.hide(),s&&d>0&&a>d?t.setOpacity(n,"1"):d>a&&a+70>d?t.setOpacity(n,"0.5"):d>a+70&&a+140>d&&t.hide()})}}),browser.chrome&&r.on(i,"mouseout",function(e){var i=e.relatedTarget||e.toElement;(null==i||"HTML"==i.tagName)&&t.hide()}),t.editor.addListener("afterhidepop",function(){t.isHidden||(u=!0)})},initItems:function(){if(o.isArray(this.items))for(var t=0,e=this.items.length;e>t;t++){var s=this.items[t].toLowerCase();i[s]&&(this.items[t]=new i[s](this.editor),this.items[t].className+=" edui-shortcutsubmenu ")}},setOpacity:function(t,e){browser.ie&&browser.version<9?t.style.filter="alpha(opacity = "+100*parseFloat(e)+");":t.style.opacity=e},getSubMenuMark:function(){u=!1;for(var t,e=n.getFixedLayer(),i=r.getElementsByTagName(e,"div",function(t){return r.hasClass(t,"edui-shortcutsubmenu edui-popup")}),s=0;t=i[s++];)"none"!=t.style.display&&(u=!0);return u},show:function(t,e){function i(t){t.left<0&&(t.left=0),t.top<0&&(t.top=0),u.style.cssText="position:absolute;left:"+t.left+"px;top:"+t.top+"px;"}function s(t){t.tagName||(t=t.getDom()),a.left=parseInt(t.style.left),a.top=parseInt(t.style.top),a.top-=u.offsetHeight+15,i(a)}var o=this,a={},u=this.getDom(),d=n.getFixedLayer();if(o.eventType=t.type,u.style.cssText="display:block;left:-9999px","contextmenu"==t.type&&e){var f=r.getElementsByTagName(d,"div","edui-contextmenu")[0];f?s(f):o.editor.addListener("aftershowcontextmenu",function(t,e){s(e)})}else a=n.getViewportOffsetByEvent(t),a.top-=u.offsetHeight+o.SPACE,a.left+=o.SPACE+20,i(a),o.setOpacity(u,.2);o.isHidden=!1,o.left=t.screenX+u.offsetWidth/2-o.SPACE,o.top=t.screenY-u.offsetHeight/2-o.SPACE,o.editor&&(u.style.zIndex=1*o.editor.container.style.zIndex+10,d.style.zIndex=u.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(o.isArray(this.items))for(var t,e=0;t=this.items[e++];)t.postRender()},getHtmlTpl:function(){var t;if(o.isArray(this.items)){t=[];for(var e=0;e<this.items.length;e++)t[e]=this.items[e].renderHtml();t=t.join("")}else t=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+t+"</div>"}},o.inherits(d,s),r.on(document,"mousedown",function(e){t(e)}),r.on(window,"scroll",function(e){t(e)})}();
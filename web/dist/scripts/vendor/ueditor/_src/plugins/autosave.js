UE.plugin.register("autosave",function(){function e(e){var r;if(!(new Date-t<o)){if(!e.hasContents())return void(a&&n.removePreferences(a));t=new Date,e._saveFlag=null,r=n.body.innerHTML,e.fireEvent("beforeautosave",{content:r})!==!1&&(n.setPreferences(a,r),e.fireEvent("afterautosave",{content:r}))}}var n=this,t=new Date,o=20,a=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var e="-drafts-data",t=null;t=n.key?n.key+e:(n.container.parentNode.id||"ue-common")+e,a=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+t},contentchange:function(){a&&(n._saveFlag&&window.clearTimeout(n._saveFlag),n.options.saveInterval>0?n._saveFlag=window.setTimeout(function(){e(n)},n.options.saveInterval):e(n))}},commands:{clearlocaldata:{execCommand:function(e,t){a&&n.getPreferences(a)&&n.removePreferences(a)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(e,t){return a?n.getPreferences(a)||"":""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(e,t){a&&(n.body.innerHTML=n.getPreferences(a)||"<p>"+domUtils.fillHtml+"</p>",n.focus(!0))},queryCommandState:function(){return a?null===n.getPreferences(a)?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}});
UE.plugin.register("autolink",function(){var e=0;return browser.ie?{}:{bindEvents:{reset:function(){e=0},keydown:function(e,t){var r=this,n=t.keyCode||t.which;if(32==n||13==n){for(var i,o,a=r.selection.getNative(),s=a.getRangeAt(0).cloneRange(),l=s.startContainer;1==l.nodeType&&s.startOffset>0&&(l=s.startContainer.childNodes[s.startOffset-1]);)s.setStart(l,1==l.nodeType?l.childNodes.length:l.nodeValue.length),s.collapse(!0),l=s.startContainer;do{if(0==s.startOffset){for(l=s.startContainer.previousSibling;l&&1==l.nodeType;)l=l.lastChild;if(!l||domUtils.isFillChar(l))break;i=l.nodeValue.length}else l=s.startContainer,i=s.startOffset;s.setStart(l,i-1),o=s.toString().charCodeAt(0)}while(160!=o&&32!=o);if(s.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;s.toString().length&&!/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(s.toString());)try{s.setStart(s.startContainer,s.startOffset+1)}catch(d){for(var l=s.startContainer;!(next=l.nextSibling);){if(domUtils.isBody(l))return;l=l.parentNode}s.setStart(next,0)}if(domUtils.findParentByTagName(s.startContainer,"a",!0))return;var f,g=r.document.createElement("a"),u=r.document.createTextNode(" ");r.undoManger&&r.undoManger.save(),g.appendChild(s.extractContents()),g.href=g.innerHTML=g.innerHTML.replace(/<[^>]+>/g,""),f=g.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),""),f=/^(?:https?:\/\/)/gi.test(f)?f:"http://"+f,g.setAttribute("_src",utils.html(f)),g.href=utils.html(f),s.insertNode(g),g.parentNode.insertBefore(u,g.nextSibling),s.setStart(u,0),s.collapse(!0),a.removeAllRanges(),a.addRange(s),r.undoManger&&r.undoManger.save()}}}}}},function(){function e(e){if(3==e.nodeType)return null;if("A"==e.nodeName)return e;for(var t=e.lastChild;t;){if("A"==t.nodeName)return t;if(3==t.nodeType){if(domUtils.isWhitespace(t)){t=t.previousSibling;continue}return null}t=t.lastChild}}var t={37:1,38:1,39:1,40:1,13:1,32:1};browser.ie&&this.addListener("keyup",function(r,n){var i=this,o=n.keyCode;if(t[o]){var a=i.selection.getRange(),s=a.startContainer;if(13==o){for(;s&&!domUtils.isBody(s)&&!domUtils.isBlockElm(s);)s=s.parentNode;if(s&&!domUtils.isBody(s)&&"P"==s.nodeName){var l=s.previousSibling;if(l&&1==l.nodeType){var l=e(l);l&&!l.getAttribute("_href")&&domUtils.remove(l,!0)}}}else if(32==o)3==s.nodeType&&/^\s$/.test(s.nodeValue)&&(s=s.previousSibling,s&&"A"==s.nodeName&&!s.getAttribute("_href")&&domUtils.remove(s,!0));else if(s=domUtils.findParentByTagName(s,"a",!0),s&&!s.getAttribute("_href")){var d=a.createBookmark();domUtils.remove(s,!0),a.moveToBookmark(d).select(!0)}}})});
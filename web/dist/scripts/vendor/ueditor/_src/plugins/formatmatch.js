UE.plugins.formatmatch=function(){function e(r,s){function i(e){return c&&e.selectNode(c),e.applyInlineStyle(o[o.length-1].tagName,null,o)}if(browser.webkit)var l="IMG"==s.target.tagName?s.target:null;n.undoManger&&n.undoManger.save();var m=n.selection.getRange(),d=l||m.getClosedNode();if(t&&d&&"IMG"==d.tagName)d.style.cssText+=";float:"+(t.style.cssFloat||t.style.styleFloat||"none")+";display:"+(t.style.display||"inline"),t=null;else if(!t){var u=m.collapsed;if(u){var c=n.document.createTextNode("match");m.insertNode(c).select()}n.__hasEnterExecCommand=!0;var g=n.options.removeFormatAttributes;n.options.removeFormatAttributes="",n.execCommand("removeformat"),n.options.removeFormatAttributes=g,n.__hasEnterExecCommand=!1,m=n.selection.getRange(),o.length&&i(m),c&&m.setStartBefore(c).collapse(!0),m.select(),c&&domUtils.remove(c)}n.undoManger&&n.undoManger.save(),n.removeListener("mouseup",e),a=0}var t,n=this,o=[],a=0;n.addListener("reset",function(){o=[],a=0}),n.commands.formatmatch={execCommand:function(r){if(a)return a=0,o=[],void n.removeListener("mouseup",e);var s=n.selection.getRange();if(t=s.getClosedNode(),!t||"IMG"!=t.tagName){s.collapse(!0).shrinkBoundary();var i=s.startContainer;o=domUtils.findParents(i,!0,function(e){return!domUtils.isBlockElm(e)&&1==e.nodeType});for(var l,m=0;l=o[m];m++)if("A"==l.tagName){o.splice(m,1);break}}n.addListener("mouseup",e),a=1},queryCommandState:function(){return a},notNeedUndo:1}};
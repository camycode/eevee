!function(){function e(e,n){var a=domUtils.getElementsByTagName(e,"td th");utils.each(a,function(e){e.removeAttribute("width")}),e.setAttribute("width",t(n,!0,l(n,e)));var o=[];setTimeout(function(){utils.each(a,function(e){1==e.colSpan&&o.push(e.offsetWidth)}),utils.each(a,function(e,t){1==e.colSpan&&e.setAttribute("width",o[t]+"")})},0)}function t(e,t,n){var a=e.body;return a.offsetWidth-(t?2*parseInt(domUtils.getComputedStyle(a,"margin-left"),10):0)-2*n.tableBorder-(e.options.offsetWidth||0)}function n(e){var t=o(e).cell;if(t){var n=i(t);return n.selectedTds.length?n.selectedTds:[t]}return[]}var a=UE.UETable,o=function(e){return a.getTableItemsByRange(e)},r=function(e){return a.getUETableBySelected(e)},l=function(e,t){return a.getDefaultValue(e,t)},i=function(e){return a.getUETable(e)};UE.commands.inserttable={queryCommandState:function(){return o(this).table?-1:0},execCommand:function(e,t){function n(e,t){for(var n=[],a=e.numRows,o=e.numCols,r=0;a>r;r++){n.push("<tr"+(0==r?' class="firstRow"':"")+">");for(var l=0;o>l;l++)n.push('<td width="'+t+'"  vAlign="'+e.tdvalign+'" >'+(browser.ie&&browser.version<11?domUtils.fillChar:"<br/>")+"</td>");n.push("</tr>")}return"<table><tbody>"+n.join("")+"</tbody></table>"}t||(t=utils.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));var a=this,o=this.selection.getRange(),r=o.startContainer,i=domUtils.findParent(r,function(e){return domUtils.isBlockElm(e)},!0)||a.body,s=l(a),m=i.offsetWidth,c=Math.floor(m/t.numCols-2*s.tdPadding-s.tdBorder);!t.tdvalign&&(t.tdvalign=a.options.tdvalign),a.execCommand("inserthtml",n(t,c))}},UE.commands.insertparagraphbeforetable={queryCommandState:function(){return o(this).cell?0:-1},execCommand:function(){var e=o(this).table;if(e){var t=this.document.createElement("p");t.innerHTML=browser.ie?"&nbsp;":"<br />",e.parentNode.insertBefore(t,e),this.selection.getRange().setStart(t,0).setCursor()}}},UE.commands.deletetable={queryCommandState:function(){var e=this.selection.getRange();return domUtils.findParentByTagName(e.startContainer,"table",!0)?0:-1},execCommand:function(e,t){var n=this.selection.getRange();if(t=t||domUtils.findParentByTagName(n.startContainer,"table",!0)){var a=t.nextSibling;a||(a=domUtils.createElement(this.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"}),t.parentNode.insertBefore(a,t)),domUtils.remove(t),n=this.selection.getRange(),3==a.nodeType?n.setStartBefore(a):n.setStart(a,0),n.setCursor(!1,!0),this.fireEvent("tablehasdeleted")}}},UE.commands.cellalign={queryCommandState:function(){return n(this).length?0:-1},execCommand:function(e,t){var a=n(this);if(a.length)for(var o,r=0;o=a[r++];)o.setAttribute("align",t)}},UE.commands.cellvalign={queryCommandState:function(){return n(this).length?0:-1},execCommand:function(e,t){var a=n(this);if(a.length)for(var o,r=0;o=a[r++];)o.setAttribute("vAlign",t)}},UE.commands.insertcaption={queryCommandState:function(){var e=o(this).table;return e&&0==e.getElementsByTagName("caption").length?1:-1},execCommand:function(){var e=o(this).table;if(e){var t=this.document.createElement("caption");t.innerHTML=browser.ie?domUtils.fillChar:"<br/>",e.insertBefore(t,e.firstChild);var n=this.selection.getRange();n.setStart(t,0).setCursor()}}},UE.commands.deletecaption={queryCommandState:function(){var e=this.selection.getRange(),t=domUtils.findParentByTagName(e.startContainer,"table");return t?0==t.getElementsByTagName("caption").length?-1:1:-1},execCommand:function(){var e=this.selection.getRange(),t=domUtils.findParentByTagName(e.startContainer,"table");if(t){domUtils.remove(t.getElementsByTagName("caption")[0]);var n=this.selection.getRange();n.setStart(t.rows[0].cells[0],0).setCursor()}}},UE.commands.inserttitle={queryCommandState:function(){var e=o(this).table;if(e){var t=e.rows[0];return"th"!=t.cells[t.cells.length-1].tagName.toLowerCase()?0:-1}return-1},execCommand:function(){var e=o(this).table;e&&i(e).insertRow(0,"th");var t=e.getElementsByTagName("th")[0];this.selection.getRange().setStart(t,0).setCursor(!1,!0)}},UE.commands.deletetitle={queryCommandState:function(){var e=o(this).table;if(e){var t=e.rows[0];return"th"==t.cells[t.cells.length-1].tagName.toLowerCase()?0:-1}return-1},execCommand:function(){var e=o(this).table;e&&domUtils.remove(e.rows[0]);var t=e.getElementsByTagName("td")[0];this.selection.getRange().setStart(t,0).setCursor(!1,!0)}},UE.commands.inserttitlecol={queryCommandState:function(){var e=o(this).table;if(e){var t=e.rows[e.rows.length-1];return t.getElementsByTagName("th").length?-1:0}return-1},execCommand:function(t){var n=o(this).table;n&&i(n).insertCol(0,"th"),e(n,this);var a=n.getElementsByTagName("th")[0];this.selection.getRange().setStart(a,0).setCursor(!1,!0)}},UE.commands.deletetitlecol={queryCommandState:function(){var e=o(this).table;if(e){var t=e.rows[e.rows.length-1];return t.getElementsByTagName("th").length?0:-1}return-1},execCommand:function(){var t=o(this).table;if(t)for(var n=0;n<t.rows.length;n++)domUtils.remove(t.rows[n].children[0]);e(t,this);var a=t.getElementsByTagName("td")[0];this.selection.getRange().setStart(a,0).setCursor(!1,!0)}},UE.commands.mergeright={queryCommandState:function(e){var t=o(this),n=t.table,a=t.cell;if(!n||!a)return-1;var r=i(n);if(r.selectedTds.length)return-1;var l=r.getCellInfo(a),s=l.colIndex+l.colSpan;if(s>=r.colsNum)return-1;var m=r.indexTable[l.rowIndex][s],c=n.rows[m.rowIndex].cells[m.cellIndex];return c&&a.tagName==c.tagName&&m.rowIndex==l.rowIndex&&m.rowSpan==l.rowSpan?0:-1},execCommand:function(e){var t=this.selection.getRange(),n=t.createBookmark(!0),a=o(this).cell,r=i(a);r.mergeRight(a),t.moveToBookmark(n).select()}},UE.commands.mergedown={queryCommandState:function(e){var t=o(this),n=t.table,a=t.cell;if(!n||!a)return-1;var r=i(n);if(r.selectedTds.length)return-1;var l=r.getCellInfo(a),s=l.rowIndex+l.rowSpan;if(s>=r.rowsNum)return-1;var m=r.indexTable[s][l.colIndex],c=n.rows[m.rowIndex].cells[m.cellIndex];return c&&a.tagName==c.tagName&&m.colIndex==l.colIndex&&m.colSpan==l.colSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this).cell,a=i(n);a.mergeDown(n),e.moveToBookmark(t).select()}},UE.commands.mergecells={queryCommandState:function(){return r(this)?0:-1},execCommand:function(){var e=r(this);if(e&&e.selectedTds.length){var t=e.selectedTds[0];e.mergeRange();var n=this.selection.getRange();domUtils.isEmptyBlock(t)?n.setStart(t,0).collapse(!0):n.selectNodeContents(t),n.select()}}},UE.commands.insertrow={queryCommandState:function(){var e=o(this),t=e.cell;return t&&("TD"==t.tagName||"TH"==t.tagName&&e.tr!==e.table.rows[0])&&i(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this),a=n.cell,r=n.table,l=i(r),s=l.getCellInfo(a);if(l.selectedTds.length)for(var m=l.cellsRange,c=0,d=m.endRowIndex-m.beginRowIndex+1;d>c;c++)l.insertRow(m.beginRowIndex,a);else l.insertRow(s.rowIndex,a);e.moveToBookmark(t).select(),"enabled"===r.getAttribute("interlaced")&&this.fireEvent("interlacetable",r)}},UE.commands.insertrownext={queryCommandState:function(){var e=o(this),t=e.cell;return t&&"TD"==t.tagName&&i(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this),a=n.cell,r=n.table,l=i(r),s=l.getCellInfo(a);if(l.selectedTds.length)for(var m=l.cellsRange,c=0,d=m.endRowIndex-m.beginRowIndex+1;d>c;c++)l.insertRow(m.endRowIndex+1,a);else l.insertRow(s.rowIndex+s.rowSpan,a);e.moveToBookmark(t).select(),"enabled"===r.getAttribute("interlaced")&&this.fireEvent("interlacetable",r)}},UE.commands.deleterow={queryCommandState:function(){var e=o(this);return e.cell?0:-1},execCommand:function(){var e=o(this).cell,t=i(e),n=t.cellsRange,a=t.getCellInfo(e),r=t.getVSideCell(e),l=t.getVSideCell(e,!0),s=this.selection.getRange();if(utils.isEmptyObject(n))t.deleteRow(a.rowIndex);else for(var m=n.beginRowIndex;m<n.endRowIndex+1;m++)t.deleteRow(n.beginRowIndex);var c=t.table;if(c.getElementsByTagName("td").length)if(1==a.rowSpan||a.rowSpan==n.endRowIndex-n.beginRowIndex+1)(l||r)&&s.selectNodeContents(l||r).setCursor(!1,!0);else{var d=t.getCell(a.rowIndex,t.indexTable[a.rowIndex][a.colIndex].cellIndex);d&&s.selectNodeContents(d).setCursor(!1,!0)}else{var u=c.nextSibling;domUtils.remove(c),u&&s.setStart(u,0).setCursor(!1,!0)}"enabled"===c.getAttribute("interlaced")&&this.fireEvent("interlacetable",c)}},UE.commands.insertcol={queryCommandState:function(e){var t=o(this),n=t.cell;return n&&("TD"==n.tagName||"TH"==n.tagName&&n!==t.tr.cells[0])&&i(t.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(e){var t=this.selection.getRange(),n=t.createBookmark(!0);if(-1!=this.queryCommandState(e)){var a=o(this).cell,r=i(a),l=r.getCellInfo(a);if(r.selectedTds.length)for(var s=r.cellsRange,m=0,c=s.endColIndex-s.beginColIndex+1;c>m;m++)r.insertCol(s.beginColIndex,a);else r.insertCol(l.colIndex,a);t.moveToBookmark(n).select(!0)}}},UE.commands.insertcolnext={queryCommandState:function(){var e=o(this),t=e.cell;return t&&i(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this).cell,a=i(n),r=a.getCellInfo(n);if(a.selectedTds.length)for(var l=a.cellsRange,s=0,m=l.endColIndex-l.beginColIndex+1;m>s;s++)a.insertCol(l.endColIndex+1,n);else a.insertCol(r.colIndex+r.colSpan,n);e.moveToBookmark(t).select()}},UE.commands.deletecol={queryCommandState:function(){var e=o(this);return e.cell?0:-1},execCommand:function(){var e=o(this).cell,t=i(e),n=t.cellsRange,a=t.getCellInfo(e),r=t.getHSideCell(e),l=t.getHSideCell(e,!0);if(utils.isEmptyObject(n))t.deleteCol(a.colIndex);else for(var s=n.beginColIndex;s<n.endColIndex+1;s++)t.deleteCol(n.beginColIndex);var m=t.table,c=this.selection.getRange();if(m.getElementsByTagName("td").length)domUtils.inDoc(e,this.document)?c.setStart(e,0).setCursor(!1,!0):l&&domUtils.inDoc(l,this.document)?c.selectNodeContents(l).setCursor(!1,!0):r&&domUtils.inDoc(r,this.document)&&c.selectNodeContents(r).setCursor(!0,!0);else{var d=m.nextSibling;domUtils.remove(m),d&&c.setStart(d,0).setCursor(!1,!0)}}},UE.commands.splittocells={queryCommandState:function(){var e=o(this),t=e.cell;if(!t)return-1;var n=i(e.table);return n.selectedTds.length>0?-1:t&&(t.colSpan>1||t.rowSpan>1)?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this).cell,a=i(n);a.splitToCells(n),e.moveToBookmark(t).select()}},UE.commands.splittorows={queryCommandState:function(){var e=o(this),t=e.cell;if(!t)return-1;var n=i(e.table);return n.selectedTds.length>0?-1:t&&t.rowSpan>1?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this).cell,a=i(n);a.splitToRows(n),e.moveToBookmark(t).select()}},UE.commands.splittocols={queryCommandState:function(){var e=o(this),t=e.cell;if(!t)return-1;var n=i(e.table);return n.selectedTds.length>0?-1:t&&t.colSpan>1?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=o(this).cell,a=i(n);a.splitToCols(n),e.moveToBookmark(t).select()}},UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(t){var n=o(this),a=n.table;if(a)if("adaptbywindow"==t)e(a,this);else{var r=domUtils.getElementsByTagName(a,"td th");utils.each(r,function(e){e.removeAttribute("width")}),a.removeAttribute("width")}}},UE.commands.averagedistributecol={queryCommandState:function(){var e=r(this);return e&&(e.isFullRow()||e.isFullCol())?0:-1},execCommand:function(e){function t(){var e,t=o.table,n=0,r=0,i=l(a,t);if(o.isFullRow())n=t.offsetWidth,r=o.colsNum;else for(var s,m=o.cellsRange.beginColIndex,c=o.cellsRange.endColIndex,d=m;c>=d;)s=o.selectedTds[d],n+=s.offsetWidth,d+=s.colSpan,r+=1;return e=Math.ceil(n/r)-2*i.tdBorder-2*i.tdPadding}function n(e){utils.each(domUtils.getElementsByTagName(o.table,"th"),function(e){e.setAttribute("width","")});var t=o.isFullRow()?domUtils.getElementsByTagName(o.table,"td"):o.selectedTds;utils.each(t,function(t){1==t.colSpan&&t.setAttribute("width",e)})}var a=this,o=r(a);o&&o.selectedTds.length&&n(t())}},UE.commands.averagedistributerow={queryCommandState:function(){var e=r(this);return e?e.selectedTds&&/th/gi.test(e.selectedTds[0].tagName)?-1:e.isFullRow()||e.isFullCol()?0:-1:-1},execCommand:function(e){function t(){var e,t,n=0,r=o.table,i=l(a,r),s=parseInt(domUtils.getComputedStyle(r.getElementsByTagName("td")[0],"padding-top"));if(o.isFullCol()){var m,c,d=domUtils.getElementsByTagName(r,"caption"),u=domUtils.getElementsByTagName(r,"th");d.length>0&&(m=d[0].offsetHeight),u.length>0&&(c=u[0].offsetHeight),n=r.offsetHeight-(m||0)-(c||0),t=0==u.length?o.rowsNum:o.rowsNum-1}else{for(var g=o.cellsRange.beginRowIndex,h=o.cellsRange.endRowIndex,f=0,v=domUtils.getElementsByTagName(r,"tr"),b=g;h>=b;b++)n+=v[b].offsetHeight,f+=1;t=f}return e=browser.ie&&browser.version<9?Math.ceil(n/t):Math.ceil(n/t)-2*i.tdBorder-2*s}function n(e){var t=o.isFullCol()?domUtils.getElementsByTagName(o.table,"td"):o.selectedTds;utils.each(t,function(t){1==t.rowSpan&&t.setAttribute("height",e)})}var a=this,o=r(a);o&&o.selectedTds.length&&n(t())}},UE.commands.cellalignment={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(e,t){var n=this,a=r(n);if(a)utils.each(a.selectedTds,function(e){domUtils.setAttributes(e,t)});else{var o=n.selection.getStart(),l=o&&domUtils.findParentByTagName(o,["td","th","caption"],!0);/caption/gi.test(l.tagName)?(l.style.textAlign=t.align,l.style.verticalAlign=t.vAlign):domUtils.setAttributes(l,t),n.selection.getRange().setCursor(!0)}},queryCommandValue:function(e){var t=o(this).cell;if(t||(t=n(this)[0]),t){var a=UE.UETable.getUETable(t).selectedTds;return!a.length&&(a=t),UE.UETable.getTableCellAlignState(a)}return null}},UE.commands.tablealignment={queryCommandState:function(){return browser.ie&&browser.version<8?-1:o(this).table?0:-1},execCommand:function(e,t){var n=this,a=n.selection.getStart(),o=a&&domUtils.findParentByTagName(a,["table"],!0);o&&o.setAttribute("align",t)}},UE.commands.edittable={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(e,t){var n=this.selection.getRange(),a=domUtils.findParentByTagName(n.startContainer,"table");if(a){var o=domUtils.getElementsByTagName(a,"td").concat(domUtils.getElementsByTagName(a,"th"),domUtils.getElementsByTagName(a,"caption"));utils.each(o,function(e){e.style.borderColor=t})}}},UE.commands.edittd={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(e,t){var n=this,a=r(n);if(a)utils.each(a.selectedTds,function(e){e.style.backgroundColor=t});else{var o=n.selection.getStart(),l=o&&domUtils.findParentByTagName(o,["td","th","caption"],!0);l&&(l.style.backgroundColor=t)}}},UE.commands.settablebackground={queryCommandState:function(){return n(this).length>1?0:-1},execCommand:function(e,t){var a,o;a=n(this),o=i(a[0]),o.setBackground(a,t)}},UE.commands.cleartablebackground={queryCommandState:function(){var e=n(this);if(!e.length)return-1;for(var t,a=0;t=e[a++];)if(""!==t.style.backgroundColor)return 0;return-1},execCommand:function(){var e=n(this),t=i(e[0]);t.removeBackground(e)}},UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(e){var t=o(this).table;if(!t)return-1;var n=t.getAttribute("interlaced");return"interlacetable"==e?"enabled"===n?-1:0:n&&"disabled"!==n?0:-1},execCommand:function(e,t){var n=o(this).table;"interlacetable"==e?(n.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",n,t)):(n.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",n))}},UE.commands.setbordervisible={queryCommandState:function(e){var t=o(this).table;return t?0:-1},execCommand:function(){var e=o(this).table;utils.each(domUtils.getElementsByTagName(e,"td"),function(e){e.style.borderWidth="1px",e.style.borderStyle="solid"})}}}();
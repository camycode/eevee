var extend=require("extend"),fs=require("fs"),path=require("path"),defaults=require("../defaults");module.exports={getPath:function(e,t){var s,o=function(t){var a=path.resolve(path.join(t,path.sep,"..")),p=path.normalize(path.join(t,e));return fs.existsSync(p)?void(s=path.normalize(t)):void(a!=t&&o(a,e))};return e=e||defaults.files.config,t=t||path.join(__dirname,path.sep,".."),o(t),s||""},addDerivedValues:function(e){e=e||extend(!1,{},defaults);var t,s=this.getPath(),o={},a={};for(t in e.paths.source)e.paths.source.hasOwnProperty(t)&&(o[t]=path.resolve(path.join(s,e.base,e.paths.source[t])));for(t in e.paths.output)e.paths.output.hasOwnProperty(t)&&(a[t]=path.resolve(path.join(s,e.base,e.paths.output[t])));return e.paths.source=o,e.paths.output=a,e.paths.clean=path.resolve(path.join(s,e.base,e.paths.clean)),e.paths.assets={source:"../../themes",uncompressed:path.relative(e.paths.output.uncompressed,e.paths.output.themes).replace(/\\/g,"/"),compressed:path.relative(e.paths.output.compressed,e.paths.output.themes).replace(/\\/g,"/"),packaged:path.relative(e.paths.output.packaged,e.paths.output.themes).replace(/\\/g,"/")},e.permission?e.hasPermissions=!0:(e.permission={},e.hasPermissions=!1),e.globs||(e.globs={}),e.components instanceof Array&&(e.components=e.components.filter(function(t,s){return e.components.indexOf(t)==s})),e.globs.components="object"==typeof e.components?e.components.length>1?"{"+e.components.join(",")+"}":e.components[0]:"{"+defaults.components.join(",")+"}",e}};
define(["role.editor","role.detail","../models/role","../services/typing","css!../../css/app.role"],function(){return["$scope","role","typing",function(e,o,t){e.roles=[],o.setRoleEditor(e),o.setRoleDetail(e);var r={name:null,permission_amount:null,status:null},s=null,n="asc";e.sort=$.extend({},r);var i=function(r){r=r||null,o.getRoles(r).success(function(o){200==o.code?e.roles=o.data:t.warning(o.message)}).error(function(){t.error("网络错误")})};e.sortBy=function(o){s==o&&(n="asc"==n?"desc":"asc"),e.sort=$.extend({},r),s=o,e.sort[o]="asc"==n?"sort ascending":"sort descending",i({order:o+":"+n})},i({order:"updated_at:desc"}),e.openRoleDetailView=function(o){e.$emit("app.role.editor.hide"),e.$emit("app.role.detail.show",o)},e.$on("app.role.posted",function(o,t){"updated_at"!=s&&"desc"!=n?(n="desc",i({order:"updated_at:desc"})):e.roles.unshift(t)}),e.$on("app.role.putted",function(o,t){for(var r in e.roles)if(e.roles[r].id==t.id){e.roles[r]=t,e.$emit("app.role.editor.hide");break}}),e.openRoleEditor=function(){e.$emit("app.role.editor.show")}}]});
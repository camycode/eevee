UE.plugins.blockquote=function(){function e(e){return domUtils.filterNodeList(e.selection.getStartElementPath(),"blockquote")}var t=this;t.commands.blockquote={execCommand:function(t,o){var i=this.selection.getRange(),n=e(this),a=dtd.blockquote,s=i.createBookmark();if(n){var d=i.startContainer,r=domUtils.isBlockElm(d)?d:domUtils.findParent(d,function(e){return domUtils.isBlockElm(e)}),l=i.endContainer,m=domUtils.isBlockElm(l)?l:domUtils.findParent(l,function(e){return domUtils.isBlockElm(e)});r=domUtils.findParentByTagName(r,"li",!0)||r,m=domUtils.findParentByTagName(m,"li",!0)||m,"LI"==r.tagName||"TD"==r.tagName||r===n||domUtils.isBody(r)?domUtils.remove(n,!0):domUtils.breakParent(r,n),r!==m&&(n=domUtils.findParentByTagName(m,"blockquote"),n&&("LI"==m.tagName||"TD"==m.tagName||domUtils.isBody(m)?n.parentNode&&domUtils.remove(n,!0):domUtils.breakParent(m,n)));for(var c,U=domUtils.getElementsByTagName(this.document,"blockquote"),N=0;c=U[N++];)c.childNodes.length?domUtils.getPosition(c,r)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(c,m)&domUtils.POSITION_PRECEDING&&domUtils.remove(c,!0):domUtils.remove(c)}else{for(var f=i.cloneRange(),u=1==f.startContainer.nodeType?f.startContainer:f.startContainer.parentNode,g=u,k=1;;){if(domUtils.isBody(u)){g!==u?i.collapsed?(f.selectNode(g),k=0):f.setStartBefore(g):f.setStart(u,0);break}if(!a[u.tagName]){i.collapsed?f.selectNode(g):f.setStartBefore(g);break}g=u,u=u.parentNode}if(k)for(g=u=u=1==f.endContainer.nodeType?f.endContainer:f.endContainer.parentNode;;){if(domUtils.isBody(u)){g!==u?f.setEndAfter(g):f.setEnd(u,u.childNodes.length);break}if(!a[u.tagName]){f.setEndAfter(g);break}g=u,u=u.parentNode}u=i.document.createElement("blockquote"),domUtils.setAttributes(u,o),u.appendChild(f.extractContents()),f.insertNode(u);for(var B,b=domUtils.getElementsByTagName(u,"blockquote"),N=0;B=b[N++];)B.parentNode&&domUtils.remove(B,!0)}i.moveToBookmark(s).select()},queryCommandState:function(){return e(this)?1:0}}};
module("plugins.font"),test("trace1583:applyInlineStyle--MergeToParent",function(){var e=te.obj[0],t=te.obj[1];stop(),setTimeout(function(){e.setContent('<p>1<span style="font-size: 24px; ">23456<span style="font-size: 16px; ">7</span></span><span style="font-size: 16px; ">89</span>10</p>'),t.setStart(e.body.firstChild,0).setEnd(e.body.firstChild,4).select(),e.execCommand("fontsize","24px");var o='<span style="font-size: 24px;">12345678910</span>';ua.checkSameHtml(e.body.firstChild.innerHTML.toLowerCase(),o,""),start()},50)}),test("trace 3337：字符边框",function(){if(!ua.browser.opera){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("fontborder"),t=e.selection.getRange(),t.insertNode(e.document.createTextNode("hello")),ua.manualDeleteFillData(e.body);var o=baidu.editor.browser.ie?"&nbsp;":"<br>";ua.browser.ie&&ua.browser.ie<9?(equal(e.queryCommandValue("fontborder"),"#000 1px solid","检查反射值"),equal(ua.getChildHTML(e.body.firstChild),'<span style="border-bottom: #000 1px solid; border-left: #000 1px solid; border-top: #000 1px solid; border-right: #000 1px solid">hello</span>&nbsp;',"查看添加了字符边框后的样式")):(equal(e.queryCommandValue("fontborder"),"1px solid rgb(0, 0, 0)","检查反射值"),ua.checkHTMLSameStyle('<span style="border: 1px solid rgb(0, 0, 0);">hello</span>'+o,e.document,e.body.firstChild,"查看添加了字符边框后的样式")),t.setStart(e.body.firstChild.firstChild.firstChild,5).collapse(!0).select(),e.execCommand("fontborder"),equal(e.queryCommandState("fontborder"),"0"),equal(e.queryCommandValue("fontborder"),"","无反射值"),e.setContent('<p><span style="color: red">欢</span>迎光临</p>'),t.setStart(e.body.firstChild.firstChild,0).setEnd(e.body.firstChild.lastChild,3).select(),e.execCommand("fontborder");var r='<span style="border: 1px solid rgb(0, 0, 0);"><span style="color: red;">欢</span>迎光临</span>',l='<span style="border-bottom: #000 1px solid; border-left: #000 1px solid; border-top: #000 1px solid; border-right: #000 1px solid"><span style="color: red;">欢</span>迎光临</span>';ua.browser.ie&&ua.browser.ie<9?ua.checkSameHtml(e.body.firstChild.innerHTML,l,"查看添加了字符边框后的样式"):ua.checkHTMLSameStyle(r,e.document,e.body.firstChild,"查看添加了字符边框后的样式")}}),test("设置超链接前景色再清除颜色",function(){if(!(ua.browser.ie<9)){var e=te.obj[0],t=te.obj[1];e.setContent('<p>hello<a href="www.baidu.com">baidu</a></p>'),t.selectNode(e.body.firstChild).select(),e.execCommand("forecolor","rgb(255,0,0)"),e.execCommand("backcolor","rgb(0,255,0)"),e.execCommand("forecolor","default");var o='<span style="background-color: rgb(0, 255, 0);">hello</span><a href="www.baidu.com" _href="www.baidu.com" style="background-color: rgb(0, 255, 0);text-decoration: underline;"><span style="background-color: rgb(0, 255, 0);">baidu</span></a>';ua.checkHTMLSameStyle(o,e.document,e.body.firstChild,"清除前景色")}}),test("font转span",function(){var e=te.obj[0];e.setContent('<font size="12" color="red" lang="en" face="arial"><b><i>hello</i>hello</b>');var t='<span style="font-size:12px;color:red;font-family:arial"><strong><em>hello</em>hello</strong></span>';ua.checkHTMLSameStyle(t,e.document,e.body.firstChild,"转换font标签"),e.setContent('<b><font size="10" color="#ff0000" lang="en" face="楷体">hello'),t='<strong><span style="font-size:10px;color:#ff0000;font-family:楷体">hello</span></strong>',ua.checkHTMLSameStyle(t,e.document,e.body.firstChild,"转换font标签")}),test("beforegetContent",function(){var e=te.obj[0],t=te.obj[1];e.body.innerHTML="<p>hello<span></span></p>",t.selectNode(e.body.firstChild).select(),e.execCommand("forecolor","rgb(255,0,0)");var o=document.createElement("div"),r=document.createElement("div");stop(),setTimeout(function(){r.innerHTML=e.getContent(),o.innerHTML='<p><span style="color: rgb(255, 0, 0);" >hello</span></p>',equal(ua.getChildHTML(o),ua.getChildHTML(r)),start()},50)}),test("underline and linethrough",function(){var e=te.obj[0],t=te.obj[1];stop(),e.setContent('hello<a href="http://www.baidu.com/">baidu</a>test'),setTimeout(function(){ua.browser.opera||e.focus();var o=e.body;ua.manualDeleteFillData(e.body),t.selectNode(o.firstChild.firstChild.nextSibling).select(),ok(/underline/.test(e.queryCommandValue("underline")),"query command value is underline"),ok(/underline/.test(e.queryCommandValue("strikethrough")),"query command value is underline"),ok(e.queryCommandState("underline"),"query underline state"),e.execCommand("strikethrough");var r='hello<a href="http://www.baidu.com/" _href="http://www.baidu.com/" style="text-decoration: line-through" >baidu</a>test';ua.checkHTMLSameStyle(r,e.document,o.firstChild,"check results"),start()},50)}),test("background--不同字号",function(){if(!ua.browser.opera){var e=te.obj[0],t=te.obj[1];e.setContent("你好"),e.focus();var o=e.document.body;ua.manualDeleteFillData(e.body),t.selectNode(o.firstChild.firstChild).select(),e.execCommand("backcolor","rgb(255,0,0)"),t.setStart(o.firstChild.firstChild,1).collapse(1).select(),e.execCommand("fontsize","30px"),t=e.selection.getRange(),t.insertNode(e.document.createTextNode("hello")),stop(),setTimeout(function(){ua.manualDeleteFillData(e.body);var t=ua.browser.ie&&ua.browser.ie<9?"":";background-color: rgb(255, 0, 0); ",o='<span style="background-color: rgb(255, 0, 0)">你好<span style="font-size: 30px '+t+'">hello</span></span>';ua.checkHTMLSameStyle(o,e.document,e.body.firstChild,"检查不同字号的文本背景色是否一致"),start()},50)}}),test("trace 937：为第一个有样式的字加删除线",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<p><span style="color: red">欢</span>迎光临</p>'),t.selectNode(e.body.firstChild).select(),e.execCommand("strikethrough");var o=e.document.createElement("p");o.innerHTML='<span style="text-decoration: line-through;"><span style="text-decoration: line-through; color: red;">欢</span>迎光临</span>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,o),"查看添加了下划线后的样式")}),test("trace 918：字体的状态反射",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p>欢迎你回来</p>");var o=e.body.firstChild;t.selectNode(o).select(),e.execCommand("underline");var r=document.createElement("p");r.innerHTML='<span style="text-decoration: underline;">欢迎你回来</span>',ua.browser.opera||ok(ua.haveSameAllChildAttribs(o,r),"检查是否添加了下划线"),t.setStart(o.firstChild.firstChild,3).setEnd(o.firstChild.firstChild,4).select(),e.execCommand("fontfamily","楷体");var l="楷体";ua.browser.opera&&(l='"楷体"'),equal(e.queryCommandValue("fontfamily"),l,"检查字体的状态反射")}),test(" 选中文本设置前景色为默认",function(){var e=te.obj[0],t=te.obj[1];e.setContent("hello"),t.selectNode(e.body.firstChild).select(),e.execCommand("forecolor","rgb(255,0,0)"),ua.checkHTMLSameStyle('<span style="color:rgb(255, 0, 0)">hello</span>',e.document,e.body.firstChild,"文本的前景色设为红色"),e.execCommand("forecolor","default"),equal(ua.getChildHTML(e.body),"<p>hello</p>","设置字体颜色为默认颜色")}),test("trace 823：设置前景色后设置删除线",function(){var e=te.obj[0],t=te.obj[1];e.setContent('<p><span style="color: rgb(153, 230, 0); ">你好<span style="color: rgb(255, 0, 0); ">​hello</span></span></p>'),t.selectNode(e.body.firstChild.firstChild,0).select(),e.execCommand("strikethrough");var o=e.document.createElement("p");o.innerHTML='<span style="color: rgb(153, 230, 0); text-decoration: line-through;">你好<span style="color: rgb(255, 0, 0); text-decoration: line-through;">hello</span></span>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,o),"检查加入删除线后的样式")}),test("trace 819, 765：删除线和下划线互斥",function(){var e=te.obj[0],t=te.obj[1],o=e.document.createElement("p");e.setContent("<p>你好</p>"),t.selectNode(e.body.firstChild).select(),e.execCommand("underline"),o.innerHTML='<span style="text-decoration: underline">你好</span>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,o),"下划线"),t.selectNode(e.body.firstChild).select(),e.execCommand("strikethrough"),o.innerHTML='<span style="text-decoration: line-through">你好</span>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,o),"删除线，和下划线互斥"),t.selectNode(e.body.firstChild).select(),e.execCommand("underline"),o.innerHTML='<span style="text-decoration: underline">你好</span>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,o),"下划线，和删除线互斥")}),test("trace 809：闭合时改变前景色和删除线，再输入文本",function(){if(!ua.browser.opera){var e=te.obj[0],t=te.obj[1];e.setContent('<p><span style="color: rgb(255, 0, 0); text-decoration: line-through; ">你好</span></p>');var o=e.body.firstChild;t.setStart(o.firstChild,1).collapse(!0).select(),e.execCommand("forecolor","rgb(0,255,0)"),t=e.selection.getRange(),e.execCommand("underline"),t=e.selection.getRange(),t.insertNode(e.document.createTextNode("hey"));var r=e.document.createElement("p");r.innerHTML='<span style="color: rgb(255, 0, 0); text-decoration: line-through; ">你好</span><span style="color: rgb(255, 0, 0); "><span style="color: rgb(0, 255, 0); text-decoration: underline; ">​hey</span></span>',ua.manualDeleteFillData(e.body),baidu.editor.dom.domUtils.isEmptyNode(e.body.firstChild.lastChild)&&baidu.editor.browser.gecko&&e.body.firstChild.removeChild(e.body.firstChild.lastChild),ok(ua.haveSameAllChildAttribs(e.body.firstChild,r),"检查新输入的文本下划线和颜色是否正确")}}),test("trace 805：切换删除线和下划线，前景色没了",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p><strong>你好早安</strong></p>");var o=e.body.firstChild.firstChild.firstChild;t.selectNode(o).select(),e.execCommand("forecolor","rgb(255,0,0)"),t.setStart(o,0).setEnd(o,2).select(),e.execCommand("underline"),t.setStart(o,0).setEnd(o,2).select(),e.execCommand("strikethrough");var r=e.document.createElement("p");r.innerHTML='<span style="color: rgb(255, 0, 0); text-decoration: line-through;"><strong>你好</strong></span><span style="color: rgb(255, 0, 0);"><strong>早安</strong></span>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,r),"查看前景色是不是还在")}),test("trace 802：为设置了字体的文本添加删除线",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p><strong>你好早安</strong></p>");var o=e.body.firstChild.firstChild.firstChild;t.setStart(o,0).setEnd(o,2).select(),e.execCommand("strikethrough");var r=e.document.createElement("p");r.innerHTML='<span style="text-decoration: line-through;"><strong>你好</strong></span><strong>早安</strong>',ok(ua.haveSameAllChildAttribs(e.body.firstChild,r),"检查删除线是否正确"),e.execCommand("fontfamily","隶书"),e.execCommand("source");var l="隶书";ua.browser.opera&&(l='"隶书"'),ua.browser.gecko||equal(e.queryCommandValue("fontfamily"),l)}),test("trace 744：设置超链接背景色后切换到源码再切回来",function(){var e=te.obj[0],t=te.obj[1];stop(),e.setContent('<p>hello<a href="www.baidu.com">baidu</a></p>'),t.selectNode(e.body.firstChild).select(),e.execCommand("backcolor","rgb(255,0,0)");var o=e.body.firstChild.innerHTML;e.execCommand("source"),setTimeout(function(){e.execCommand("source"),setTimeout(function(){ua.checkHTMLSameStyle(o,e.document,e.body.firstChild,"切换后html代码不变"),start()},50)},50)}),test("对表格中的文本添加颜色和下划线",function(){var e=te.obj[0],t=te.obj[1];stop(),e.setContent('<table><tbody><tr><td>hello1</td><td>hello2</td></tr><tr><td colspan="2">hello3</td></tr></tbody></table>'),setTimeout(function(){var o=e.body.firstChild.getElementsByTagName("tr"),r=e.getUETable(e.body.firstChild),l=r.getCellsRange(o[0].cells[0],o[1].cells[0]);r.setSelected(l),ua.browser.ie&&ua.browser.ie<9?t.setStart(e.body.firstChild.firstChild.firstChild.firstChild,0).setEnd(e.body.firstChild.firstChild.lastChild.firstChild,6).select():t.setStart(o[0].cells[0].firstChild,0).setEnd(o[1].cells[0].firstChild,6).select(),e.execCommand("forecolor","rgb(255,100,100)"),setTimeout(function(){r.clearSelected(),o=e.body.firstChild.getElementsByTagName("tr"),r=e.getUETable(e.body.firstChild),t.selectNode(o[0].firstChild).select(),r.setSelected(t),setTimeout(function(){e.execCommand("underline"),setTimeout(function(){var t=e.body.firstChild.getElementsByTagName("td");o=e.body.firstChild.getElementsByTagName("tr"),ua.checkSameHtml('<span style="color: rgb(255, 100, 100); text-decoration: underline; ">hello1</span>',t[0].innerHTML,"第一个单元格有下划线和前景色"),ua.checkSameHtml('<span style="color: rgb(255, 100, 100); ">hello2</span>',t[1].innerHTML,"第2个单元格有前景色"),ua.checkSameHtml('<span style="color: rgb(255, 100, 100); ">hello3</span>',t[2].innerHTML,"第3个单元格有前景色"),equal(o[1].firstChild.getAttribute("colspan"),2,"colspan为2"),equal(e.queryCommandState("underline"),!0,"状态是underline"),equal(e.queryCommandState("forecolor"),0,"非underline和line-through返回0"),setTimeout(function(){start()},100)},100)},100)},100)},50)}),test("trace 740：设置左右字为红色，修改部分字颜色为蓝色，再修改所有字体",function(){var e=te.obj[0],t=te.obj[1];stop(),e.setContent("<p>你好早安</p>"),t.selectNode(e.body.firstChild).select(),e.execCommand("forecolor","rgb(255,0,0)");var o=e.body.firstChild.firstChild.firstChild;t.setStart(o,2).setEnd(o,4).select(),e.execCommand("forecolor","rgb(0,255,0)"),t.setStart(e.body.firstChild,0).setEnd(e.body.firstChild,1).select(),e.execCommand("fontfamily"," 楷体, 楷体_GB2312, SimKai; "),setTimeout(function(){var t='<span style="color: rgb(255, 0, 0); font-family: 楷体, 楷体_GB2312, SimKai;">你好<span style="color: rgb(0, 255, 0);">早安</span></span>';ua.checkSameHtml(t,e.body.firstChild.innerHTML,"查看字体和颜色是否正确"),start()},50)}),test("trace 721：预先设置下划线和字体颜色，再输入文本，查看下划线颜色",function(){if(!ua.browser.opera){var e=te.obj[0],t=te.obj[1];e.setContent("<p><br></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("underline"),e.execCommand("forecolor","rgb(255,0,0)"),t=e.selection.getRange(),t.insertNode(e.document.createTextNode("hello")),ua.manualDeleteFillData(e.body);var o='<span style="text-decoration:underline;color:rgb(255,0,0)">hello</span><br>';ua.checkHTMLSameStyle(o,e.document,e.body.firstChild,"查看下划线颜色是否与字体颜色一致")}}),test("trace 3342：字符ab， 给a 加边框再给b加边框，边框效果错误",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p>hello</p>"),t.setStart(e.body.firstChild.firstChild,0).setEnd(e.body.firstChild.firstChild,2).select(),e.execCommand("fontborder"),t.setStart(e.body.firstChild.lastChild,0).setEnd(e.body.firstChild.lastChild,2).select(),e.execCommand("fontborder"),ua.browser.ie&&ua.browser.ie<9?equal(ua.getChildHTML(e.body.firstChild),'<span style="border-bottom: #000 1px solid; border-left: #000 1px solid; border-top: #000 1px solid; border-right: #000 1px solid">hell</span>o',"查看添加了字符边框后的样式"):ua.browser.ie&&11==ua.browser.ie?equal(ua.getChildHTML(e.body.firstChild),'<span style="border: 1px solid rgb(0, 0, 0); border-image: none;">hell</span>o',"查看添加了字符边框后的样式"):equal(ua.getChildHTML(e.body.firstChild),'<span style="border: 1px solid rgb(0, 0, 0);">hell</span>o',"查看添加了字符边框后的样式")}),test("trace 3096：单元格中改变字号",function(){var e=te.obj[0],t=te.obj[1];e.setContent("<p></p>"),t.setStart(e.body.firstChild,0).collapse(!0).select(),e.execCommand("inserttable",{numCols:3,numRows:3});var o=e.body.firstChild.getElementsByTagName("tr");o[0].cells[0].innerHTML="asd",setTimeout(function(){t.setStart(e.body.firstChild.firstChild.firstChild.firstChild.firstChild,0).setEnd(e.body.firstChild.firstChild.firstChild.firstChild.firstChild,3).select(),e.execCommand("fontsize","32px"),equal(e.body.firstChild.getElementsByTagName("td")[0].style.height,"","不固定高度"),start()},50),stop()}),test("转换font标签",function(){var e=te.obj[0];e.setContent('<font size="16" color="red"><b><i>x</i></b></font>');var t='<p><span style="font-size:16px;color:red" ><strong><em>x</em></strong></span></p>';ua.checkHTMLSameStyle(t,e.document,e.body,"转换font标签"),e.setContent('<font style="color:red"><u>x</u></font>'),t='<span style="color:red"><span style="text-decoration:underline;">x</span></span>',ua.checkHTMLSameStyle(t,e.document,e.body.firstChild,"转换font标签")});